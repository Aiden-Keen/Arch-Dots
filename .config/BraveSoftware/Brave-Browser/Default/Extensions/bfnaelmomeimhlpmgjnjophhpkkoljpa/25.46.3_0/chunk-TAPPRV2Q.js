import{a as xr}from"./chunk-C3BAWXY6.js";import{a as Ct,b as bt,c as Je}from"./chunk-WVRYN4MY.js";import{a as D,l as Bg}from"./chunk-M3IC3XCG.js";import{a as wa}from"./chunk-RSJ6JVZU.js";import{A as Lg,B as Ug,C as Mg,D as Sl,E as Og,Y as zg,a as Uf}from"./chunk-2UWPPO5V.js";import{A as ha,B as kg,Ba as Ng,D as Cg,F as bn,H as _g,I as Ig,M as Ds,Q as Fg,R as Tn,U as ht,a as tf,j as xg,k as Ag,ka as vg,la as Pg,lb as Gg,o as Eg,pa as xn,t as ga,u as ao,wa as ya,xa as Rg,za as Dg}from"./chunk-4T2FPKLQ.js";import{a as Qg,b as qg}from"./chunk-GC6SFTGM.js";import{a as gg}from"./chunk-MVNJOY5H.js";import{Ja as na,W as zf,e as Sr,qa as Gf,s as qf,ua as Rs}from"./chunk-OQCZPFI2.js";import{a as rf}from"./chunk-YJCG6GWC.js";import{A as mn,C as ml,D as vs,Gb as Ff,J as kf,Kb as ta,Lb as ir,Ob as vf,Pb as Pf,Qb as Rf,Sb as Df,Zb as Nf,b as Tf,bb as ea,ca as Yi,da as wr,e as xf,ha as Xi,i as Af,j as dn,la as Cf,mc as Bf,o as Ef,qc as Ye,rb as If,ub as Ie,uc as Lf}from"./chunk-KLKDJF5S.js";import{$ as ia,Ab as aa,Bd as ma,Ce as wl,De as cr,Fb as Jf,Gd as oe,Hd as xt,Id as hg,Ie as Ve,Je as fa,Lb as ca,Mb as eg,P as sa,Pc as pg,Rc as wn,Rd as ar,T as yn,Tb as hl,Tc as pa,Td as yg,U as ke,Ub as tg,Uc as dg,Ud as wg,Vc as Sn,Vd as Sg,Wc as mg,X as Hf,Xc as fg,Y as Wf,Z as Zf,_ as Yf,a as _f,ae as Po,b as Ji,ba as Xf,bc as rg,cc as og,dd as ae,e as gl,ed as yl,f as Kf,fd as da,g as It,gc as ng,h as gn,i as br,ic as sg,j as Tr,je as bg,kc as ig,mc as ag,me as Ro,oc as cg,qc as ug,rc as lg,re as te,s as jf,sc as ua,t as Vf,tc as la,x as $f,ye as Tg,z as hn}from"./chunk-BQE2SXP7.js";import{$ as ne,$c as gf,Ab as Ek,Bc as Y,Cb as kk,Cc as U,Eb as cf,Ec as un,F as of,Fc as R,H as nf,Jb as uf,Lb as A,Ld as ze,Mb as Lr,Md as bf,Nb as J,Ob as dl,Od as Zi,Pb as lf,Pd as ln,Qb as _t,Qd as pn,Rb as et,Sb as M,Sd as yr,Tb as Fs,Td as Vt,Ub as pf,Uc as Tt,Wb as gr,Xc as mf,Y as ye,Yc as ff,_ as sf,_d as z,ba as sn,cd as hf,dd as qe,e as Hi,ec as df,fc as hr,fd as vo,g as Xm,gd as yf,hd as wf,he as Se,i as kt,id as ie,jc as an,jd as fe,kc as cn,m as Jm,na as af,nd as Sf,p as ef,pa as ft,qa as me,qb as pl,w as Pe,x as Ze}from"./chunk-L3JU23Z5.js";import{D as Ym,d as Wm,t as Zm,u as nn}from"./chunk-5HNKNX3S.js";import{$ as ra,Ea as Ps,Ma as Mf,S as fl,W as io,a as O,ab as Of,b as Be,ba as ge,d as _,e as L,eb as Fk,fa as Ur,fb as vk,hb as Pk,ia as gt,ka as oa,l as v,lb as fn,pb as Qf,q as Fe,r as je,u as Ck,va as Ik,x as _k}from"./chunk-R3MCCTIW.js";import{h as K,k as de}from"./chunk-VL3IRAUM.js";import{A as Qt,B as Fo,C as sr,g as s,j as Wi,y as Ce}from"./chunk-FA7LVEFF.js";import{a as i,d as Ke,g as P,i as u,j as g,l as Ak,m as Buffer,n as l}from"./chunk-WKJYWAXG.js";var Vg=Ke((Mr,jg)=>{u();l();var Kg=typeof self<"u"?self:Mr,Sa=function(){function e(){this.fetch=!1,this.DOMException=Kg.DOMException}return i(e,"F"),e.prototype=Kg,new e}();(function(e){var t=function(r){var o={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};function n(k){return k&&DataView.prototype.isPrototypeOf(k)}if(i(n,"isDataView"),o.arrayBuffer)var a=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],c=ArrayBuffer.isView||function(k){return k&&a.indexOf(Object.prototype.toString.call(k))>-1};function p(k){if(typeof k!="string"&&(k=String(k)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(k))throw new TypeError("Invalid character in header field name");return k.toLowerCase()}i(p,"normalizeName");function d(k){return typeof k!="string"&&(k=String(k)),k}i(d,"normalizeValue");function m(k){var F={next:i(function(){var G=k.shift();return{done:G===void 0,value:G}},"next")};return o.iterable&&(F[Symbol.iterator]=function(){return F}),F}i(m,"iteratorFor");function f(k){this.map={},k instanceof f?k.forEach(function(F,G){this.append(G,F)},this):Array.isArray(k)?k.forEach(function(F){this.append(F[0],F[1])},this):k&&Object.getOwnPropertyNames(k).forEach(function(F){this.append(F,k[F])},this)}i(f,"Headers"),f.prototype.append=function(k,F){k=p(k),F=d(F);var G=this.map[k];this.map[k]=G?G+", "+F:F},f.prototype.delete=function(k){delete this.map[p(k)]},f.prototype.get=function(k){return k=p(k),this.has(k)?this.map[k]:null},f.prototype.has=function(k){return this.map.hasOwnProperty(p(k))},f.prototype.set=function(k,F){this.map[p(k)]=d(F)},f.prototype.forEach=function(k,F){for(var G in this.map)this.map.hasOwnProperty(G)&&k.call(F,this.map[G],G,this)},f.prototype.keys=function(){var k=[];return this.forEach(function(F,G){k.push(G)}),m(k)},f.prototype.values=function(){var k=[];return this.forEach(function(F){k.push(F)}),m(k)},f.prototype.entries=function(){var k=[];return this.forEach(function(F,G){k.push([G,F])}),m(k)},o.iterable&&(f.prototype[Symbol.iterator]=f.prototype.entries);function h(k){if(k.bodyUsed)return Promise.reject(new TypeError("Already read"));k.bodyUsed=!0}i(h,"consumed");function y(k){return new Promise(function(F,G){k.onload=function(){F(k.result)},k.onerror=function(){G(k.error)}})}i(y,"fileReaderReady");function w(k){var F=new FileReader,G=y(F);return F.readAsArrayBuffer(k),G}i(w,"readBlobAsArrayBuffer");function S(k){var F=new FileReader,G=y(F);return F.readAsText(k),G}i(S,"readBlobAsText");function T(k){for(var F=new Uint8Array(k),G=new Array(F.length),$=0;$<F.length;$++)G[$]=String.fromCharCode(F[$]);return G.join("")}i(T,"readArrayBufferAsText");function b(k){if(k.slice)return k.slice(0);var F=new Uint8Array(k.byteLength);return F.set(new Uint8Array(k)),F.buffer}i(b,"bufferClone");function x(){return this.bodyUsed=!1,this._initBody=function(k){this._bodyInit=k,k?typeof k=="string"?this._bodyText=k:o.blob&&Blob.prototype.isPrototypeOf(k)?this._bodyBlob=k:o.formData&&FormData.prototype.isPrototypeOf(k)?this._bodyFormData=k:o.searchParams&&URLSearchParams.prototype.isPrototypeOf(k)?this._bodyText=k.toString():o.arrayBuffer&&o.blob&&n(k)?(this._bodyArrayBuffer=b(k.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):o.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(k)||c(k))?this._bodyArrayBuffer=b(k):this._bodyText=k=Object.prototype.toString.call(k):this._bodyText="",this.headers.get("content-type")||(typeof k=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):o.searchParams&&URLSearchParams.prototype.isPrototypeOf(k)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o.blob&&(this.blob=function(){var k=h(this);if(k)return k;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?h(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(w)}),this.text=function(){var k=h(this);if(k)return k;if(this._bodyBlob)return S(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(T(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o.formData&&(this.formData=function(){return this.text().then(B)}),this.json=function(){return this.text().then(JSON.parse)},this}i(x,"Body");var E=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function C(k){var F=k.toUpperCase();return E.indexOf(F)>-1?F:k}i(C,"normalizeMethod");function I(k,F){F=F||{};var G=F.body;if(k instanceof I){if(k.bodyUsed)throw new TypeError("Already read");this.url=k.url,this.credentials=k.credentials,F.headers||(this.headers=new f(k.headers)),this.method=k.method,this.mode=k.mode,this.signal=k.signal,!G&&k._bodyInit!=null&&(G=k._bodyInit,k.bodyUsed=!0)}else this.url=String(k);if(this.credentials=F.credentials||this.credentials||"same-origin",(F.headers||!this.headers)&&(this.headers=new f(F.headers)),this.method=C(F.method||this.method||"GET"),this.mode=F.mode||this.mode||null,this.signal=F.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&G)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(G)}i(I,"Request"),I.prototype.clone=function(){return new I(this,{body:this._bodyInit})};function B(k){var F=new FormData;return k.trim().split("&").forEach(function(G){if(G){var $=G.split("="),X=$.shift().replace(/\+/g," "),H=$.join("=").replace(/\+/g," ");F.append(decodeURIComponent(X),decodeURIComponent(H))}}),F}i(B,"decode");function Q(k){var F=new f,G=k.replace(/\r?\n[\t ]+/g," ");return G.split(/\r?\n/).forEach(function($){var X=$.split(":"),H=X.shift().trim();if(H){var ve=X.join(":").trim();F.append(H,ve)}}),F}i(Q,"parseHeaders"),x.call(I.prototype);function N(k,F){F||(F={}),this.type="default",this.status=F.status===void 0?200:F.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in F?F.statusText:"OK",this.headers=new f(F.headers),this.url=F.url||"",this._initBody(k)}i(N,"Response"),x.call(N.prototype),N.prototype.clone=function(){return new N(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},N.error=function(){var k=new N(null,{status:0,statusText:""});return k.type="error",k};var Z=[301,302,303,307,308];N.redirect=function(k,F){if(Z.indexOf(F)===-1)throw new RangeError("Invalid status code");return new N(null,{status:F,headers:{location:k}})},r.DOMException=e.DOMException;try{new r.DOMException}catch{r.DOMException=function(F,G){this.message=F,this.name=G;var $=Error(F);this.stack=$.stack},r.DOMException.prototype=Object.create(Error.prototype),r.DOMException.prototype.constructor=r.DOMException}function q(k,F){return new Promise(function(G,$){var X=new I(k,F);if(X.signal&&X.signal.aborted)return $(new r.DOMException("Aborted","AbortError"));var H=new XMLHttpRequest;function ve(){H.abort()}i(ve,"abortXhr"),H.onload=function(){var He={status:H.status,statusText:H.statusText,headers:Q(H.getAllResponseHeaders()||"")};He.url="responseURL"in H?H.responseURL:He.headers.get("X-Request-URL");var dt="response"in H?H.response:H.responseText;G(new N(dt,He))},H.onerror=function(){$(new TypeError("Network request failed"))},H.ontimeout=function(){$(new TypeError("Network request failed"))},H.onabort=function(){$(new r.DOMException("Aborted","AbortError"))},H.open(X.method,X.url,!0),X.credentials==="include"?H.withCredentials=!0:X.credentials==="omit"&&(H.withCredentials=!1),"responseType"in H&&o.blob&&(H.responseType="blob"),X.headers.forEach(function(He,dt){H.setRequestHeader(dt,He)}),X.signal&&(X.signal.addEventListener("abort",ve),H.onreadystatechange=function(){H.readyState===4&&X.signal.removeEventListener("abort",ve)}),H.send(typeof X._bodyInit>"u"?null:X._bodyInit)})}return i(q,"fetch"),q.polyfill=!0,e.fetch||(e.fetch=q,e.Headers=f,e.Request=I,e.Response=N),r.Headers=f,r.Request=I,r.Response=N,r.fetch=q,Object.defineProperty(r,"__esModule",{value:!0}),r}({})})(Sa);Sa.fetch.ponyfill=!0;delete Sa.fetch.polyfill;var An=Sa;Mr=An.fetch;Mr.default=An.fetch;Mr.fetch=An.fetch;Mr.Headers=An.Headers;Mr.Request=An.Request;Mr.Response=An.Response;jg.exports=Mr});var Hg=Ke((QL,$g)=>{u();l();(function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t={rotl:i(function(r,o){return r<<o|r>>>32-o},"rotl"),rotr:i(function(r,o){return r<<32-o|r>>>o},"rotr"),endian:i(function(r){if(r.constructor==Number)return t.rotl(r,8)&16711935|t.rotl(r,24)&4278255360;for(var o=0;o<r.length;o++)r[o]=t.endian(r[o]);return r},"endian"),randomBytes:i(function(r){for(var o=[];r>0;r--)o.push(Math.floor(Math.random()*256));return o},"randomBytes"),bytesToWords:i(function(r){for(var o=[],n=0,a=0;n<r.length;n++,a+=8)o[a>>>5]|=r[n]<<24-a%32;return o},"bytesToWords"),wordsToBytes:i(function(r){for(var o=[],n=0;n<r.length*32;n+=8)o.push(r[n>>>5]>>>24-n%32&255);return o},"wordsToBytes"),bytesToHex:i(function(r){for(var o=[],n=0;n<r.length;n++)o.push((r[n]>>>4).toString(16)),o.push((r[n]&15).toString(16));return o.join("")},"bytesToHex"),hexToBytes:i(function(r){for(var o=[],n=0;n<r.length;n+=2)o.push(parseInt(r.substr(n,2),16));return o},"hexToBytes"),bytesToBase64:i(function(r){for(var o=[],n=0;n<r.length;n+=3)for(var a=r[n]<<16|r[n+1]<<8|r[n+2],c=0;c<4;c++)n*8+c*6<=r.length*8?o.push(e.charAt(a>>>6*(3-c)&63)):o.push("=");return o.join("")},"bytesToBase64"),base64ToBytes:i(function(r){r=r.replace(/[^A-Z0-9+\/]/ig,"");for(var o=[],n=0,a=0;n<r.length;a=++n%4)a!=0&&o.push((e.indexOf(r.charAt(n-1))&Math.pow(2,-2*a+8)-1)<<a*2|e.indexOf(r.charAt(n))>>>6-a*2);return o},"base64ToBytes")};$g.exports=t})()});var Tl=Ke((KL,Wg)=>{u();l();var bl={utf8:{stringToBytes:i(function(e){return bl.bin.stringToBytes(unescape(encodeURIComponent(e)))},"stringToBytes"),bytesToString:i(function(e){return decodeURIComponent(escape(bl.bin.bytesToString(e)))},"bytesToString")},bin:{stringToBytes:i(function(e){for(var t=[],r=0;r<e.length;r++)t.push(e.charCodeAt(r)&255);return t},"stringToBytes"),bytesToString:i(function(e){for(var t=[],r=0;r<e.length;r++)t.push(String.fromCharCode(e[r]));return t.join("")},"bytesToString")}};Wg.exports=bl});var Yg=Ke((HL,Zg)=>{u();l();(function(){var e=Hg(),t=Tl().utf8,r=Tl().bin,o=i(function(a){a.constructor==String?a=t.stringToBytes(a):typeof Buffer<"u"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(a)?a=Array.prototype.slice.call(a,0):Array.isArray(a)||(a=a.toString());var c=e.bytesToWords(a),p=a.length*8,d=[],m=1732584193,f=-271733879,h=-1732584194,y=271733878,w=-1009589776;c[p>>5]|=128<<24-p%32,c[(p+64>>>9<<4)+15]=p;for(var S=0;S<c.length;S+=16){for(var T=m,b=f,x=h,E=y,C=w,I=0;I<80;I++){if(I<16)d[I]=c[S+I];else{var B=d[I-3]^d[I-8]^d[I-14]^d[I-16];d[I]=B<<1|B>>>31}var Q=(m<<5|m>>>27)+w+(d[I]>>>0)+(I<20?(f&h|~f&y)+1518500249:I<40?(f^h^y)+1859775393:I<60?(f&h|f&y|h&y)-1894007588:(f^h^y)-899497514);w=y,y=h,h=f<<30|f>>>2,f=m,m=Q}m+=T,f+=b,h+=x,y+=E,w+=C}return[m,f,h,y,w]},"sha1"),n=i(function(a,c){var p=e.wordsToBytes(o(a));return c&&c.asBytes?p:c&&c.asString?r.bytesToString(p):e.bytesToHex(p)},"api");n._blocksize=16,n._digestsize=20,Zg.exports=n})()});var eh=Ke((oU,Dk)=>{Dk.exports={name:"@phantom-labs/blocklist",version:"0.13.0",main:"index.js",types:"index.d.ts",repository:"git@github.com:phantom-labs/blocklist.git",author:"Jordan Leigh <AlwaysBCoding@gmail.com>",license:"MIT",scripts:{build:"node build.js"},dependencies:{"js-yaml":"^4.1.0",sha3:"^2.1.4"}}});var th=Ke((nU,Nk)=>{Nk.exports={blocklist:["phantomweb.app","aurory.app","solvision.io","staratlas.art","starsatlas.com","sollet.cc","raydlum.io","aurorynft.com","sneks.gg","solletweb.io","i-sollet.com","fancyfrenchienft.art","solanawebwallet.online","phahtom.com","server-syncwallet.com","staratias.app","raydium.network","grapesnetwork.me","staratias.art","soistarter.org","audius-nft.top","aurory.me","degenapes.app","phantom-app.online","phantomwallet.net","dapps-node.com","phantom-app.link","solanaoutage.com","walletconnectdapps.net","staratlas.cx","web-phantom.app","0120tt.com"],whitelist:[],fuzzylist:[],contentHash:"830ea1c9a833213eabc17990adf053081f503b1203ca9a2c711db7199e657293"}});var rh=Ke(El=>{u();l();var{version:Bk}=eh(),Lk=th(),Uk=i(()=>Bk,"getVersion"),Mk=i(()=>Lk,"getBlocklist");El.getVersion=Uk;El.getBlocklist=Mk});var nh=Ke(kn=>{"use strict";u();l();kn.__esModule=!0;kn.distance=kn.closest=void 0;var Or=new Uint32Array(65536),Ok=i(function(e,t){for(var r=e.length,o=t.length,n=1<<r-1,a=-1,c=0,p=r,d=r;d--;)Or[e.charCodeAt(d)]|=1<<d;for(d=0;d<o;d++){var m=Or[t.charCodeAt(d)],f=m|c;m|=(m&a)+a^a,c|=~(m|a),a&=m,c&n&&p++,a&n&&p--,c=c<<1|1,a=a<<1|~(f|c),c&=f}for(d=r;d--;)Or[e.charCodeAt(d)]=0;return p},"myers_32"),Qk=i(function(e,t){for(var r=t.length,o=e.length,n=[],a=[],c=Math.ceil(r/32),p=Math.ceil(o/32),d=0;d<c;d++)a[d]=-1,n[d]=0;for(var m=0;m<p-1;m++){for(var f=0,h=-1,y=m*32,w=Math.min(32,o)+y,S=y;S<w;S++)Or[e.charCodeAt(S)]|=1<<S;for(var d=0;d<r;d++){var T=Or[t.charCodeAt(d)],b=a[d/32|0]>>>d&1,x=n[d/32|0]>>>d&1,E=T|f,C=((T|x)&h)+h^h|T|x,I=f|~(C|h),B=h&C;I>>>31^b&&(a[d/32|0]^=1<<d),B>>>31^x&&(n[d/32|0]^=1<<d),I=I<<1|b,B=B<<1|x,h=B|~(E|I),f=I&E}for(var S=y;S<w;S++)Or[e.charCodeAt(S)]=0}for(var Q=0,N=-1,Z=m*32,q=Math.min(32,o-Z)+Z,S=Z;S<q;S++)Or[e.charCodeAt(S)]|=1<<S;for(var k=o,d=0;d<r;d++){var T=Or[t.charCodeAt(d)],b=a[d/32|0]>>>d&1,x=n[d/32|0]>>>d&1,E=T|Q,C=((T|x)&N)+N^N|T|x,I=Q|~(C|N),B=N&C;k+=I>>>o-1&1,k-=B>>>o-1&1,I>>>31^b&&(a[d/32|0]^=1<<d),B>>>31^x&&(n[d/32|0]^=1<<d),I=I<<1|b,B=B<<1|x,N=B|~(E|I),Q=I&E}for(var S=Z;S<q;S++)Or[e.charCodeAt(S)]=0;return k},"myers_x"),oh=i(function(e,t){if(e.length<t.length){var r=t;t=e,e=r}return t.length===0?e.length:e.length<=32?Ok(e,t):Qk(e,t)},"distance");kn.distance=oh;var qk=i(function(e,t){for(var r=1/0,o=0,n=0;n<t.length;n++){var a=oh(e,t[n]);a<r&&(r=a,o=n)}return t[o]},"closest");kn.closest=qk});var sh=Ke((kl,Ns)=>{u();l();(function(){"use strict";var e;try{e=typeof Intl<"u"&&typeof Intl.Collator<"u"?Intl.Collator("generic",{sensitivity:"base"}):null}catch{console.log("Collator could not be initialized and wouldn't be used")}var t=nh(),r=[],o=[],n={get:i(function(a,c,p){var d=p&&e&&p.useCollator;if(d){var m=a.length,f=c.length;if(m===0)return f;if(f===0)return m;var h,y,w,S,T;for(w=0;w<f;++w)r[w]=w,o[w]=c.charCodeAt(w);r[f]=f;var b;for(w=0;w<m;++w){for(y=w+1,S=0;S<f;++S)h=y,b=e.compare(a.charAt(w),String.fromCharCode(o[S]))===0,y=r[S]+(b?0:1),T=h+1,y>T&&(y=T),T=r[S+1]+1,y>T&&(y=T),r[S]=h;r[S]=y}return y}return t.distance(a,c)},"get")};typeof define<"u"&&define!==null&&define.amd?define(function(){return n}):typeof Ns<"u"&&Ns!==null&&typeof kl<"u"&&Ns.exports===kl?Ns.exports=n:(typeof self<"u"&&typeof self.postMessage=="function"&&typeof self.importScripts=="function"||typeof self<"u"&&self!==null)&&(self.Levenshtein=n)})()});var Wb=Ke(Hb=>{"use strict";u();l();var is=O();function FP(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}i(FP,"is");var vP=typeof Object.is=="function"?Object.is:FP,PP=is.useState,RP=is.useEffect,DP=is.useLayoutEffect,NP=is.useDebugValue;function BP(e,t){var r=t(),o=PP({inst:{value:r,getSnapshot:t}}),n=o[0].inst,a=o[1];return DP(function(){n.value=r,n.getSnapshot=t,_d(n)&&a({inst:n})},[e,r,t]),RP(function(){return _d(n)&&a({inst:n}),e(function(){_d(n)&&a({inst:n})})},[e]),NP(r),r}i(BP,"useSyncExternalStore$2");function _d(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!vP(e,r)}catch{return!0}}i(_d,"checkIfSnapshotChanged");function LP(e,t){return t()}i(LP,"useSyncExternalStore$1");var UP=typeof self>"u"||typeof self.document>"u"||typeof self.document.createElement>"u"?LP:BP;Hb.useSyncExternalStore=is.useSyncExternalStore!==void 0?is.useSyncExternalStore:UP});var Yb=Ke(Zb=>{"use strict";u();l();g.NODE_ENV!=="production"&&function(){function e(w,S){return w===S&&(w!==0||1/w===1/S)||w!==w&&S!==S}i(e,"is");function t(w,S){f||n.startTransition===void 0||(f=!0,console.error("You are using an outdated, pre-release alpha of React 18 that does not support useSyncExternalStore. The use-sync-external-store shim will not work correctly. Upgrade to a newer pre-release."));var T=S();if(!h){var b=S();a(T,b)||(console.error("The result of getSnapshot should be cached to avoid an infinite loop"),h=!0)}b=c({inst:{value:T,getSnapshot:S}});var x=b[0].inst,E=b[1];return d(function(){x.value=T,x.getSnapshot=S,r(x)&&E({inst:x})},[w,T,S]),p(function(){return r(x)&&E({inst:x}),w(function(){r(x)&&E({inst:x})})},[w]),m(T),T}i(t,"useSyncExternalStore$2");function r(w){var S=w.getSnapshot;w=w.value;try{var T=S();return!a(w,T)}catch{return!0}}i(r,"checkIfSnapshotChanged");function o(w,S){return S()}i(o,"useSyncExternalStore$1"),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(Error());var n=O(),a=typeof Object.is=="function"?Object.is:e,c=n.useState,p=n.useEffect,d=n.useLayoutEffect,m=n.useDebugValue,f=!1,h=!1,y=typeof self>"u"||typeof self.document>"u"||typeof self.document.createElement>"u"?o:t;Zb.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:y,typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(Error())}()});var Fd=Ke((joe,Id)=>{"use strict";u();l();g.NODE_ENV==="production"?Id.exports=Wb():Id.exports=Yb()});var Jb=Ke(Xb=>{"use strict";u();l();var fu=O(),MP=Fd();function OP(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}i(OP,"is");var QP=typeof Object.is=="function"?Object.is:OP,qP=MP.useSyncExternalStore,zP=fu.useRef,GP=fu.useEffect,KP=fu.useMemo,jP=fu.useDebugValue;Xb.useSyncExternalStoreWithSelector=function(e,t,r,o,n){var a=zP(null);if(a.current===null){var c={hasValue:!1,value:null};a.current=c}else c=a.current;a=KP(function(){function d(w){if(!m){if(m=!0,f=w,w=o(w),n!==void 0&&c.hasValue){var S=c.value;if(n(S,w))return h=S}return h=w}if(S=h,QP(f,w))return S;var T=o(w);return n!==void 0&&n(S,T)?(f=w,S):(f=w,h=T)}i(d,"memoizedSelector");var m=!1,f,h,y=r===void 0?null:r;return[function(){return d(t())},y===null?void 0:function(){return d(y())}]},[t,r,o,n]);var p=qP(e,a[0],a[1]);return GP(function(){c.hasValue=!0,c.value=p},[p]),jP(p),p}});var tT=Ke(eT=>{"use strict";u();l();g.NODE_ENV!=="production"&&function(){function e(m,f){return m===f&&(m!==0||1/m===1/f)||m!==m&&f!==f}i(e,"is"),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(Error());var t=O(),r=Fd(),o=typeof Object.is=="function"?Object.is:e,n=r.useSyncExternalStore,a=t.useRef,c=t.useEffect,p=t.useMemo,d=t.useDebugValue;eT.useSyncExternalStoreWithSelector=function(m,f,h,y,w){var S=a(null);if(S.current===null){var T={hasValue:!1,value:null};S.current=T}else T=S.current;S=p(function(){function x(Q){if(!E){if(E=!0,C=Q,Q=y(Q),w!==void 0&&T.hasValue){var N=T.value;if(w(N,Q))return I=N}return I=Q}if(N=I,o(C,Q))return N;var Z=y(Q);return w!==void 0&&w(N,Z)?(C=Q,N):(C=Q,I=Z)}i(x,"memoizedSelector");var E=!1,C,I,B=h===void 0?null:h;return[function(){return x(f())},B===null?void 0:function(){return x(B())}]},[f,h,y,w]);var b=n(m,S[0],S[1]);return c(function(){T.hasValue=!0,T.value=b},[b]),d(b),b},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(Error())}()});var rT=Ke((rne,vd)=>{"use strict";u();l();g.NODE_ENV==="production"?vd.exports=Jb():vd.exports=tT()});var jx=Ke((rye,Kx)=>{"use strict";u();l();Kx.exports=e=>{if(Object.prototype.toString.call(e)!=="[object Object]")return!1;let t=Object.getPrototypeOf(e);return t===null||t===Object.prototype}});var Yx=Ke((Wx,Zx)=>{"use strict";u();l();var Lu=jx(),{hasOwnProperty:$x}=Object.prototype,{propertyIsEnumerable:aD}=Object,ms=i((e,t,r)=>Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!0,configurable:!0}),"defineProperty"),cD=Wx,Vx={concatArrays:!1,ignoreUndefined:!1},Uu=i(e=>{let t=[];for(let r in e)$x.call(e,r)&&t.push(r);if(Object.getOwnPropertySymbols){let r=Object.getOwnPropertySymbols(e);for(let o of r)aD.call(e,o)&&t.push(o)}return t},"getEnumerableOwnPropertyKeys");function fs(e){return Array.isArray(e)?uD(e):Lu(e)?lD(e):e}i(fs,"clone");function uD(e){let t=e.slice(0,0);return Uu(e).forEach(r=>{ms(t,r,fs(e[r]))}),t}i(uD,"cloneArray");function lD(e){let t=Object.getPrototypeOf(e)===null?Object.create(null):{};return Uu(e).forEach(r=>{ms(t,r,fs(e[r]))}),t}i(lD,"cloneOptionObject");var Hx=i((e,t,r,o)=>(r.forEach(n=>{typeof t[n]>"u"&&o.ignoreUndefined||(n in e&&e[n]!==Object.getPrototypeOf(e)?ms(e,n,Yd(e[n],t[n],o)):ms(e,n,fs(t[n])))}),e),"mergeKeys"),pD=i((e,t,r)=>{let o=e.slice(0,0),n=0;return[e,t].forEach(a=>{let c=[];for(let p=0;p<a.length;p++)$x.call(a,p)&&(c.push(String(p)),a===e?ms(o,n++,a[p]):ms(o,n++,fs(a[p])));o=Hx(o,a,Uu(a).filter(p=>!c.includes(p)),r)}),o},"concatArrays");function Yd(e,t,r){return r.concatArrays&&Array.isArray(e)&&Array.isArray(t)?pD(e,t,r):!Lu(t)||!Lu(e)?fs(t):Hx(e,t,Uu(t),r)}i(Yd,"merge");Zx.exports=function(...e){let t=Yd(fs(Vx),this!==cD&&this||{},Vx),r={_:{}};for(let o of e)if(o!==void 0){if(!Lu(o))throw new TypeError("`"+o+"` is not an Option Object");r=Yd(r,{_:o},t)}return r._}});var iE=Ke((mAe,sE)=>{u();l();function EN(e,t,r,o){for(var n=-1,a=e==null?0:e.length;++n<a;){var c=e[n];t(o,c,r(c),e)}return o}i(EN,"arrayAggregator");sE.exports=EN});var cE=Ke((yAe,aE)=>{u();l();var kN=vk();function CN(e,t,r,o){return kN(e,function(n,a,c){t(o,n,r(n),c)}),o}i(CN,"baseAggregator");aE.exports=CN});var lE=Ke((TAe,uE)=>{u();l();var _N=iE(),IN=cE(),FN=Ik(),vN=_k();function PN(e,t){return function(r,o){var n=vN(r)?_N:IN,a=t?t():{};return n(r,e,FN(o,2),a)}}i(PN,"createAggregator");uE.exports=PN});var dE=Ke((kAe,pE)=>{u();l();var RN=Ck(),DN=lE(),NN=DN(function(e,t,r){RN(e,r,t)});pE.exports=NN});u();l();u();l();var Xg=P(Vg(),1),Jg=P(Yg(),1),xl=P(Ak(),1);var En=(e=>(e.BLOCK="BLOCK",e.NONE="NONE",e))(En||{});function Rk(e,t){for(let r=0;r<e.k;r++){let o=(0,Jg.default)(`${e.salt}_${t}_${r}`,{asBytes:!0}),a=xl.Buffer.from(o).subarray(0,4).readUInt32BE(0)%e.bits,c=Math.floor(a/24),p=xl.Buffer.from(e.bitVector.slice(c*4,c*4+4),"base64"),d=a%24,m=Math.floor(d/8),f=d%8;if(!(p[m]&1<<7-f))return!1}return!0}i(Rk,"lookup");var XL=typeof self<"u"&&self.fetch?self.fetch:Xg.default;function Al(e,t,r,o){let a=new URL(o).hostname.toLowerCase().replace(/\.$/,"").split(".");for(let c=0;c<a.length-1;c++){let p=a.slice(c).join(".");if(t.includes(p)||Rk(e,p)&&!r.includes(p))return"BLOCK"}return"NONE"}i(Al,"scanDomain");var ba=P(rh());var lh=P(sh());u();l();var ih="https://blocklist.phantom.app/multichain.json",Cl="https://blowfish-blocklist-proxy.phantom.app",zk="https://github.com/phantom-labs/blocklist",hU=i((e=3)=>({retry:e,retryDelay:i(t=>Math.min(1e3*2**t,3e4),"retryDelay")}),"reactQueryExponentialBackoff"),Gk={SLIPPAGE_EXCEEDED:"SLIPPAGE_EXCEEDED",INSUFFICIENT_FUNDS:"INSUFFICIENT_FUNDS",INSUFFICIENT_GAS:"INSUFFICIENT_GAS",UNKNOWN_ERROR:"UNKNOWN_ERROR",SIMULATION_FAILED:"SIMULATION_FAILED",TRANSACTION_EXPIRED:"TRANSACTION_EXPIRED",ACCOUNT_FROZEN:"ACCOUNT_FROZEN",SIMULATION_TIMEOUT:"SIMULATION_TIMEOUT",STALE_QUOTE:"STALE_QUOTE"},co;(function(e){e[e.info=5]="info",e[e.error=4]="error",e[e.criticalError=3]="criticalError",e[e.alert=2]="alert",e[e.criticalAlert=1]="criticalAlert"})(co||(co={}));function Kk(e){return{[co.criticalAlert]:"1-critical-alert",[co.alert]:"2-alert",[co.criticalError]:"3-critical-error",[co.error]:"4-error",[co.info]:"5-information"}[e]}i(Kk,"scanWarningVariantToUiLevel");var jk=3,vl=6e5,Vk=6e4,IU=s.object({type:s.union([s.literal("all"),s.literal("blocklist"),s.literal("whitelist"),s.literal("error"),s.literal("fuzzy"),s.literal("blowfishBloomFilter")]),result:s.boolean(),source:s.optional(s.string()),match:s.string().optional(),isSubdomainDomainWhitelisted:s.boolean().optional()}),FU=s.object({localHash:s.any(),cursor:s.any()}),Pl=s.object({bitVector:s.string(),k:s.number(),hash:s.string(),bits:s.number(),salt:s.string()}),ph=s.union([s.object({bloomFilter:Pl,bloomFilterHash:s.string(),recentlyAdded:s.array(s.string()),recentlyRemoved:s.array(s.string()),nextCursor:s.string()}),s.object({bloomFilter:Pl.optional(),bloomFilterHash:s.optional(s.string()),recentlyAdded:s.array(s.string()),recentlyRemoved:s.array(s.string()),nextCursor:s.string()})]),dh=s.object({bloomFilter:Pl,lastUpdated:s.number()}).nullish(),mh=s.object({recentlyAdded:s.array(s.string()),recentlyRemoved:s.array(s.string()),lastUpdated:s.number().optional()}).nullish(),Bs=class{static{i(this,"PhishingDetector")}blocklist;whitelist;fuzzylist;tolerance;constructor(t,r,o,n){this.blocklist=_l(t),this.whitelist=_l(r),this.fuzzylist=_l(o),this.tolerance=n||jk}check(t,r){if(!t)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};let o=Ta(t),n=Rl(o);if(Hk(n,this.whitelist)){let d=new URL(t).hostname;if(Il(Rl(d),this.blocklist)){let f={type:"blocklist",result:!0,source:d,isSubdomainDomainWhitelisted:!0};return r.capture("blockedDomain",{data:f}),f}else return{type:"whitelist",result:!1,source:d,isSubdomainDomainWhitelisted:!0}}if(Il(n,this.whitelist))return{type:"whitelist",result:!1,source:o,isSubdomainDomainWhitelisted:!1};if(Il(n,this.blocklist)){let d={type:"blocklist",result:!0,source:o,isSubdomainDomainWhitelisted:!1};return r.capture("blockedDomain",{data:d}),d}if(this.tolerance>0){let d=ah(n);d=d.replace("www.","");let m=this.fuzzylist.find(f=>{let h=ah(f);return lh.default.get(d,h)<=this.tolerance});if(m)return{type:"fuzzy",result:!0,match:$k(m),source:o,isSubdomainDomainWhitelisted:!1}}return{type:"all",result:!1,source:o,isSubdomainDomainWhitelisted:!1}}},Ta=i(e=>{let t=new URL(e).hostname.replace(/\.$/,"").split(".");return t.slice(0).slice(-(t.length===4?3:2)).join(".")},"removeSubdomainFromDomain"),_l=i(e=>e.map(Rl),"processDomainList"),Rl=i(e=>e.split(".").reverse(),"domainToParts"),$k=i(e=>e.slice().reverse().join("."),"domainPartsToDomain"),ah=i(e=>e.slice(1).reverse().join("."),"domainPartsToFuzzyForm"),Il=i((e,t)=>t.some(r=>r.length>e.length?!1:r.every((o,n)=>e[n]===o)),"matchPartsAgainstList"),Hk=i((e,t)=>t.some(r=>r[0]===e[0]&&r[1]===e[1]&&r[2]==="*"),"matchWhitelistedHostingDomain"),Wk=i(async e=>{let t=(0,ba.getBlocklist)(),r=await e.get(fe.CachedBlocklistDiff),o=null;try{o=JSON.parse(`${r}`)}catch(n){R.captureError(new Error(`Error parsing blocklist diff: ${n?.message}`),U.Generic)}if(o&&o.expiresAt&&o.expiresAt>Date.now())return new Bs(t.blocklist.concat(o.blocklist),t.whitelist.concat(o.whitelist),t.fuzzylist.concat(o.fuzzylist));{let n={},a=(0,ba.getVersion)();o&&(n.lastContentHash=`${o.contentHash}`),a&&(n.localBlocklistVersion=`${a}`);let c=await K.headers(n).noBearer().get(ih);if(c.status===200){let p=c.data;return p.expiresAt=Date.now()+vl,e.set(fe.CachedBlocklistDiff,JSON.stringify(p)),new Bs(t.blocklist.concat(p.blocklist),t.whitelist.concat(p.whitelist),t.fuzzylist.concat(p.fuzzylist))}else{if(c.status===304)return o.expiresAt=Date.now()+vl,e.set(fe.CachedBlocklistDiff,JSON.stringify(o)),new Bs(t.blocklist.concat(o.blocklist),t.whitelist.concat(o.whitelist),t.fuzzylist.concat(o.fuzzylist));throw new Error("Invalid response from blocklist")}}},"updateLocalBlocklist"),Zk=i(async(e,t,r)=>{let o,n;try{o=await Vt.isFeatureEnabledAsync("kill-blowfish-blocklist-cursor"),n=await Vt.isFeatureEnabledAsync("kill-previous-blocklist")}catch{o=!1,n=!1}let a;try{if(n)return o?uh(r,e,t):ch(r,e,t);{a=await Wk(e);let c=a.check(r,t);return c.type==="all"?o?uh(r,e,t):ch(r,e,t):c}}catch{return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1}}},"detectPhishing"),ch=i(async(e,t,r)=>{if(!e)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};let o=Ta(e),n=await t.getAll([fe.CachedBloomFilter,fe.CachedBloomFilterHash,fe.CachedScanDataRecents,fe.CachedScanDataCursor]),a=n[fe.CachedBloomFilter]??null,c=n[fe.CachedBloomFilterHash]??null,p=n[fe.CachedScanDataCursor]??null,d=n[fe.CachedScanDataRecents]??null,m=null,f={recentlyAdded:[],recentlyRemoved:[],lastUpdated:0},h=null;if(a){let w=dh.safeParse(a);w.success?m=w.data:await Fl(t)}if(d){let w=mh.safeParse(d);w.success?f=w.data:await Fl(t)}if(p){let S=s.string().safeParse(p);S.success?h=S.data:await Fl(t)}if(!f||f.lastUpdated==null||Date.now()>f.lastUpdated+Vk){let w={localHash:c,cursor:h},S=await K.noBearer().post(Cl,w);if(S.status!==200)return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1};let T=S.data,b,x=ph.safeParse(T);if(x.success)b=x.data;else return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1};let E=[],C=[],I=typeof c=="string"&&b.bloomFilterHash?c!==b.bloomFilterHash:!1;f!=null&&!I&&(E=f.recentlyAdded,C=f.recentlyRemoved),E=E.concat(b.recentlyAdded),C=C.concat(b.recentlyRemoved),E=E.filter(Q=>b.recentlyRemoved.indexOf(Q)<0),C=C.filter(Q=>b.recentlyAdded.indexOf(Q)<0);let B={recentlyAdded:E,recentlyRemoved:C,lastUpdated:Date.now()};if(await t.set(fe.CachedScanDataRecents,B),f=B,b.nextCursor!==h&&await t.set(fe.CachedScanDataCursor,b.nextCursor),b.bloomFilter!=null){let Q={bloomFilter:b.bloomFilter,lastUpdated:Date.now()};await Promise.all([t.set(fe.CachedBloomFilter,Q),t.set(fe.CachedBloomFilterHash,b.bloomFilterHash)]),m=Q}}if(!m)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};let y=Al(m.bloomFilter,f.recentlyAdded,f.recentlyRemoved,e);if(y===En.BLOCK){let w={result:!0,source:o,type:"blowfishBloomFilter"};return r.capture("blockedDomain",{data:w}),w}else if(y===En.NONE)return{result:!1,type:"all",isSubdomainDomainWhitelisted:!1};return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1}},"checkBlowfishBlocklist");async function Fl(e){await e.remove([fe.CachedBloomFilter,fe.CachedBloomFilterHash,fe.CachedScanDataRecents,fe.CachedScanDataCursor])}i(Fl,"resetState");var uh=i(async(e,t,r)=>{if(!e)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};let o=Ta(e),n=await t.getAll([fe.CachedBloomFilter,fe.CachedBloomFilterHash,fe.CachedScanDataRecents]),a=n[fe.CachedBloomFilter]??null,c=n[fe.CachedBloomFilterHash]??null,p=n[fe.CachedScanDataRecents]??null,d=null,m={recentlyAdded:[],recentlyRemoved:[],lastUpdated:0};if(a){let h=dh.safeParse(a);h.success?d=h.data:await t.remove([fe.CachedBloomFilter,fe.CachedBloomFilterHash,fe.CachedScanDataRecents])}if(p){let h=mh.safeParse(p);h.success?m=h.data:await t.remove([fe.CachedBloomFilter,fe.CachedBloomFilterHash,fe.CachedScanDataRecents])}if(!m||m.lastUpdated==null||Date.now()>m.lastUpdated+vl){let h={localHash:c},y=await K.noBearer().post(Cl,h);if(y.status!==200)return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1};let w=y.data,S,T=ph.safeParse(w);if(T.success)S=T.data;else return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1};let b={recentlyAdded:S.recentlyAdded,recentlyRemoved:S.recentlyRemoved,lastUpdated:Date.now()};if(await t.set(fe.CachedScanDataRecents,b),m=b,S.bloomFilter!=null){let x={bloomFilter:S.bloomFilter,lastUpdated:Date.now()};await Promise.all([t.set(fe.CachedBloomFilter,x),t.set(fe.CachedBloomFilterHash,S.bloomFilterHash)]),d=x}}if(!d)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};let f=Al(d.bloomFilter,m.recentlyAdded,m.recentlyRemoved,e);if(f===En.BLOCK){let h={result:!0,source:o,type:"blowfishBloomFilter"};return r.capture("blockedDomain",{data:h}),h}else if(f===En.NONE)return{result:!1,type:"all",isSubdomainDomainWhitelisted:!1};return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1}},"checkBlowfishBlocklistOld");u();l();u();l();var Yk=i(e=>e/1e8,"satsToBTC");u();l();u();l();u();l();var Do;(function(e){e.Plus="PLUS",e.Minus="MINUS",e.Equal="EQUAL"})(Do||(Do={}));var Dl;(function(e){e.fungible="fungible",e.collectible="collectible",e.native="native",e.unknown="unknown"})(Dl||(Dl={}));var Nl;(function(e){e.approval="approval",e.revokal="revokal",e.transfer="transfer",e.mint="mint",e.unknown="unknown"})(Nl||(Nl={}));var Cn;(function(e){e.Green="GREEN",e.Red="RED",e.White="WHITE"})(Cn||(Cn={}));var xa={[Cn.Green]:"spotPositive",[Cn.Red]:"spotNegative",[Cn.White]:"textBase"};function Xk(e){switch(e){case Do.Plus:return xa.GREEN;case Do.Minus:return xa.RED;case Do.Equal:return xa.WHITE;default:return xa.WHITE}}i(Xk,"getColorForStateChangeSign");function Jk(e){let t=e?.advancedDetails&&"safeguard"in e.advancedDetails?e?.advancedDetails?.safeguard:void 0;if(t?.recommended&&!t?.shouldBundle&&!t.error&&!t.verifyError&&t?.transactions&&t.transactions.length>0)return t.transactions}i(Jk,"extractSafeguardTransactions");function fh(e,t){if(e.params&&"safeguard"in e.params&&e.params.safeguard&&t?.advancedDetails&&"safeguard"in t.advancedDetails&&t.advancedDetails.safeguard?.transactions){let r=t.advancedDetails.safeguard;if(r.error)return r.error;let o=e.params.transactions,n=r.transactions;if(n){let a;try{fg(o,n)}catch(c){c instanceof Sn?a=c:c instanceof Error?a=Sn.createUnknownError(c.message):a=Sn.createUnknownError("Non error type",c)}if(a)return t.advancedDetails.safeguard.verifyError=a,a}}}i(fh,"processSafeguardErrors");function gh(e){if(e.advancedDetails&&"requestId"in e.advancedDetails)return e.advancedDetails.requestId}i(gh,"extractRequestId");u();l();var eC=i(async(e,t,r)=>{let o=`/simulation/v1?language=${e}`,n=await K.api().post(o,{...r,chainId:r.networkID,appVersion:Ce,platform:Qt,deviceId:t});if(!de(n))throw new Error("Failed to scan message");return n.data},"getScanMessage"),Bl=i(async(e,t,r)=>{let o=`/simulation/v1?language=${e}`,n={...r.params,...r.params&&"safeguard"in r.params?{safeguard:{...r.params.safeguard,lighthouseProgramId:mg}}:{}};try{let a=await K.api().post(o,{...r,chainId:r.networkID,params:n,metadata:r.metadata,appVersion:Ce,platform:Qt,deviceId:t});if(!de(a)){let d=await tC(a),m=`Failed to scan transaction: ${a.status} ${d}`;throw new Error(m)}let c=a.data,p=fh(r,c);if(p instanceof Sn){let d=gh(c);R.captureMessage(`Verify error ${d??""}: ${p.message}`,U.Safeguard)}return c}catch(a){throw R.captureError(a,U.Simulation),a}},"getScanTransaction");async function tC(e){let{data:t,blob:r}=e;if(typeof t=="string")return t;if(t&&typeof t=="object")return JSON.stringify(t);try{return await r?.text()??"Unknown error"}catch{return"Unknown error"}}i(tC,"getResponseErrorMessage");var aM=s.union([s.literal("signTransaction"),s.literal("signAllTransactions"),s.literal("signAndSendTransaction"),s.literal("signAndSendAllTransactions")]);u();l();var hh=i(e=>e.replace(/^(^[\w-_]*:\/\/)?(?:www\.)?/i,"").split("/")[0],"removeWebPrefixes");u();l();var yh=s.enum(["Native","Fungible","SemiFungible","NonFungible","Unknown"]),Qr=s.object({id:s.string(),displayName:s.string().optional(),logoURI:s.union([s.string(),s.null()]).optional(),tokenType:yh,decimals:s.number().optional(),symbol:s.string().optional(),isSpam:s.boolean().optional()}),wh=s.object({id:Lr,displayName:s.string(),logoURI:s.union([s.string(),s.null()]).optional()}),Aa=s.object({token:Qr,amount:s.string(),to:Lr,from:Lr}),Ll=s.literal("UNCLASSIFIED_APP_INTERACTION"),Ul=s.literal("TOKEN_SEND"),Ml=s.literal("TOKEN_BURN"),Ol=s.literal("TOKEN_SWAP"),Ql=s.literal("TOKEN_UNWRAP"),ql=s.literal("WITHDRAW_STAKE"),zl=s.literal("DEACTIVATE_STAKE"),Gl=s.literal("STAKE"),Kl=s.literal("COLLECTIBLE_LIST"),jl=s.literal("COLLECTIBLE_BUY_ITEM"),Vl=s.literal("COLLECTIBLE_CANCEL_BID"),$l=s.literal("COLLECTIBLE_BID_ITEM"),Hl=s.literal("COLLECTIBLE_UNLIST"),Wl=s.literal("COLLECTIBLE_SELL_ITEM"),Zl=s.literal("CANCEL_TX"),Yl=s.literal("TOKEN_APPROVAL"),Xl=s.literal("CANCEL_ORDER"),Jl=s.literal("COLLECTION_APPROVAL"),ep=s.literal("BRIDGE_INIT"),rC=s.union([Ll,Ul,Ml,Ol,Ql,ql,zl,Gl,Kl,jl,Vl,$l,Hl,Wl,Zl,Yl,Xl,Jl,ep]),Sh=s.object({transactionType:Ll,balanceChanges:s.array(Aa),dapp:s.union([br,s.null()]).optional()}),bh=s.object({transactionType:Ul,balanceChanges:s.array(Aa).nonempty(),dapp:s.union([br,s.null()]).optional()}),Th=s.object({transactionType:Ml,dapp:s.union([br,s.null()]).optional(),token:Qr,amount:s.string()}),xh=s.object({transactionType:Ol,dapp:s.union([br,s.null()]).optional(),receiveToken:Qr,sendToken:Qr,receiveAmount:s.string(),sendAmount:s.string()}),Ah=s.object({transactionType:Ql,token:Qr,amount:s.string()}),Eh=s.object({transactionType:ql,stakeAccount:Lr,amount:s.string()}),kh=s.object({transactionType:zl,stakeAccount:Lr,amount:s.string()}),Ch=s.object({transactionType:Gl,stakeAccount:Lr,amount:s.string(),validatorName:s.string().optional(),validatorWebsite:s.string().optional(),keybaseUsername:s.string().optional()}),_h=s.object({transactionType:Zl}),_n=s.object({dapp:s.union([br,s.null()]),itemAmount:s.string().optional(),item:Qr,forAmount:s.string(),forAsset:Qr,listingUrl:s.string().optional()}),Ih=_n.merge(s.object({transactionType:Kl})),Fh=_n.merge(s.object({transactionType:jl})),vh=_n.merge(s.object({transactionType:Vl})),Ph=_n.merge(s.object({transactionType:$l})),Rh=_n.merge(s.object({transactionType:Hl})),Dh=_n.merge(s.object({transactionType:Wl})),Nh=s.object({transactionType:Yl,dapp:s.union([br,s.null()]).optional(),token:Qr,value:s.string().optional(),isApproved:s.boolean()}),Bh=s.object({transactionType:Xl,dapp:s.union([br,s.null()]).optional(),orderId:s.string()}),Lh=s.object({transactionType:Jl,collection:wh,dapp:s.union([br,s.null()]).optional(),isApproved:s.boolean()}),Uh=s.object({transactionType:ep,dapp:s.union([br,s.null()]).optional(),balanceChanges:s.array(Aa).nonempty(),explorerUrl:s.string().optional()}),Mh=s.enum(["success","failed"]),Oh=s.object({networkFee:s.string().optional(),networkFeePayer:s.string().optional(),status:Mh,errorMessage:s.union([s.string(),s.null()]),blockNumber:s.string(),chainId:ft,transactionId:s.string()}),Ea=s.object({timestamp:s.number(),owner:Lr,id:Lr,interactionData:s.union([Sh,bh,Th,xh,Ah,Eh,kh,Ch,Ih,Fh,vh,Ph,Rh,Dh,_h,Nh,Bh,Lh,Uh]),chainMeta:Oh}),yt=i(e=>e.split("/")[1]?.split(":").slice(1).join(":"),"extractAddressfromBri");u();l();var Ft=i((e,t)=>{let r=new _(e).div(yn(t)).toNumber();return wa(r)},"amountToFormattedAmount");u();l();var No=i(e=>{switch(e){case"SemiFungible":case"NonFungible":return!0;default:return!1}},"isCollectibleTokenType"),tp=i((e,t)=>{let r=yt(e.to),o=yt(e.from),n=t.some(c=>c.address.toLowerCase()===r.toLowerCase()),a=t.some(c=>c.address.toLowerCase()===o.toLowerCase());return n&&!a},"isReceiveTransaction");u();l();var rp=P(Be());u();l();var Qh=i(({interactionData:e,isError:t,selectedAccountAddresses:r,getKnownAddressLabel:o,start:n,networkID:a})=>{let p=e.balanceChanges[0],{token:{symbol:d,displayName:m,tokenType:f,decimals:h},amount:y}=p,w=tp(p,r),S=No(f),b=oC({isCollectible:S,sign:w?"+":"-",amount:y,decimals:h,tokenSymbol:d,tokenType:f,isError:t});if(w){let C=yt(p.from),I=ml(C,void 0,o(C,a));return{topLeft:{text:`${v.t("transactionsReceived")} ${S?m||v.t("richTransactionDetailUnknownNFT"):""}`},topRight:{text:`${b}`,color:"spotPositive"},bottomLeft:{text:v.t("transactionsFromParagraphInterpolated",{from:I,defaultValue:`From ${I}`})},start:n}}let x=yt(p.to),E=ml(x,void 0,o(x,a));return{topLeft:{text:t?v.t("transactionsSendFailed"):`${v.t("transactionsSent")} ${S?m||v.t("richTransactionDetailUnknownNFT"):""}`},topRight:{text:`${b}`,color:"textBase"},bottomLeft:{text:v.t("transactionsToParagraphInterpolated",{to:E,defaultValue:`To ${E}`})},start:n}},"tokenSendLabel");function oC({isCollectible:e,sign:t,amount:r,decimals:o,tokenSymbol:n,tokenType:a,isError:c}){return c||o===void 0||a==="NonFungible"?"":e?`${t}${Ft(r,o)}`:`${t}${Ft(r,o)}${n?` ${xr(n,6)}`:""}`}i(oC,"getValueDisplay");var nC=["So11111111111111111111111111111111111111112","501"],sC=i((e,t,r,o,n)=>{let{interactionData:a,chainMeta:c}=e,{transactionType:p}=a,d=c.status==="failed",m=c.chainId,f=A.getTokenSymbol(m),h=A.getTokenDecimals(m),y=t("historyUnknownDappName"),w=(0,rp.jsx)(r,{activityItem:e,size:"small",isDetailViewOrSvg:!1});switch(p){case"TOKEN_SEND":return Qh({interactionData:a,isError:d,selectedAccountAddresses:n,getKnownAddressLabel:o,start:w,networkID:m});case"TOKEN_BURN":{let{amount:S,token:T}=a,b="";return T.displayName?S==="1"?b=T.displayName:b=`${T.displayName} (${S})`:b=t("richTransactionDetailUnknownNFT"),{topLeft:{text:d?`${t("transactionsFailedBurn")}`:`${t("transactionsBurned")}`},bottomLeft:{text:b},start:w}}case"TOKEN_UNWRAP":{let{amount:S,token:T}=a;return{topLeft:{text:d?`${t("transactionsUnwrappedFailed")}`:`${t("transactionsUnwrapped")}`},topRight:{text:d?"":`${Ft(S,T.decimals??0)} ${T.symbol}`,color:"textBase"},start:w}}case"TOKEN_SWAP":{let{receiveAmount:S,receiveToken:T,sendAmount:b,sendToken:x,dapp:E}=a,C=E?E.displayName:t("historyUnknownDappName"),I=vs(yt(x.id)||""),B=vs(yt(T.id)||""),Q="";!d&&T.decimals!==void 0&&(Q=`+${Ft(S,T.decimals)} ${xr(T.symbol||B,6)}`);let N="";return!d&&x.decimals!==void 0&&(N=`-${Ft(b,x.decimals)} ${xr(x.symbol||I,6)}`),{topLeft:{text:t(d?"transactionsFailedSwap":"transactionsSwapped")},topRight:{text:Q,color:"spotPositive"},bottomLeft:{text:C},bottomRight:{text:N,color:"textBase"},start:w}}case"BRIDGE_INIT":{let S=a.dapp?a.dapp.displayName:y,b=a.balanceChanges[0],{token:{symbol:x,decimals:E},amount:C}=b,I=x?` ${xr(x,6)}`:"";if(!d&&E!==void 0){let B=`-${Ft(C,E)}${I}`;return{topLeft:{text:d?t("transactionBridgeInitiatedFailed"):`${t("transactionBridgeInitiated")}`},bottomLeft:{text:S},topRight:{text:`${B}`,color:"textBase"},start:w}}return{topLeft:{text:d?t("transactionBridgeInitiatedFailed"):`${t("transactionBridgeInitiated")}`},bottomLeft:{text:S},start:w}}case"WITHDRAW_STAKE":{let{amount:S,stakeAccount:T}=a,b=yt(T),x=A.getTokenSymbol(m);return{topLeft:{text:t(d?"transactionsWithdrawStakeFailed":"transactionsWithdrawStake")},topRight:{text:d?"":`${Ft(S,h)} ${xr(x,6)}`,color:"textBase"},bottomLeft:{text:mn(b,4)},start:w}}case"DEACTIVATE_STAKE":{let{stakeAccount:S}=a,T=yt(S);return{topLeft:{text:t(d?"transactionsDeactivateStakeFailed":"transactionsDeactivateStake")},bottomLeft:{text:mn(T,4)},start:w}}case"STAKE":{let{amount:S,stakeAccount:T,validatorName:b}=a,x=yt(T);return{topLeft:{text:t(d?"transactionsStakedFailed":"transactionsStaked")},topRight:{text:d?"":`${Ft(S,h)} ${xr(f,6)}`,color:"textBase"},bottomLeft:{text:b||mn(x,4)},start:w}}case"COLLECTIBLE_LIST":{let{dapp:S,item:T}=a,b=S?S.displayName:t("historyUnknownDappName"),x=T.displayName||t("richTransactionDetailUnknownNFT");return{topLeft:{text:d?t("transactionsListedFailed"):t("transactionsListedInterpolated",{name:x})},bottomLeft:{text:b},start:w}}case"COLLECTIBLE_BUY_ITEM":{let{dapp:S,itemAmount:T,item:b,forAsset:x,forAmount:E}=a,C=S?S.displayName:t("historyUnknownDappName"),I=qh(E,x.decimals,xr(x.symbol||"",6)),B=b.symbol||vs(yt(b.id)),Q=T&&b.tokenType==="SemiFungible"?`+${T} ${B}`:`+${B}`;return{topLeft:{text:t(d?"transactionsBuyFailed":"transactionsBoughtCollectible")},topRight:{text:d?"":Q,color:"spotPositive"},bottomRight:{text:d?"":`${I}`,color:"textBase"},bottomLeft:{text:C},start:w}}case"COLLECTIBLE_CANCEL_BID":{let{dapp:S,item:T}=a,b=S?S.displayName:t("historyUnknownDappName"),x=T.displayName||t("richTransactionDetailUnknownNFT");return{topLeft:{text:d?t("transactionsCancelBidOnFailed"):t("transactionsCancelBidOnInterpolated",{name:x})},bottomLeft:{text:b},start:w}}case"COLLECTIBLE_BID_ITEM":{let{dapp:S,item:T}=a,b=S?S.displayName:t("historyUnknownDappName"),x=T.displayName||t("richTransactionDetailUnknownNFT");return{topLeft:{text:d?t("transactionsBidFailed"):t("transactionsBidOnInterpolated",{name:x})},bottomLeft:{text:b},start:w}}case"COLLECTIBLE_UNLIST":{let{dapp:S,item:T}=a,b=S?S.displayName:t("historyUnknownDappName"),x=T.displayName||t("richTransactionDetailUnknownNFT");return{topLeft:{text:d?t("transactionsUnlistedFailed"):t("transactionsUnlistedInterpolated",{name:x})},bottomLeft:{text:b},start:w}}case"COLLECTIBLE_SELL_ITEM":{let{dapp:S,itemAmount:T,item:b,forAsset:x,forAmount:E}=a,C=S?S.displayName:t("historyUnknownDappName"),I=x.decimals!==void 0?`+${Ft(E,x.decimals)} ${xr(x.symbol||"",6)}`:t("transactionsUnknownAmount"),B=b.symbol||vs(yt(b.id)),Q=T&&b.tokenType==="SemiFungible"?`-${T} ${B}`:`-${B}`;return{topLeft:{text:t(d?"transactionsSoldFailed":"transactionsSoldCollectible")},topRight:{text:d?"":`${I}`,color:"spotPositive"},bottomRight:{text:d?"":Q,color:"textBase"},bottomLeft:{text:C},start:w}}case"CANCEL_TX":return{topLeft:{text:t(d?"transactionCancelledFailed":"transactionCancelled")},start:w};case"TOKEN_APPROVAL":{let{dapp:S,token:T,isApproved:b}=a,x=No(T.tokenType)?T.displayName:T.symbol,E;return d?b?No(T.tokenType)?E=t("transactionApproveTokenFailed",{tokenSymbol:x}):E=t("transactionApprovalFailed"):No(T.tokenType)?E=t("transactionRevokeApproveTokenFailed",{tokenSymbol:x}):E=t("transactionRevokeFailed"):b?E=t("transactionApproveToken",{tokenSymbol:x}):E=t("transactionRevokeApproveToken",{tokenSymbol:x}),{topLeft:{text:E},bottomLeft:{text:S?S.displayName:y,color:"textIncidental"},start:w}}case"COLLECTION_APPROVAL":{let{collection:S,isApproved:T,dapp:b}=a,x=S.displayName,E;return d?T?E=t("transactionApproveTokenFailed",{tokenSymbol:x}):E=t("transactionRevokeApproveTokenFailed",{tokenSymbol:x}):T?E=t("transactionApproveToken",{tokenSymbol:x}):E=t("transactionRevokeApproveToken",{tokenSymbol:x}),{topLeft:{text:E},bottomLeft:{text:b?b.displayName:y,color:"textIncidental"},start:w}}case"CANCEL_ORDER":{let{dapp:S}=a;return{topLeft:{text:t(d?"transactionCancelOrderFailed":"transactionCancelOrder")},bottomLeft:{text:S?.displayName||t("historyUnknownDappName"),color:"textIncidental"},start:w}}case"UNCLASSIFIED_APP_INTERACTION":{let{dapp:S}=a,T=S?S.displayName:y;return{topLeft:{text:t(d?"transactionsFailedAppInteraction":"transactionsAppInteraction")},bottomLeft:{text:T},start:w}}}},"createActivityRowLabels"),iC=i((e,t)=>{let{display:r,type:o}=e,{topLeft:n,topRight:a,bottomLeft:c,bottomRight:p}=r.summary,d=(0,rp.jsx)(t,{logoUri:r.summary.logoUri,pendingTransactionType:o,size:"small"});return{topLeft:n,topRight:a,bottomLeft:c,bottomRight:p,start:d}},"createPendingTransactionRowLabels"),op=i((e,t,r)=>{let o=(e??[]).map(tg);if(t){let n=o.find(a=>a.chainId===t)?.address;if(n){let a={chainId:t,address:n};r&&(a.filters=[{type:"token",value:r}]),o=[a]}}return o},"getAccountsWithFilter"),np=i(e=>{if(!e)return;let t=te(e);if(t.resourceType!==J.nativeToken)return e.type===oe.SPL?e.data.splTokenAccountPubkey:t.address},"getTokenActivityFilterId"),aC=i((e,t)=>{let r=yt(e.id);return nC.includes(r)&&(e.tokenType="Native"),e.tokenType==="Native"?{chainId:t,slip44:A.getSlip44(t),resourceType:J.nativeToken}:{chainId:t,address:r,resourceType:J.address}},"getFungibleCaip19FromToken"),qh=i((e,t,r)=>{if(!e||!t)return v.t("transactionsUnknownAmount");let o=ke(e,t),n=o.abs(),a=o.isZero()?"":o.isPositive()?"-":"+",c=cr(n);return`${a}${c} ${r}`},"formatPaidAmount");u();l();var Ls=P(O());var cC=s.object({orderIds:s.array(s.object({bytesValue:s.string(),bytesArrayValue:s.string(),stringValue:s.string()}))}),uC=i(async(e,t)=>{if(t==="LI.FI")return{label:v.t("transactionBridgeStatusLink",{dappName:"LI.FI"}),value:`https://explorer.li.fi/tx/${e}`};if(t==="deBridge")try{let r=await K.get(`https://stats-api.dln.trade/api/Transaction/${e}/orderIds`),o=cC.safeParse(r.data);if(!o.success){R.captureError(new Error("Failed to parse deBridge response"),U.History);return}let n=o.data.orderIds[0]?.stringValue;if(!n){R.captureError(new Error("No orderId found in deBridge response"),U.History);return}return{label:v.t("transactionBridgeStatusLink",{dappName:"DeBridge"}),value:`https://app.debridge.finance/order?orderId=${n}`}}catch(r){R.captureError(new Error(`Could not fetch bridge explorer url: ${r}`),U.History);return}},"getBridgeExplorerUrl"),lC=i((e,t)=>{let[r,o]=(0,Ls.useState)(),[n,a]=(0,Ls.useState)(!1);return(0,Ls.useEffect)(()=>{e&&t&&i(async()=>{a(!0);try{let p=await uC(e,t);o(p)}finally{a(!1)}},"fetchBridgeUrl")()},[e,t]),{bridgeUrl:r,isLoading:n}},"useBridgeExplorerUrl");u();l();u();l();u();l();var vt={showTimeToMineRowInPendingTransactionDetail:!1,showFeeRowInPendingTransactionDetail:!0};var zh={...vt};u();l();var Gh={...vt};u();l();var Kh={showTimeToMineRowInPendingTransactionDetail:!1,showFeeRowInPendingTransactionDetail:!1};u();l();var jh={...vt,showTimeToMineRowInPendingTransactionDetail:!0};u();l();var Vh={...vt};u();l();var $h={...vt};u();l();var Hh={...vt};u();l();var Wh={...vt};u();l();var Zh={showTimeToMineRowInPendingTransactionDetail:!1,showFeeRowInPendingTransactionDetail:!1};u();l();var Yh={showTimeToMineRowInPendingTransactionDetail:!1,showFeeRowInPendingTransactionDetail:!1};var pC=new cn({[ne.Solana]:Zh,[ne.Ethereum]:jh,[ne.Polygon]:Wh,[ne.Monad]:Hh,[ne.Base]:Gh,[ne.Arbitrum]:zh,[ne.Bitcoin]:Kh,[ne.Sui]:Yh,[ne.Hypercore]:Vh,[ne.Hyperevm]:$h}),Xh=an(pC);u();l();u();l();u();l();u();l();var ey=P(O(),1);var Jh=new WeakMap;function ty(e,t){let r=xg(t),o=dC(r);for(let[n,a]of e)(!o.has(n)||t?.dangerouslyForceHydrate)&&(o.add(n),r.set(n,a))}i(ty,"useHydrateAtoms");var dC=i(e=>{let t=Jh.get(e);return t||(t=new WeakSet,Jh.set(e,t)),t},"getHydratedSet");var cy=P(O());u();l();var iy=P(O());u();l();var mC=10,fC="/history/v2",Us=class extends Error{static{i(this,"ActivityItemsFetchCacheBustError")}message="406: Cache bust!"},ka=class extends Error{static{i(this,"ActivityItemsFetchResponseMalformed")}message="Server response malformed."},sp=class extends Error{static{i(this,"ActivityItemsFetchServerError")}},ip=class extends Error{static{i(this,"ActivityItemsFetchClientError")}},ry=s.object({next:s.union([s.null(),s.string()]),results:s.array(Ea)}),oy=i(async e=>{let t=await K.api().retry(3,2e3).post(`${fC}`,e);if(t.status===406)throw new Us;if(t.status>=400&&t.status<500)throw new ip(`FetchActivityItem: Status code: ${t.status}`);if(t.status>=500)throw new sp(`FetchActivityItem: Status code: ${t.status}`);return t.data},"_fetch"),ny=i(e=>!Array.isArray(e.results)||typeof e.next!="string"&&e.next!==null,"isResponseMalformed"),ap=i(async e=>{let t=await oy(e);if(ny(t))throw new ka;for(;t.results?.length<mC&&t.next;){if(ny(t))throw new ka;let r=await oy({next:t.next,isSpam:e.isSpam});t.next=r.next,t.results=[...t.results,...r.results]}try{return ry.parse(t)}catch(r){let o=r,n=[],a=o.issues;for(let d=0;d<a.length;++d){let m=a[d].path;if(m[0]!=="results")throw R.captureError(o,U.History),o;let f=m[1];if(typeof f!="number")throw R.captureError(o,U.History),o;n.push(f)}n.sort(function(d,m){return m-d});let c=n.map(d=>t.results[d]).map(d=>d.interactionData?.transactionType||""),p=[];for(let d=0;d<n.length;++d){let m=n[d],f=t.results[m],h={timestamp:f?.timestamp,owner:f?.owner,id:f?.id,chainMeta:f?.chainMeta,interactionData:{transactionType:"UNCLASSIFIED_APP_INTERACTION",balanceChanges:[]}};try{Ea.parse(h),t.results[m]=h,p.push(m)}catch{}}for(let d=0;d<n.length;++d){let m=n[d];p.indexOf(m)===-1&&t.results.splice(m,1)}n.length&&console.error(`Removed history items, ${c.join(",")}`);try{return ry.parse(t)}catch(d){let m=d;throw R.captureError(m,U.History),m}}},"fetchActivityItems");var gC=3e5,Ms="fetch-infinite-activity-items",ay=i(({accounts:e,isSpam:t})=>[Ms,e,t],"infiniteActivityItemsQueryKey"),hC=i((e,t)=>{e.removeQueries({queryKey:t})},"bustCache"),cp=i(({accounts:e,isSpam:t})=>{let r=qe();(0,iy.useEffect)(()=>()=>{r.cancelQueries({queryKey:[Ms],exact:!1})},[r]);let o=ay({accounts:e,isSpam:t});return yf({queryKey:o,queryFn:i(async({pageParam:a})=>{try{let c;a&&a!==""?c=await ap({next:a,isSpam:t}):c=await ap({accounts:e||[],isSpam:t});let p=c.results.map(d=>(d.interactionData.transactionType==="TOKEN_SEND"&&d.interactionData.balanceChanges.sort(yC(e)),d));return{...c,results:p}}catch(c){throw c instanceof Us&&hC(r,o),R.captureError(c,U.History),c}},"queryFn"),getNextPageParam:i(a=>a?.next,"getNextPageParam"),staleTime:gC,retry:!1,enabled:!!e?.length&&e.every(a=>!A.isLocalNetworkID(a.chainId)),initialPageParam:""})},"useFetchInfiniteActivityItems");function yC(e){return(t,r)=>{let o=sy(t,e),n=sy(r,e);return o?-1:n?1:0}}i(yC,"balanceChangeSort");function sy(e,t){let r=e.to.split("/address:")[1],o=e.from.split("/address:")[1];return t.some(n=>n.address.toLowerCase()===r.toLowerCase()||n.address.toLowerCase()===o.toLowerCase())}i(sy,"findRelevantTransfers");var wC=i(({fungible:e,isSpam:t=!1})=>{let{data:r=xf,status:o}=If(),n=r.isDeveloperMode,a=np(e),{data:c}=Bf({address:e?.data.walletAddress,networkID:e?.data.chain.id}),p=(0,cy.useMemo)(()=>op(c?[c]:[],e?.data.chain.id,a),[c,e?.data.chain.id,a]),d=cp({accounts:p,isSpam:t}),m=d.isPending||o==="pending";return{activityItemsData:d,isLoadingHistory:m,isDeveloperMode:n}},"useFungibleActivityByFungible");u();l();u();l();var ur="Auto";var Re={buyFungible:void 0,buyUsdValue:void 0,sellFungible:void 0,sellUsdValue:void 0,sellAmount:"",uiSellAmountCryptoInput:"",amountType:"sell",quoteResponse:void 0,selectedProviderIndex:0,selectedBaseProvider:ur,gasEstimation:{isFetching:!1,estimate:void 0,estimateWithBuffer:void 0},hasNoRoutes:!1,isFetchingQuote:!1,error:null,searchQuery:"",numSearchResults:0,primaryCurrency:"crypto",uiSellAmountLocalFiatInput:"",uiBuyAmountCryptoInput:"",uiBuyAmountLocalFiatInput:"",canInputFiatSellAmount:!1,swapFilter:void 0},j=Ye(e=>({...Re,resetQuote:i(()=>e({quoteResponse:Re.quoteResponse,isFetchingQuote:Re.isFetchingQuote,hasNoRoutes:Re.hasNoRoutes,selectedProviderIndex:Re.selectedProviderIndex,error:Re.error,uiSellAmountLocalFiatInput:Re.uiSellAmountLocalFiatInput,selectedBaseProvider:Re.selectedBaseProvider}),"resetQuote"),resetSwapper:i(()=>e({quoteResponse:Re.quoteResponse,gasEstimation:Re.gasEstimation,error:Re.error,sellAmount:"",uiSellAmountCryptoInput:"",uiBuyAmountCryptoInput:Re.uiBuyAmountCryptoInput,swapFilter:Re.swapFilter,selectedBaseProvider:Re.selectedBaseProvider,selectedProviderIndex:Re.selectedProviderIndex}),"resetSwapper"),setBuyFungible:i(t=>e({buyFungible:t}),"setBuyFungible"),setBuyUsdValue:i(t=>e({buyUsdValue:t}),"setBuyUsdValue"),setHasNoRoutes:i(t=>e({hasNoRoutes:t}),"setHasNoRoutes"),setIsFetchingQuote:i(t=>e({isFetchingQuote:t}),"setIsFetchingQuote"),setQuoteResponse:i(t=>e({quoteResponse:t,hasNoRoutes:!1}),"setQuoteResponse"),setSelectedProviderIndex:i(t=>e({selectedProviderIndex:t}),"setSelectedProviderIndex"),setSelectedBaseProvider:i(t=>e({selectedBaseProvider:t}),"setSelectedBaseProvider"),setGasEstimation:i(({estimate:t,estimateWithBuffer:r,isFetching:o})=>e(n=>({gasEstimation:{...n.gasEstimation,...t!==void 0&&{estimate:t},...r!==void 0&&{estimateWithBuffer:r},...o!==void 0&&{isFetching:o}}})),"setGasEstimation"),setSellAmount:i(t=>e({sellAmount:t}),"setSellAmount"),setAmountType:i(t=>e({amountType:t}),"setAmountType"),setSellUsdValue:i(t=>e({sellUsdValue:t}),"setSellUsdValue"),setSellFungible:i(t=>e({sellFungible:t}),"setSellFungible"),setUiSellAmountCryptoInput:i(t=>e({uiSellAmountCryptoInput:t}),"setUiSellAmountCryptoInput"),setError:i(t=>e({error:t}),"setError"),setSearchQuery:i(t=>e({searchQuery:t}),"setSearchQuery"),setNumSearchResults:i(t=>e({numSearchResults:t}),"setNumSearchResults"),setPrimaryCurrency:i(t=>e({primaryCurrency:t}),"setPrimaryCurrency"),setUiSellAmountLocalFiatInput:i(t=>e({uiSellAmountLocalFiatInput:t}),"setUiSellAmountLocalFiatInput"),setUiBuyAmountCryptoInput:i(t=>e({uiBuyAmountCryptoInput:t}),"setUiBuyAmountCryptoInput"),setUiBuyAmountLocalFiatInput:i(t=>e({uiBuyAmountLocalFiatInput:t}),"setUiBuyAmountLocalFiatInput"),setCanInputFiatSellAmount:i(t=>e({canInputFiatSellAmount:t}),"setCanInputFiatSellAmount"),setSwapFilter:i(t=>e({swapFilter:t}),"setSwapFilter"),switchTokensForSell:i(()=>{e(t=>{let r=t.sellFungible??t.buyFungible,o=t.buyFungible??t.sellFungible,n=t.uiBuyAmountCryptoInput,a=t.uiBuyAmountLocalFiatInput;return{sellFungible:o,buyFungible:r,uiSellAmountCryptoInput:n,uiSellAmountLocalFiatInput:a,uiBuyAmountCryptoInput:Re.uiBuyAmountCryptoInput,uiBuyAmountLocalFiatInput:Re.uiBuyAmountLocalFiatInput,sellAmount:n,swapFilter:void 0,selectedBaseProvider:t.selectedBaseProvider}})},"switchTokensForSell"),switchTokensForBuy:i(()=>{e(t=>{let r=t.sellFungible??t.buyFungible,o=t.buyFungible??t.sellFungible,n=t.uiSellAmountCryptoInput,a=t.uiSellAmountLocalFiatInput;return{sellFungible:o,buyFungible:r,uiSellAmountCryptoInput:Re.uiSellAmountCryptoInput,uiSellAmountLocalFiatInput:Re.uiSellAmountLocalFiatInput,uiBuyAmountCryptoInput:n,uiBuyAmountLocalFiatInput:a,sellAmount:n,swapFilter:void 0,selectedBaseProvider:t.selectedBaseProvider}})},"switchTokensForBuy"),resetUiAmounts:i(()=>e({uiSellAmountCryptoInput:Re.uiSellAmountCryptoInput,uiSellAmountLocalFiatInput:Re.uiSellAmountLocalFiatInput,uiBuyAmountCryptoInput:Re.uiBuyAmountCryptoInput,uiBuyAmountLocalFiatInput:Re.uiBuyAmountLocalFiatInput,sellAmount:Re.sellAmount,selectedBaseProvider:Re.selectedBaseProvider}),"resetUiAmounts"),setPairAndAmount:i(({sell:t,buy:r,swapAmount:o})=>e(n=>{let a="uiSellAmountCryptoInput";return o.perspective==="sell"?n.primaryCurrency==="crypto"?a="uiSellAmountCryptoInput":a="uiSellAmountLocalFiatInput":n.primaryCurrency==="crypto"?a="uiBuyAmountCryptoInput":a="uiBuyAmountLocalFiatInput",{...n,sellFungible:t,buyFungible:r,[a]:o.amount,sellAmount:o.amount}}),"setPairAndAmount")}));u();l();var Ca=s.object({name:s.string(),message:s.string()}),my=s.object({chainId:ft,name:s.string(),symbol:s.string(),decimals:s.number(),logoURI:s.optional(s.string()),includesBridge:s.optional(s.boolean())}),SC=my.extend({address:s.string(),resourceType:s.literal(J.address)}),bC=my.extend({slip44:s.string(),resourceType:s.literal(J.nativeToken)}),EQ=s.union([SC,bC]),fy=s.object({id:s.string(),name:s.string(),logoUri:s.string()}),TC=s.union([s.enum(["network","phantom","gasless","ata","gasless_network","tips","priority_fee","prediction_fee_per_contract"]),s.string()]),xC=s.object({name:s.string(),percentage:s.number(),amount:s.number(),token:s.optional(_t),type:TC}),AC=s.object({name:s.string(),proportion:s.string()}),gy=s.object({sellAmount:s.string(),buyAmount:s.string(),rfqProps:s.optional(s.object({expireAt:s.number(),quoteId:s.string()})),analyticsContext:s.optional(s.string())}),_a=gy.extend({priceImpact:s.number(),sources:s.array(AC),fees:s.array(xC),slippageTolerance:s.optional(s.number()),baseProvider:fy}),EC=s.object({success:s.boolean(),error:s.string().optional(),data:s.object({ataFeeUSD:s.number().optional(),networkFeeUSD:s.number().optional(),totalAmountUSD:s.number().optional()}).optional()}),kC=s.enum(["sync","async"]),Ia=_a.extend({transactionData:s.array(s.string()),gaslessSignature:s.optional(s.string()),gaslessSwapFeeResult:s.optional(EC),executionMode:s.optional(kC)}),CC=Ia,kQ=_a.extend({transactionData:s.array(s.string())}),up=_a.extend({allowanceTarget:s.string(),exchangeAddress:s.string(),gas:s.number(),value:s.string(),transactionData:s.string()}),lp=_a.extend({transactionData:s.array(s.string())}),uy=s.object({name:s.string(),amount:s.string(),token:_t,percentage:s.string(),included:s.boolean(),amountUSD:s.optional(s.string())}),_C=s.object({name:s.string(),key:s.string(),logoURI:s.string()}),hy=s.object({name:s.string(),symbol:s.string()}),IC=s.object({transactionData:s.string(),buyToken:_t,sellToken:_t,nonIncludedNonGasFees:s.string(),feeCosts:s.array(uy),chainId:ft,tool:_C,value:s.optional(s.string()),allowanceTarget:s.optional(s.string()),approvalMetadata:s.optional(hy),approvalExactAmount:s.optional(s.string()),exchangeAddress:s.optional(s.string()),gasCosts:s.optional(s.array(s.number())),includedFeeCosts:s.optional(s.array(uy))}),pp=gy.extend({baseProvider:fy,executionDuration:s.number(),tags:s.array(s.string()),steps:s.array(IC)}),FC=s.union([Ia,up,lp,pp,CC]),Os=s.enum(["solana","eip155","sui","xchain"]),Fa=s.object({type:Os,taker:_t,buyToken:_t,sellToken:_t,slippageTolerance:s.number(),simulationTolerance:s.optional(s.number()),gasBuffer:s.optional(s.number()),quotes:s.array(FC),tradeFee:s.optional(s.array(s.number())),estimateGasFee:s.optional(s.array(s.number())),includesAllProviders:s.optional(s.boolean())}),vC=s.enum(["swap-approval","swap","bridge-approval","bridge"]),PC=s.enum(["swap","bridge"]),RC=s.enum(["swap","bridge"]),DC=s.enum(["bridge"]),va=s.object({sellToken:_t,buyToken:_t,approvalMetadata:s.optional(hy)}),NC=s.object({type:s.literal("solana"),transactions:s.array(s.string()),transactionTypes:s.array(PC),transactionPairs:s.optional(s.array(va))});var BC=s.object({type:s.literal("evm"),transactions:s.array(nn),transactionTypes:s.array(vC),transactionPairs:s.optional(s.array(va))}),LC=s.object({type:s.literal("sui"),transactions:s.array(s.string()),transactionTypes:s.array(RC),transactionPairs:s.optional(s.array(va))}),UC=s.object({type:s.literal("bitcoin"),transactions:s.array(s.string()),transactionTypes:s.array(DC),transactionPairs:s.optional(s.array(va))}),CQ=s.union([NC,BC,LC,UC]),ly;(function(e){e.Pricing="pricing",e.Provider="provider",e.ProviderPressable="providerPressable",e.ExchangeRate="exchangeRate",e.PriceImpact="priceImpact",e.Network="network",e.ExecutionDuration="executionDuration",e.Slippage="slippage",e.SlippagePressable="slippagePressable",e.Fees="fees",e.HighPriceImpact="highPriceImpact",e.HighSlippage="highSlippage",e.TransferFees="transferFees"})(ly||(ly={}));var MC=s.object({name:s.string(),amount:s.string()}).strict(),OC=s.object({name:s.string(),feeUsd:s.number().nullish(),amount:s.string(),time:s.object({text:s.string(),isFast:s.boolean()}),logoURI:s.string()}),_Q=s.union([MC,OC]),py;(function(e){e.Buy="buy",e.Sell="sell"})(py||(py={}));var dy;(function(e){e.SwapProviders="SwapProviders",e.SwapReview="SwapReview",e.SwapTermsOfService="SwapTermsOfService",e.SwapConfirmation="SwapConfirmation",e.InsufficientBalance="InsufficientBalance"})(dy||(dy={}));u();l();function se(e){return pp.safeParse(e).success}i(se,"isBridgeQuote");var Pt=i(e=>Ia.safeParse(e).success,"isSolanaSwapQuote"),yy=i(e=>Pt(e),"isCashSwapQuote");function lr(e){return up.safeParse(e).success}i(lr,"isEvmSwapQuote");function qr(e){return lp.safeParse(e).success}i(qr,"isSuiSwapQuote");function wy(e){return e?"gaslessSignature"in e:!1}i(wy,"isGaslessSwapQuote");function Ar(e){return Pt(e)||lr(e)||qr(e)}i(Ar,"isSingleNetworkSwapQuote");u();l();var be;(function(e){e.Idle="idle",e.Started="started",e.Simulating="simulating",e.SimulationRequestErrored="simulationRequestErrored",e.SimulationFailed="simulationFailed",e.SimulationSkipped="simulationSkipped",e.Simulated="simulated",e.SubmittingTransaction="submittingTransaction",e.TransactionSubmissionFailed="transactionSubmissionFailed",e.TransactionSubmitted="transactionSubmitted",e.ConfirmingTransaction="confirmingTransaction",e.TransactionNotConfirmed="transactionNotConfirmed",e.TransactionConfirmed="transactionConfirmed"})(be||(be={}));u();l();var V;(function(e){e.ExecuteSwapStarted="executeSwapStarted",e.SimulationRequestStarted="simulationRequestStarted",e.SimulationPassed="simulationPassed",e.SimulationFailed="simulationFailed",e.SimulationSkipped="simulationSkipped",e.SubmittingTransaction="submittingTransaction",e.TransactionSubmissionFailed="transactionSubmissionFailed",e.TransactionSubmissionStarted="transactionSubmissionStarted",e.TransactionSubmissionSuccess="transactionSubmissionSuccess",e.TransactionConfirmationStarted="transactionConfirmationStarted",e.TransactionConfirmationFailed="transactionConfirmationFailed",e.TransactionConfirmed="transactionConfirmed"})(V||(V={}));u();l();function At(e){return e.type==="pair"||e.type==="changingToken"||e.type==="refreshing"}i(At,"hasPair");u();l();var hd=P(Be());var Xt=P(O());u();l();u();l();u();l();u();l();var zr="cash-account",QC="grouped-balances",Qs=[zr,QC],dp=[zr,"cash-activity"],uo={account:i((e,t)=>[zr,"account",{userId:e,isCashEnabled:t}],"account"),balance:i((e,t)=>[zr,"balance",{userId:e,isCashEnabled:t}],"balance"),cashKMSAccount:i(e=>[zr,"kms-account",{user:e}],"cashKMSAccount"),bankDetails:i(e=>[zr,"bankDetails",{user:e}],"bankDetails"),enrollment:i(e=>[zr,"enrollment",{userId:e}],"enrollment"),groupedBalances:i((e,t,r)=>[...Qs,{userID:e,addresses:t,isCashEnabled:r}],"groupedBalances"),lastBroadcastDate:i(()=>[zr,"lastBroadcastDate"],"lastBroadcastDate"),cashActivity:i((e,t)=>[...dp,{userID:e?.userID,params:t}],"cashActivity"),waitlistEntry:i(e=>[zr,"waitlist-entry",e],"waitlistEntry")};var Pa=i((e,t)=>e.invalidateQueries({queryKey:uo.balance(t)}),"invalidateCashBalance"),Sy=i(e=>e.invalidateQueries({queryKey:Qs}),"invalidateGroupedBalances"),by=i(e=>e.invalidateQueries({queryKey:dp}),"invalidateCashActivity");var Ty=i(async(e,t)=>{let r=new Date().toISOString();await t.set("cash-account:lastBroadcastDate",r),e.setQueryData(uo.lastBroadcastDate(),r),await e.invalidateQueries({queryKey:uo.lastBroadcastDate()})},"invalidateLastBroadcastDate");u();l();u();l();u();l();function xy(e){return e.toLowerCase().replace(/(^|\s|\.)(\w)/g,(t,r,o)=>r+o.toUpperCase())}i(xy,"toTitleCase");u();l();var mp;(function(e){e.NotEnrolled="not_enrolled",e.Unverified="unverified",e.Verified="verified",e.Suspended="suspended",e.Closed="closed"})(mp||(mp={}));var fp;(function(e){e.Crypto="crypto",e.CryptoRecover="crypto_recover",e.Banking="banking",e.Fiat="fiat",e.Cards="cards",e.PaymentLinks="payment_links",e.AccountManagement="account_management"})(fp||(fp={}));var gp;(function(e){e.NotEnrolled="not_enrolled",e.Unverified="unverified",e.Verified="verified"})(gp||(gp={}));var Gr;(function(e){e.PhantomUsername="phantom_username",e.Signup="signup",e.Tos="tos",e.Kyc="kyc",e.EmailVerification="email_verification",e.DataSharingConsent="data_sharing_consent",e.L1KycVerification="l1_kyc_verification",e.L2DocumentVerification="l2_document_verification"})(Gr||(Gr={}));var Ra;(function(e){e.Pending="pending",e.Completed="completed",e.Verified="verified",e.Failed="failed",e.Rejected="rejected",e.NotStarted="not_started",e.Expired="expired",e.NotApplicable="not_applicable"})(Ra||(Ra={}));var Ay=s.nativeEnum(mp),qC=s.nativeEnum(fp),Ey=s.nativeEnum(gp),zC=s.nativeEnum(Gr),GC=s.nativeEnum(Ra),KC=s.object({type:zC,status:GC.nullish().transform(D),description:s.string().nullish().transform(D),url:s.string().nullish().transform(D),errorMessage:s.string().nullish().transform(D),metadata:s.record(s.string(),s.any()).nullish().transform(D)}),Da;(function(e){e.NotStarted="not_started",e.Pending="pending",e.Failed="failed",e.Rejected="rejected",e.Verified="verified"})(Da||(Da={}));var jC=s.object({kycStartedAt:s.string().nullish().transform(D),idVerificationStatus:s.nativeEnum(Da).nullish().transform(D),kycVerificationStatus:s.nativeEnum(Da).nullish().transform(D)}),VC=s.object({consentTimestamp:s.string().nullish().transform(D),consented:s.boolean().nullish().transform(D)}),$C=s.object({authIntentId:s.string().nullish().transform(D)}),HC=s.object({kycMetadata:jC.nullish().transform(D),dataSharing:VC.nullish().transform(D),authIntent:$C.nullish().transform(D)}),WC=s.object({type:s.string(),required:s.boolean(),description:s.string().nullish().transform(D)}),ZC=s.object({type:s.nativeEnum(Gr),required:s.boolean(),description:s.string(),data:s.object({type:s.union([s.literal(Gr.DataSharingConsent),s.literal(Gr.L1KycVerification),s.literal(Gr.L2DocumentVerification)]).nullish().transform(D),currentStatus:s.nativeEnum(Ra).nullish().transform(D),authIntentId:s.string().nullish().transform(D),consentRequired:s.boolean().nullish().transform(D)}).nullish().transform(D)}),Na;(function(e){e.NotStarted="not_started",e.Pending="pending",e.Failed="failed",e.RegionLocked="region_locked",e.NeedsMoreInfo="needs_more_info",e.Completed="completed",e.CardReady="card_ready"})(Na||(Na={}));var hp=s.object({accountStatus:Ay.nullish().transform(D),features:s.array(qC).optional().default([]),availableTransitions:s.array(Ay).optional().default([]),canAdvance:s.boolean().optional().default(!1),currentTier:Ey.nullish().transform(D),nextTier:Ey.nullish().transform(D),nextTierDescription:s.string().nullish().transform(D),nextTierRequirements:s.array(KC).optional().default([]),nextTierRequiredFields:s.record(s.string(),WC).nullish().transform(D),nextSteps:s.array(ZC).optional().default([]),verificationState:s.nativeEnum(Na).nullish().transform(D),metadata:HC.nullish().transform(D)});var Ba;(function(e){e.NotSubmitted="not_submitted",e.Accepted="accepted",e.NotAccepted="not_accepted"})(Ba||(Ba={}));var La;(function(e){e.NotSubmitted="not_submitted",e.Incomplete="incomplete",e.PendingReview="pending",e.Approved="approved",e.Rejected="rejected"})(La||(La={}));var Ua;(function(e){e.Crypto="crypto",e.CryptoRecover="crypto_recover",e.Banking="banking",e.Fiat="fiat",e.Cards="cards",e.PaymentLinks="payment_links",e.AccountManagement="account_management"})(Ua||(Ua={}));var YC=i(e=>Object.values(Ua).includes(e),"canUseCashAccountFeature"),Me;(function(e){e.Pending="pending",e.Processing="processing",e.Completed="completed",e.Refunded="refunded",e.Failed="failed",e.Canceled="canceled",e.Unknown="unknown"})(Me||(Me={}));var Ma;(function(e){e.Debit="debit",e.Credit="credit"})(Ma||(Ma={}));var Oa;(function(e){e.Transfer="transfer",e.Swap="swap",e.PerpsFunding="perps_funding",e.Refund="refund",e.KycUpdate="kyc_update",e.AccountUpdate="account_update",e.Microdeposit="microdeposit",e.UserCardLock="user_card_lock",e.UserCardUnlock="user_card_unlock",e.PhantomCardLock="phantom_card_lock",e.PhantomCardUnlock="phantom_card_unlock",e.CardTransaction="card_transaction",e.CardPinUpdated="card_pin_updated",e.Onramp="onramp",e.Delegation="delegation",e.Recovery="recovery",e.Unknown="unknown"})(Oa||(Oa={}));var Qa=class extends Error{static{i(this,"CashAccountNotFoundError")}constructor(t){super(`Cash account not found for user ${t}. User is not enrolled in cash account.`),this.name="CashAccountNotFoundError"}},qa=class extends Error{static{i(this,"CashAccountValidationError")}zodError;responseData;constructor(t,r){let o=t.issues.map(n=>`${n.path.length>0?n.path.join("."):"root"}: ${n.message}`).join("; ");super(`Cash account validation failed: ${o}`),this.name="CashAccountValidationError",this.zodError=t,this.responseData=r}},ja=s.object({id:s.string(),primaryEmail:s.string().nullish().transform(D),accountStatus:s.string().nullish().transform(D),addressDetails:s.object({address:s.string()}),features:s.array(s.string()).transform(e=>e.filter(YC)),limits:s.object({dailyFiatTransfer:s.string().nullish().transform(D),monthlyFiatTransfer:s.string().nullish().transform(D)}).nullish().transform(D),waitlistDetails:s.object({waitlist:s.boolean(),priorityWaitlist:s.boolean()}).nullish().transform(D),isRegionLocked:s.boolean().nullish().transform(D),linkDetails:s.object({cryptoCustomerId:s.string().nullish().transform(D),authIntentId:s.string().nullish().transform(D),linkEmail:s.string().nullish().transform(D)}).nullish().transform(D)});var gq=s.object({sourceCurrency:s.string().nullish().transform(D),destinationCurrency:s.string().nullish().transform(D),destinationBlockchain:s.string().nullish().transform(D),destinationAddress:s.string().nullish().transform(D),accountNumber:s.string().nullish().transform(D),routingNumber:s.string().nullish().transform(D),accountType:s.string().nullish().transform(D),bankName:s.string().nullish().transform(D),bankAddress:s.string().nullish().transform(D),bankBeneficiaryName:s.string().transform(xy).nullish().transform(D),bankBeneficiaryAddress:s.string().nullish().transform(D)}),XC=s.object({price:s.number(),priceChange24h:s.number(),lastUpdatedAt:s.string().transform(e=>new Date(e))}),JC=s.object({account:s.string(),quantity:s.number(),quantityString:s.string()}),e_=s.object({address:s.string(),quantity:s.number(),quantityString:s.string(),lastTransferredDate:s.string().nullish().transform(D),subaccounts:s.array(JC).nullish().transform(D)}),t_=s.object({isMutable:s.boolean().nullish().transform(D),creators:s.array(s.string()).nullish().transform(D),tokenProgram:s.string().nullish().transform(D),extensions:s.array(s.any()).nullish().transform(D),compression:s.record(s.any()).nullish().transform(D)}),r_=s.object({caip19:s.string(),name:s.string(),symbol:s.string(),decimals:s.number(),spamStatus:s.string().nullish().default(""),logoUri:s.string().nullish().default(""),totalQuantity:s.number(),totalQuantityString:s.string(),price:XC.nullish().transform(D),queriedWalletBalances:s.array(e_),extraMetadata:t_}),o_=s.object({email:s.string().email(),cashAccountAddress:s.string(),idempotencyKey:s.string()}),n_=s.object({enrollmentDetails:s.object({kycStatus:s.nativeEnum(La),kycUrl:s.string(),tosStatus:s.nativeEnum(Ba),tosUrl:s.string()})}),za;(function(e){e.TRANSFER_TO_BANK="transfer_to_bank",e.TRANSFER_TO_USERNAME="transfer_to_username",e.TRANSFER_TO_WALLET="transfer_to_wallet",e.WITHDRAWAL_TO_WALLET="withdrawal_to_wallet",e.SELL_TOKENS="sell_tokens",e.CARD_BANK_DEPOSIT="card_bank_deposit",e.VIRTUAL_ACCOUNT_DEPOSIT="virtual_account_deposit",e.DELEGATE_WALLET_ACCOUNT="delegate_wallet_account"})(za||(za={}));var s_=s.object({account:s.string(),quantity:s.number(),quantityString:s.string()}),i_=s.object({address:s.string(),quantity:s.number(),quantityString:s.string(),lastTransferredDate:s.string().nullish().transform(D),subaccounts:s.array(s_).nullish().transform(D)}),a_=s.object({isMutable:s.boolean().nullish().default(null),creators:s.array(s.unknown()).nullish().transform(D),tokenProgram:s.string().nullish().transform(D),extensions:s.array(s.unknown()).nullish().transform(D)}),ky=s.object({caip19:s.string(),name:s.string(),symbol:s.string(),decimals:s.number(),logoUri:s.string(),spamStatus:s.string(),totalQuantity:s.number(),totalQuantityString:s.string(),queriedWalletBalances:s.array(i_),extraMetadata:a_.nullish().transform(D),price:s.object({price:s.number(),priceChange24h:s.number().nullish().transform(D),lastUpdatedAt:s.coerce.date(),marketCap:s.number().nullish().transform(D)}).nullish()}),hq=s.object({stablecoins:s.array(ky),otherTokens:s.array(ky),totalStablecoinsValueUsd:s.string().nullish().transform(D),totalOtherTokensValueUsd:s.string().nullish().transform(D)}),Ga;(function(e){e.UNVERIFIED="unverified",e.VERIFIED="verified"})(Ga||(Ga={}));var yp;(function(e){e.AlreadyExists="already_exists",e.InProgress="in_progress",e.Pending="pending",e.Completed="completed"})(yp||(yp={}));var c_=s.object({targetState:s.nativeEnum(Ga),data:s.object({email:s.string().email().optional(),cashAccountAddress:s.string().optional()}),idempotencyKey:s.string().optional()}),u_=hp.extend({account:ja}),l_=s.object({requirementType:s.nativeEnum(Gr),evidence:s.object({authIntentId:s.string(),providerCustomerId:s.string(),dataSharing:s.object({consented:s.boolean()})})}),p_=hp.extend({account:ja}),Kr;(function(e){e.BankAccountId="bank_account_id",e.Bank="bank",e.Crypto="crypto",e.PhantomUsername="phantom_username",e.Merchant="merchant"})(Kr||(Kr={}));var d_=s.nativeEnum(Kr),m_=s.object({type:s.literal("fiat"),currency:s.string(),value:s.string()}),f_=s.object({type:s.literal("token"),token:s.string(),symbol:s.string(),value:s.string(),decimals:s.number()}),Iy=s.discriminatedUnion("type",[m_,f_]),Cy;(function(e){e.Fiat="fiat",e.Token="token"})(Cy||(Cy={}));var g_=s.record(s.string(),Iy),Fy=s.object({accountHolderName:s.string().nullish().transform(D),accountNumber:s.string().nullish().transform(D),accountType:s.string().nullish().transform(D),bankName:s.string().nullish().transform(D),nickname:s.string().nullish().transform(D)}),zs=s.object({type:d_,currency:s.string(),name:s.string().nullish().transform(D),phantomUsername:s.string().nullish().transform(D)}),h_=zs.extend({type:s.literal(Kr.BankAccountId),bankDetails:Fy.nullish().transform(D)}),y_=zs.extend({type:s.literal(Kr.Bank),bankDetails:Fy.nullish().transform(D)}),w_=zs.extend({type:s.literal(Kr.Crypto),address:s.string().nullish().transform(D),phantomUsername:s.string().nullish().transform(D)}),S_=s.object({merchantName:s.string().nullish().transform(D),merchantCategoryCode:s.string().nullish().transform(D)}),b_=s.object({name:s.string().nullish().transform(D),categoryPrimary:s.string().nullish().transform(D),categoryDetailed:s.string().nullish().transform(D),icon:s.string().nullish().transform(D),website:s.string().nullish().transform(D),location:s.any().nullish().transform(D)}),T_=zs.extend({type:s.literal(Kr.Merchant),merchantDetails:S_.nullish().transform(D),enrichedMerchantDetails:b_.nullish().transform(D),category:s.string().nullish().transform(D),icon:s.string().nullish().transform(D),website:s.string().nullish().transform(D)}),wp;(function(e){e.Following="following"})(wp||(wp={}));var x_=zs.extend({type:s.literal(Kr.PhantomUsername),phantomUsername:s.string().nullish().transform(D),icon:s.string().nullish().transform(D),relationship:s.nativeEnum(wp).nullish().transform(D)}),A_=s.union([h_,y_,w_,x_,T_]),_y=s.object({amount:s.string(),decimals:s.number(),logoUri:s.string().nullish().transform(D),mint:s.string(),name:s.string().nullish().transform(D),owner:s.string(),symbol:s.string().nullish().transform(D)}),Bo;(function(e){e.CashOut="cash_out",e.Swap="swap"})(Bo||(Bo={}));var E_=s.object({input:_y,output:_y,quoteId:s.string().nullish().transform(D),quoteSource:s.string().nullish().transform(D),type:s.nativeEnum(Bo).nullish().transform(D)}),yq=s.object({type:s.nativeEnum(Oa),id:s.string(),state:s.nativeEnum(Me),occurredAt:s.string(),counterparty:A_,direction:s.nativeEnum(Ma),amount:Iy,feeBreakdown:g_.nullish().default(null),metadata:s.object({swapInfo:E_.nullish().default(null),merchant:s.any().nullish().default(null),enrichment:s.object({lastEnrichedAt:s.string().nullish().transform(D),source:s.string().nullish().transform(D)}).nullish().transform(D)}).nullish().default(null),onchainTxId:s.string().nullish().transform(D)}),Ka;(function(e){e.PENDING="pending",e.ACTIVATED="activated",e.REJECTED="rejected"})(Ka||(Ka={}));var qs;(function(e){e.EXTERNAL="external",e.USER="user"})(qs||(qs={}));var vy=i(e=>Object.values(Ka).includes(e),"canUseWaitlistStatus"),Py=i(e=>Object.values(qs).includes(e),"canUseWaitlistSource"),wq=s.object({email:s.string().email(),country:s.string().length(2).nullish().transform(D),state:s.string().nullish().transform(D),referralCode:s.string().nullish().transform(D),marketingOptIn:s.boolean().default(!0),source:s.string().refine(Py).default(qs.USER)}),Sq=s.object({id:s.string(),referralCode:s.string(),position:s.number().nullish().transform(D)}),bq=s.object({id:s.string(),email:s.string(),country:s.string(),state:s.string().nullish().transform(D),status:s.string().refine(vy),referralCode:s.string(),referralCodeUsed:s.string().nullish().transform(D),marketingOptIn:s.boolean(),source:s.string().refine(Py).nullish().transform(D),position:s.number().nullish().transform(D),totalReferrals:s.number().nullish().transform(D),createdAt:s.string(),activatedAt:s.string().nullish().transform(D)}),Tq=s.object({id:s.string(),position:s.number(),referralBoost:s.number(),referralCode:s.string(),referralCount:s.number(),status:s.string().refine(vy)});var Gs=i(e=>{let{data:t}=wr(),{userID:r}=t??{},o=ze("enable-cash"),{canUseCash:n}=Lf(),a=o&&n,{data:c}=Nf(),p=!!c?.username,d=!!(r&&e?.enabled!==!1&&a&&p);return ie({...e,queryKey:uo.account(r,a),enabled:d,queryFn:i(async()=>{if(!r)throw new Error("useCashAccount: userID is required");let m=r;try{let f=await K.api().bearer(!0).get(`/cash/v1/users/${m}/cash-account`),h=ja.safeParse(f.data);if(!h.success)throw new qa(h.error,f.data);return h.data}catch(f){switch(f?.response?.status||f?.response?.data?.statusCode){case 204:case 404:case 403:throw new Qa(m);default:break}throw R.captureError(f,U.Cash),f}},"queryFn")})},"useCashAccount");u();l();var k_=P(O());var C_=i((e,t,r)=>{let o=i(c=>{if(c.caip19!==t)return c;let d=new _(c.totalQuantity).plus(r),m=d.isLessThan(0)?new _(0):d;return{...c,totalQuantity:m.toNumber(),totalQuantityString:m.toString(),queriedWalletBalances:c.queriedWalletBalances}},"updateTokenBalance"),n=e.stablecoins.some(c=>c.caip19===t),a=e.otherTokens.some(c=>c.caip19===t);return!n&&!a?e:{...e,stablecoins:n?e.stablecoins.map(o):e.stablecoins,otherTokens:a?e.otherTokens.map(o):e.otherTokens}},"transformGroupedBalances");function Sp(e,t,r){e.getQueriesData({queryKey:Qs,exact:!1}).forEach(([n,a])=>{if(a){let c=C_(a,t,r);e.setQueryData(n,c)}})}i(Sp,"updateGroupedBalances");u();l();u();l();function bp(e,t,r){if(pn("kill-cash-balance-optimistic-update")||!r)return;let n=uo.balance(r,!0);e.setQueryData(n,a=>{if(!a)return a;let p=new _(a.totalQuantity).plus(t);return{...a,totalQuantity:p.toNumber(),totalQuantityString:p.toString()}}),Pa(e,r)}i(bp,"updateCashBalance");var __=z({seconds:3}),Tp=i(async({queryClient:e,storage:t,authRepository:r,sellCaip19:o,sellAddress:n,sellAmountBN:a,buyCaip19:c,buyAddress:p,buyAmountBN:d,cashAccountAddress:m})=>{let h=(await r.getUser())?.userID??"";F_({queryClient:e,sellCaip19:o,sellAmountBN:a,sellAddress:n,buyCaip19:c,buyAmountBN:d,buyAddress:p,cashAccountAddress:m,userId:h}),await Ty(e,t),await new Promise(y=>setTimeout(y,__)),await I_(e,h)},"invalidateCashSwap"),I_=i(async(e,t)=>Promise.all([Sy(e),Pa(e,t),by(e)]),"invalidateCashSwapQueries"),F_=i(({queryClient:e,sellCaip19:t,sellAmountBN:r,sellAddress:o,buyCaip19:n,buyAmountBN:a,buyAddress:c,cashAccountAddress:p,userId:d})=>{if(!d)return;let m=M(t),f=M(n);p&&o===p?bp(e,r.negated(),d):Sp(e,m,r.negated()),p&&c===p?bp(e,a,d):Sp(e,f,a),v_({sellCaip19:t,sellAmountBN:r,sellAddress:o,buyCaip19:n,buyAmountBN:a,buyAddress:c,cashAccountAddress:p})},"optimisticUpdate"),v_=i(({sellCaip19:e,sellAmountBN:t,sellAddress:r,buyCaip19:o,buyAmountBN:n,buyAddress:a,cashAccountAddress:c})=>{let p=pn("kill-cash-balance-optimistic-update");r===c?R.addBreadcrumb(U.Cash,`[optimisticUpdate] buying ${n.toString()} ${o} w/ ${t.toString()} cash, isKillSwitchEnabled: ${p}`,Y.Debug):a===c?R.addBreadcrumb(U.Cash,`[optimisticUpdate] buying ${n.toString()} (cash) w/ ${t.toString()} ${e}, isKillSwitchEnabled: ${p}`,Y.Debug,{amount:n.toString()}):R.addBreadcrumb(U.Cash,`[optimisticUpdate] [non-cash] buying ${n.toString()} ${o} w/ ${t.toString()} ${e}`,Y.Debug)},"logOptimisticUpdate");var Dy=P(O());u();l();var Ry=i(e=>{let t=e?.addressDetails?.address;return t?{[me.Solana.Mainnet]:t}:{}},"createSwapperCashAddresses");var Va=i(()=>{let{data:e}=Gs();return(0,Dy.useMemo)(()=>Ry(e),[e])},"useSwapperCashAddresses");u();l();u();l();u();l();var P_=["SwapperNoQuotes","UnsupportedCountry","UnknownError"],Ny=i((e,t,r,o)=>{e instanceof je&&P_.includes(e.code)||(!t||t>=400&&t<500)&&R.addBreadcrumb(r,JSON.stringify(o),Y.Info)},"captureClientError");u();l();var By=i(async(e,t,r=void 0)=>{if(de(e))return Promise.resolve();let o;try{o=e.data}catch{throw new je({key:r})}let n=Ca.safeParse(o);throw n.success?(R.addBreadcrumb(t,JSON.stringify(n.data),Y.Info),new je({key:n.data.name})):new je({key:r})},"handleBadResponse");u();l();var Ly=i(e=>{let t=new je({key:"SwapperNoQuotes"});if(Os.safeParse(e?.type).success===!1)throw R.captureError(new Error("Failed to parse a valid quote type."),U.Swapper),new Error("Invalid input");let r=Fa.safeParse(e);if(!r.success)throw R.captureError(new Error("Failed to parse a valid swap quotes response."),U.Swapper),t;if(r.data.quotes.length===0)throw t;return r.data},"parseSwapQuotesResponse");var Uy="swap-quotes";async function $a({sellTokenCaip19:e,buyTokenCaip19:t,taker:r,takerDestination:o,exactOut:n,sellAmount:a,sellAmountUsd:c,slippageTolerance:p,signal:d,enableAutoSlippage:m,priorityFee:f,tipAmount:h,phantomCashAccount:y,isPrediction:w,predictions:S}){let T;try{Fs(r)&&(r.address=r.address.toLowerCase()),o&&Fs(o)&&(o.address=o.address.toLowerCase()),Fs(t)&&(t.address=t.address.toLowerCase()),Fs(e)&&(e.address=e.address.toLowerCase());let b="/swap/v2/quotes",x={sellToken:e,buyToken:t,taker:r,takerDestination:o,exactOut:n,sellAmount:a,sellAmountUsd:c,slippageTolerance:p,autoSlippage:m,priorityFee:f,tipAmount:h,phantomCashAccount:y,isPrediction:w,predictions:S},E=await K.api().post(b,x,{signal:d});return T=E.status,await By(E,Uy,"SwapperNoQuotes"),Ly(E.data)}catch(b){let x=b instanceof je?b:new je;throw Ny(x,T,Uy,{sellToken:e,buyToken:t,sellAmount:a,sellAmountUsd:c,slippageTolerance:p}),x}}i($a,"getSwapQuotes");var Ha=class{static{i(this,"WalletSwapApiClient")}getQuotes(t){return $a({sellTokenCaip19:t.sell,buyTokenCaip19:t.buy,taker:t.taker,takerDestination:t.takerDestination,sellAmount:t.amount,sellAmountUsd:t.amountUsd,slippageTolerance:t.slippageTolerance,signal:t.signal,exactOut:t.exactOutEnabled,priorityFee:t.priorityFee,tipAmount:t.tipAmount,enableAutoSlippage:t.autoSlippageEnabled,phantomCashAccount:t.phantomCashAccount})}};u();l();u();l();var Wa=class{static{i(this,"BridgeTrackingSwapCommand")}inner;bridgeStatusManager;executingQuote;takerAddress;networkId;quote;executionId;constructor(t,r,o){this.inner=t,this.bridgeStatusManager=r,this.executingQuote=o,this.takerAddress=t.takerAddress,this.networkId=t.networkId,this.quote=t.quote,this.executionId=t.executionId}createTransaction(){return this.inner.createTransaction()}swap(t,r,o,n,a){return this.inner.swap(t,r,o,n,a)}async waitForConfirmation(t){await this.bridgeStatusManager.track({executionId:this.executionId,executingQuote:this.executingQuote,transactionHash:t.id}),await this.inner.waitForConfirmation(t)}};u();l();u();l();u();l();var Rt="swapper",tt;(function(e){e.quotes="quotes",e.transactions="transactions",e.slippageTolerance="slippageTolerance",e.priorityFee="priorityFee",e.tipAmount="tipAmount",e.presence="presence",e.lastSubmittedPairs="lastSubmittedPairsV2",e.lastSelectedTokens="lastSelectedTokens",e.slippageSettings="slippageSettings",e.priorityFeeSettings="priorityFeeSettings",e.tipSettings="tipSettings",e.hasViewedAutoSlippageOptIn="hasViewedAutoSlippageOptIn",e.optimisticUpdates="optimisticUpdates",e.autoSlippageMigrationVersion="autoSlippageMigrationVersion"})(tt||(tt={}));var My=[Rt,tt.quotes],we={quotesScope:i(()=>My,"quotesScope"),quotes:i(({sellTokenCaip19:e,buyTokenCaip19:t,taker:r,amountValue:o,amountType:n,slippageTolerance:a,priorityFee:c,tipAmount:p,takerDestination:d,enableAutoSlippage:m,preferredProvider:f,phantomCashAccount:h})=>[...My,{sellToken:e,buyToken:t,taker:r,takerDestination:d,amountValue:o,amountType:n,slippageTolerance:a,priorityFee:c,tipAmount:p,enableAutoSlippage:m,preferredProvider:f,phantomCashAccount:h}],"quotes"),transactions:i(e=>[Rt,tt.transactions,e],"transactions"),presence:i(e=>[Rt,tt.presence,e],"presence"),slippageTolerance:i(()=>[Rt,tt.slippageTolerance],"slippageTolerance"),priorityFee:i(()=>[Rt,tt.priorityFee],"priorityFee"),tipAmount:i(()=>[Rt,tt.tipAmount],"tipAmount"),lastSubmittedPairs:i(()=>[Rt,tt.lastSubmittedPairs],"lastSubmittedPairs"),lastSelectedTokens:i(()=>[Rt,tt.lastSelectedTokens],"lastSelectedTokens"),slippageSettings:i(()=>[Rt,tt.slippageSettings],"slippageSettings"),priorityFeeSettings:i(()=>[Rt,tt.priorityFeeSettings],"priorityFeeSettings"),tipSettings:i(()=>[Rt,tt.tipSettings],"tipSettings"),hasViewedAutoSlippageOptIn:i(()=>[Rt,tt.hasViewedAutoSlippageOptIn],"hasViewedAutoSlippageOptIn"),optimisticUpdates:i(()=>[Rt,tt.optimisticUpdates],"optimisticUpdates"),autoSlippageMigrationVersion:i(()=>[Rt,tt.autoSlippageMigrationVersion],"autoSlippageMigrationVersion")};u();l();var Za;(function(e){e[e.Always=1/0]="Always",e[e.Short=z({days:1})]="Short",e[e.Medium=z({days:3})]="Medium",e[e.Long=z({days:7})]="Long"})(Za||(Za={}));var Ya;(function(e){e[e.Immediate=0]="Immediate",e[e.Short=z({minutes:1})]="Short",e[e.Medium=z({minutes:2.5})]="Medium",e[e.Long=z({minutes:60})]="Long",e[e.Never=1/0]="Never"})(Ya||(Ya={}));var In;(function(e){e[e.Short=z({seconds:20})]="Short",e[e.Medium=z({minutes:2.5})]="Medium",e[e.Long=z({minutes:5})]="Long"})(In||(In={}));var Oy=i(async({callerAddress:e,contractAddress:t,networkId:r,sellAmount:o,allowanceTarget:n,approvalExactAmount:a,exchangeAddress:c,value:p,transactionData:d,type:m})=>{let f=[],h=[];if(t&&(await ig({callerAddress:e,spender:n,networkId:r,contractAddress:t})).lt(a??o.toString())){let S=await ag({callerAddress:e,spender:n,networkId:r,contractAddress:t,exactAmount:a});f.push(S),h.push(`${m}-approval`)}let y=nn.parse({type:Zm.eip1559,from:e,data:d,chainId:A.getEVMNetworkIDValue(r),to:c,...p==="0"?{}:{value:`0x${new L(p).toString(16)}`}});return f.push(y),h.push(m),{transactions:f,transactionTypes:h}},"createEVMTransactions"),Ks=i(async({networkId:e,callerAddress:t,quote:r})=>{let{sellAmount:o,steps:n}=r,a=[],c=[],p=[];for(let d of n){let{allowanceTarget:m,exchangeAddress:f,value:h,transactionData:y,sellToken:w,buyToken:S,approvalMetadata:T}=d,b=w.resourceType===J.address?w.address:null,x=A.compareNetworkID(w.chainId,S.chainId)===0?"swap":"bridge";if(!m||!f||!y||!h)throw new Error("Missing bridge step data for EVM bridge quote.");let E=await Oy({callerAddress:t,contractAddress:b,networkId:e,sellAmount:o,allowanceTarget:m,approvalExactAmount:d.approvalExactAmount,exchangeAddress:f,value:h,transactionData:y,type:x});a.push(...E.transactions),c.push(...E.transactionTypes),p.push({sellToken:w,buyToken:S,approvalMetadata:T}),E.transactionTypes.length==2&&E.transactionTypes.find(C=>C.includes("approval"))&&p.push({sellToken:w,buyToken:S,approvalMetadata:T})}return{type:"evm",transactions:a,transactionTypes:c,transactionPairs:p}},"processEVMBridgeQuote"),js=i(async({quote:e,connection:t})=>{let r=[],o=[],n=[];for(let a of e.steps){let{transactionData:c,sellToken:p,buyToken:d}=a,m=A.compareNetworkID(p.chainId,d.chainId)===0?"swap":"bridge",f=await Qy(c,t);r.push(hl.serialize(f).transaction),o.push(m),n.push({sellToken:p,buyToken:d})}return{type:"solana",transactions:r,transactionTypes:o,transactionPairs:n}},"processSolanaBridgeQuote"),Vs=i(async({networkId:e,callerAddress:t,quote:r,sellFungible:o})=>{let n=o.type===oe.ERC20&&o?.data.tokenAddress?o.data.tokenAddress:null,{allowanceTarget:a,exchangeAddress:c,sellAmount:p,value:d}=r;return{type:"evm",...await Oy({callerAddress:t,contractAddress:n,networkId:e,sellAmount:p,allowanceTarget:a,exchangeAddress:c,value:d,transactionData:r.transactionData,type:"swap"})}},"processEVMSwapQuote"),$s=i(async({quote:e})=>{let t=[],r=[],o=[];for(let n of e.steps){let{transactionData:a,sellToken:c,buyToken:p}=n,d=A.compareNetworkID(c.chainId,p.chainId)===0?"swap":"bridge";t.push(a),r.push(d),o.push({sellToken:c,buyToken:p})}return{type:"sui",transactions:t,transactionTypes:r,transactionPairs:o}},"processSuiBridgeQuote"),Xa=i(async({quote:e})=>{let t=[],r=[],o=[];for(let n of e.steps){let{transactionData:a,sellToken:c,buyToken:p}=n;t.push(a),r.push("bridge"),o.push({sellToken:c,buyToken:p})}return{type:"bitcoin",transactions:t,transactionTypes:r,transactionPairs:o}},"processBitcoinBridgeQuote"),Qy=i(async(e,t)=>{let r=kt(e,"bs58");return await eg(r,{connection:t,transactionType:gn.Swap})},"addPriorityFeeToEncodedTx"),Fn=i(async({quote:e,connection:t})=>{let r=e.transactionData.map(c=>Qy(c,t)),n=(await Promise.all(r)).map(c=>hl.serialize(c).transaction);return{type:"solana",transactionTypes:n.map(()=>"swap"),transactions:n}},"processSolanaSwapQuote"),qy=i(async({quote:e,connection:t})=>Fn({quote:e,connection:t}),"processCashSwapQuote"),Hs=i(async({quote:e})=>({type:"sui",transactionTypes:Array(e.transactionData.length).fill("swap"),transactions:e.transactionData}),"processSuiSwapQuote"),zy=i(({callerAddress:e,sellFungible:t,quote:r})=>{let{connection:o}=Tn(),n=we.transactions(r);return ie({queryKey:n,enabled:!!r&&!!t,gcTime:0,staleTime:0,refetchInterval:In.Short,async queryFn(){try{if(!r)throw new Error("Missing quote");if(!t)throw new Error("Missing sell token");let a=t.data.chain.id;if(Ar(r)){if(A.isEVMNetworkID(a)&&lr(r))return await Vs({networkId:a,callerAddress:e,quote:r,sellFungible:t});if(A.isSolanaNetworkID(a)&&Pt(r))return Fn({quote:r,connection:o});if(A.isSuiNetworkID(a)&&qr(r))return Hs({quote:r});throw new Error(`Single network swap quote not supported for network ID ${a}`)}if(se(r)){if(A.isEVMNetworkID(a))return await Ks({networkId:a,callerAddress:e,quote:r});if(A.isSolanaNetworkID(a))return await js({quote:r,connection:o});if(A.isSuiNetworkID(a))return await $s({quote:r});throw new Error(`Bridge quote not supported for network ID ${a}`)}throw new Error("Swap quote type not supported")}catch(a){throw a instanceof Error&&R.captureError(a,U.Swapper),a}}})},"useSwapTransactions");u();l();var lo=P(cf());u();l();var $y=P(O());u();l();var Gy=P(O());u();l();function De(e){let t=e.reduce((r,o)=>r.add(o.name),new Set);return Array.from(t).join(" + ")}i(De,"parseSwapSources");function Ja(e){return(0,Gy.useMemo)(()=>De(e),[e])}i(Ja,"useProvider");u();l();var jy=P(O());u();l();var Ws=P(O());var Ky=i(()=>{let[e,t]=(0,Ws.useState)(!1),r=j(d=>d.selectedProviderIndex),o=j(d=>d.selectedBaseProvider),n=j(d=>d.quoteResponse),a=(0,Ws.useMemo)(()=>n?n.quotes:[],[n]),c=(0,Ws.useMemo)(()=>{if(Fo){if(!n||n.quotes.length===0)return 0;let d=R_(n,o);return d===-1?(t(o!==ur),0):(t(!1),d)}return r},[n,o,r]),p=a.length>0?a[c]:void 0;return{selectedQuoteIndex:c,selectedBaseProvider:Fo?o:"",currentQuote:p,hasDefaultedToBestQuote:e}},"useSelectedQuote"),R_=i((e,t)=>e.quotes.findIndex(r=>r.baseProvider.id===t),"getQuoteIndexByProvider");function rt(){let e=j(m=>m.quoteResponse),t=j(m=>m.hasNoRoutes),r=j(m=>m.isFetchingQuote),o=(0,jy.useMemo)(()=>e?e.quotes:[],[e]),n=o[0]?.buyAmount??"",{selectedQuoteIndex:a,selectedBaseProvider:c,currentQuote:p,hasDefaultedToBestQuote:d}=Ky();return{bestBuyAmount:n,currentQuote:p,hasNoRoutes:t,quoteResponse:e,quotes:o,selectedProviderIndex:a,selectedBaseProvider:c,isFetchingQuote:r,hasDefaultedToBestQuote:d}}i(rt,"useQuote");u();l();u();l();var vn=i(e=>e.steps.map(t=>t.tool),"getBridgeTools");var Oe=i(e=>e?se(e)?vn(e):e?.sources??[]:[],"getSwapQuoteSources");function Az({sender:e}){let{t}=Fe(),{currentQuote:r}=rt(),o=j(h=>h.buyFungible),n=j(h=>h.sellFungible),a=Ja(Oe(r)),{data:c}=zy({callerAddress:e,quote:r,sellFungible:n}),p=c?.transactionPairs?.flatMap(h=>[...Po(h.sellToken)??[],...Po(h.buyToken)??[]])??[],d=[...new Set(p)],{fungibles:m}=xn({keys:d});return{pendingActivityRows:(0,$y.useMemo)(()=>pr({swapTransactions:c,sellFungible:n,buyFungible:o,fungibles:m,t,currentQuote:r,provider:a}),[c,n,o,m,t,r,a])}}i(Az,"usePendingActivity");function pr({swapTransactions:e,sellFungible:t,buyFungible:r,fungibles:o,currentQuote:n,provider:a,t:c}){let p={pendingSwapActivityRows:[],pendingApprovalActivityRows:[]};return e?e.type==="evm"?e.transactionTypes.reduce((d,m,f)=>{let h=t,y=r,w,S=e.transactionPairs;if(S&&S[f]){let T=S[f];h=ec(T.sellToken,o)??t,y=ec(T.buyToken,o)??r,w=T.approvalMetadata}if(m.includes("approval")){let T=h?.data.symbol??"";d.pendingApprovalActivityRows.push({topLeft:w?{text:`${c("transactionsPendingApproving")} ${w.symbol}`}:{text:`${c("transactionsPendingApproving")} ${T}`}})}else h&&y&&d.pendingSwapActivityRows.push(Vy({sellFungible:h,buyFungible:y,sellAmount:n?.sellAmount,buyAmount:n?.buyAmount,provider:a,isBridge:m.includes("bridge"),t:c}));return d},p):e.transactionTypes.reduce((d,m,f)=>{let h=t,y=r,w=e.transactionPairs;if(w&&w[f]){let S=w[f];h=ec(S.sellToken,o)??t,y=ec(S.buyToken,o)??r}return h&&y&&d.pendingSwapActivityRows.push(Vy({sellFungible:h,buyFungible:y,sellAmount:n?.sellAmount,buyAmount:n?.buyAmount,provider:a,isBridge:m.includes("bridge"),t:c})),d},p):p}i(pr,"getPendingActivityRows");var Vy=i(({sellFungible:e,buyFungible:t,sellAmount:r,buyAmount:o,provider:n,isBridge:a,t:c})=>{let p=e.data.symbol,d=t.data.symbol,m=ke(r??0,e.data.decimals??0),f=ke(o??0,t.data.decimals??0);return{topLeft:{text:`${c(a?"transactionsPendingBridging":"transactionsPendingSwapping")} on ${n}`},topRight:{text:`${f} ${d}`,color:"spotPositive"},bottomLeft:{text:`${p} \u2192 ${d}`},bottomRight:{text:`${m} ${p}`}}},"getPendingSwapActivityRows"),ec=i((e,t)=>t.find(r=>(Po(e)??[]).includes(r.data.key)),"getFungibleFromFungibleCaip19");var tc=class{static{i(this,"BitcoinSwapCommand")}executingQuote;takerAddress;networkId;quote;executionId;constructor(t,r,o,n,a){this.executingQuote=t,this.takerAddress=r,this.networkId=o,this.quote=n,this.executionId=a}async createTransaction(){return Xa({quote:this.quote})}async swap(t,r,o,n,a){let c=r.transactions[0];if(!c)throw new Error("No transaction found");let p=lo.Psbt.fromHex(c),d=this.analyzePsbtInputs(p,this.takerAddress),m=await ng({accountSigner:n,storage:a,accountIdentifier:t,pendingTransactionInput:this.parsePendingTransactionInput(this.executingQuote,r,p),psbt:p,psbtChain:void 0,inputsToSign:d,utxoManager:og(new rg(a))});return{networkID:this.networkId,id:m}}async waitForConfirmation(t){await sg(this.networkId,t.id)}analyzePsbtInputs(t,r){let o=[];if(t.data.inputs.forEach((n,a)=>{let c;if(n.witnessUtxo?c=n.witnessUtxo.script:n.nonWitnessUtxo&&(c=lo.Transaction.fromBuffer(n.nonWitnessUtxo).outs[t.txInputs[a].index].script),c)try{lo.address.fromOutputScript(c,lo.networks.bitcoin)===r&&o.push(a)}catch(p){console.warn(`Could not decode script for input ${a}:`,p)}}),o.length===0)throw new Error(`No inputs found for user address ${r}`);return[{address:r,signingIndexes:o}]}parsePendingTransactionInput(t,r,o){let n=De(Oe(t.quote)),c=pr({swapTransactions:r,sellFungible:t.sell,buyFungible:t.buy,fungibles:[],currentQuote:t.quote,provider:n,t:v.t}).pendingSwapActivityRows[0];return{ownerAddress:this.takerAddress,networkID:this.networkId,data:{txID:"",psbtHex:o.toHex()},type:It.Swap,display:{summary:{topLeft:c.topLeft,topRight:c.topRight,bottomLeft:c.bottomLeft,bottomRight:c.bottomRight}}}}};var rc=class{static{i(this,"BtcBridgeSwapCommand")}executingQuote;takerAddress;networkId;quote;executionId;bitcoinSwapCommand;constructor(t,r,o,n,a){this.executingQuote=t,this.takerAddress=r,this.networkId=o,this.quote=n,this.executionId=a,this.bitcoinSwapCommand=new tc(t,r,o,n,a)}async createTransaction(){return Xa({quote:this.quote})}async swap(t,r,o,n,a){return this.bitcoinSwapCommand.swap(t,r,o,n,a)}async waitForConfirmation(t){return this.bitcoinSwapCommand.waitForConfirmation(t)}};u();l();u();l();u();l();u();l();u();l();function D_(e){if(e.length>=255)throw new TypeError("Alphabet too long");let t=new Uint8Array(256);for(let m=0;m<t.length;m++)t[m]=255;for(let m=0;m<e.length;m++){let f=e.charAt(m),h=f.charCodeAt(0);if(t[h]!==255)throw new TypeError(f+" is ambiguous");t[h]=m}let r=e.length,o=e.charAt(0),n=Math.log(r)/Math.log(256),a=Math.log(256)/Math.log(r);function c(m){if(m instanceof Uint8Array||(ArrayBuffer.isView(m)?m=new Uint8Array(m.buffer,m.byteOffset,m.byteLength):Array.isArray(m)&&(m=Uint8Array.from(m))),!(m instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(m.length===0)return"";let f=0,h=0,y=0,w=m.length;for(;y!==w&&m[y]===0;)y++,f++;let S=(w-y)*a+1>>>0,T=new Uint8Array(S);for(;y!==w;){let E=m[y],C=0;for(let I=S-1;(E!==0||C<h)&&I!==-1;I--,C++)E+=256*T[I]>>>0,T[I]=E%r>>>0,E=E/r>>>0;if(E!==0)throw new Error("Non-zero carry");h=C,y++}let b=S-h;for(;b!==S&&T[b]===0;)b++;let x=o.repeat(f);for(;b<S;++b)x+=e.charAt(T[b]);return x}i(c,"encode");function p(m){if(typeof m!="string")throw new TypeError("Expected String");if(m.length===0)return new Uint8Array;let f=0,h=0,y=0;for(;m[f]===o;)h++,f++;let w=(m.length-f)*n+1>>>0,S=new Uint8Array(w);for(;m[f];){let E=t[m.charCodeAt(f)];if(E===255)return;let C=0;for(let I=w-1;(E!==0||C<y)&&I!==-1;I--,C++)E+=r*S[I]>>>0,S[I]=E%256>>>0,E=E/256>>>0;if(E!==0)throw new Error("Non-zero carry");y=C,f++}let T=w-y;for(;T!==w&&S[T]===0;)T++;let b=new Uint8Array(h+(w-T)),x=h;for(;T!==w;)b[x++]=S[T++];return b}i(p,"decodeUnsafe");function d(m){let f=p(m);if(f)return f;throw new Error("Non-base"+r+" character")}return i(d,"decode"),{encode:c,decodeUnsafe:p,decode:d}}i(D_,"base");var Hy=D_;var N_="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",oc=Hy(N_);u();l();var B_=s.object({id:s.string(),state:s.nativeEnum(Me)}).passthrough(),xp=class extends Error{static{i(this,"CashActivityError")}activityId;userId;constructor(t,r,o){super(t),this.activityId=r,this.userId=o,this.name="CashActivityError"}},Zs=class extends Error{static{i(this,"CashActivityNotFoundError")}constructor(t,r){super(`Cash activity ${t} not found for user ${r}`),this.name="CashActivityNotFoundError"}},Wy=i(async({userID:e,activityId:t,accessToken:r})=>{let o=await K.api().bearer(r).get(`/cash/v1/users/${e}/cash-activity/${t}`);if(o.status===404)throw new Zs(t,e);let n=B_.safeParse(o.data);if(!n.success)throw new xp(`Failed to parse cash activity response: ${n.error.message}`,t,e);return n.data},"fetchCashActivity");u();l();var Ap;(function(e){e.Base58="base58",e.Base64="base64"})(Ap||(Ap={}));var L_=s.object({activityId:s.string(),transactionId:s.string()}),U_=3,M_=1e3,Zy=i(({accessToken:e,userID:t,idempotencyKey:r,signedTransaction:o,skipActivityRecording:n,skipNotification:a,swapInfo:c,perpsInfo:p,skipPreflight:d,awaitConfirmation:m})=>{if(!e)throw new Error("Access token is required");if(!t)throw new Error("User ID is required");return Ji(async()=>{let f=await K.api().bearer(e).post(`/cash/v1/users/${t}/cash-account/send`,{idempotencyKey:r,chainId:sn.Mainnet,signedTransaction:oc.encode(Xm(o)?o.serialize():o.serialize({requireAllSignatures:!1,verifySignatures:!1})),encoding:Ap.Base58,skipActivityRecording:n,skipNotification:a,...c&&{swapInfo:c},...p&&{perpsInfo:p},...d!==void 0&&{skipPreflight:d},...m!==void 0&&{awaitConfirmation:m}}),h=L_.safeParse(f.data);if(!h.success)throw new Error("Failed to parse transaction response");return h.data},()=>!0,U_,M_)},"broadcastTransaction");var O_=8,Q_=z({seconds:1.5}),q_=i(e=>{switch(e){case Me.Failed:case Me.Canceled:case Me.Completed:case Me.Processing:case Me.Refunded:return!0;case Me.Pending:case Me.Unknown:return!1}},"isTerminalState"),z_=i(e=>{switch(e){case Me.Completed:case Me.Processing:case Me.Refunded:return!0;case Me.Failed:case Me.Canceled:case Me.Pending:case Me.Unknown:return!1}},"isSuccessTerminalState");var Ep=i(async({unsignedTransaction:e,vaultProxy:t,accountIdentifier:r,signerAddress:o,idempotencyKey:n,isCash:a=!0,accessToken:c,userID:p,skipActivityRecording:d,skipNotification:m,swapInfo:f,perpsInfo:h,skipPreflight:y,awaitConfirmation:w})=>{let S;typeof e=="string"?S=kt(e,"bs58"):S=e;let T=await G_(t,o);R.addBreadcrumb(U.Cash,"Signing transaction ...",Y.Info),R.addBreadcrumb(U.Cash,`Using vault proxy signing (isCash: ${a}, isCashKMS: ${T})`,Y.Info);let b;a&&T?b={isCash:a,isCashKMS:T,data:{chainType:ye.Solana,signingType:"transaction",message:new Uint8Array(Hi(S))}}:a?b={isCash:a,data:{chainType:ye.Solana,signingType:"transaction",message:new Uint8Array(Hi(S))}}:b={chainType:ye.Solana,signingType:"transaction",message:new Uint8Array(Hi(S))};let x=await t.sign(r,b);if(x.status==="error")throw new Error(x.message);let{signature:E}=x;if(!E)throw new Error("Failed to sign transaction: No signature returned");S.addSignature(new Pe.PublicKey(o),oc.decode(E));let C=S;R.addBreadcrumb(U.Cash,"Signed transaction",Y.Info),R.addBreadcrumb(U.Cash,"Broadcasting transaction ...",Y.Info);let{activityId:I,transactionId:B}=await Zy({accessToken:c,userID:p,idempotencyKey:n,signedTransaction:C,skipActivityRecording:d,skipNotification:m,swapInfo:f,perpsInfo:h,skipPreflight:y,awaitConfirmation:w});R.addBreadcrumb(U.Cash,"Polling for cash activity...",Y.Info);try{await Ji(async()=>{let Q=await Wy({userID:p,activityId:I,accessToken:c});if(q_(Q.state)){if(z_(Q.state))return R.addBreadcrumb(U.Cash,`Activity reached success terminal state: ${Q.state}`,Y.Info),Q;{let N=`Activity reached failed terminal state: ${Q.state}.`;throw R.addBreadcrumb(U.Cash,N,Y.Info),new Error(N)}}else throw new Error(`Activity state is ${Q.state}, waiting for a terminal state.`)},Q=>Q instanceof Zs||!!(Q instanceof Error&&Q.message.includes("waiting for")),O_,Q_,!0)}catch(Q){throw R.addBreadcrumb(U.Cash,`Failed to poll for cash activity: ${Q}`,Y.Error),new Error(`Transaction broadcast succeeded but activity confirmation failed: ${Q}`)}return R.addBreadcrumb(U.Cash,"Broadcasted transaction",Y.Info),B},"signAndBroadcastTransaction");async function G_(e,t){try{let o=(await e.getCashKMSAccount()).account.address;return t===o}catch{return R.addBreadcrumb(U.Cash,"Unable to get Cash-KMS account.",Y.Error),!1}}i(G_,"isCashKMSEnabled");u();l();var K_=s.object({activityId:s.string()}),kp=i(async({accessToken:e,userID:t,idempotencyKey:r,swapInfo:o,chainId:n,signedTransaction:a,encoding:c,onchainTxId:p,failureReason:d,skipActivityRecording:m,skipNotification:f,occurredAt:h})=>{if(pn("kill-cash-swap-listener"))return;if(!e)throw new Error("Access token is required");if(!t)throw new Error("User ID is required");let w=await K.api().bearer(e).post(`/cash/v1/users/${t}/cash-account/transaction/failed`,{idempotencyKey:r,swapInfo:o,...n&&{chainId:n},...a&&{signedTransaction:a},...c&&{encoding:c},...p&&{onchainTxId:p},...d&&{failureReason:d},...m!==void 0&&{skipActivityRecording:m},...f!==void 0&&{skipNotification:f},...h&&{occurredAt:h}}),S=K_.safeParse(w.data);if(!S.success)throw new Error("Failed to parse record failed swap response");return S.data},"recordFailedCashSwap");u();l();var Lo=i((e,t)=>!e||!t?{}:{sellAmount:t.sellAmount,buyAmount:t.buyAmount,sellToken:e.sell.data.symbol||"unknown",buyToken:e.buy.data.symbol||"unknown"},"swapTelemetryMetadata"),nc=class{static{i(this,"CashSwapCommand")}executingQuote;takerAddress;networkId;quote;executionId;connection;authRepository;cashAccount;constructor(t,r,o,n,a,c,p,d){this.executingQuote=t,this.takerAddress=r,this.networkId=o,this.quote=n,this.executionId=a,this.connection=c,this.authRepository=p,this.cashAccount=d}async createTransaction(){R.addBreadcrumb(U.Cash,"Creating cash swap transaction",Y.Info,Lo(this.executingQuote,this.quote));try{return await qy({quote:this.quote,connection:this.connection})}catch(t){throw R.addBreadcrumb(U.Cash,"Failed to create cash swap transaction",Y.Error,Lo(this.executingQuote,this.quote)),t}}async swap(t,r,o,n,a){R.addBreadcrumb(U.Cash,"Starting cash swap",Y.Info,Lo(this.executingQuote,this.quote));let c=r.transactions[0],p=kt(c,"bs58"),d=ef(p),m=p.message.header.numRequiredSignatures,f=d.slice(0,m),h=this.cashAccount?.addressDetails.address;if(!h)throw new Error("Cash account address not found");let y=f[0]?.toBase58(),w=y===this.takerAddress?"taker address":y===h?"cash account address":null;w&&R.addBreadcrumb(U.Cash,`Fee payer is ${w}`,Y.Info,Lo(this.executingQuote,this.quote));let S=f.some(I=>I.toBase58()===h),T=S?h:this.takerAddress,b=await this.authRepository?.getUser();if(!b)throw new Error("User not found for swap");let{accessToken:x,userID:E}=b,C=this.getSwapInfo(this.executingQuote,this.quote);try{return{id:await Ep({unsignedTransaction:c,vaultProxy:n,accountIdentifier:t,signerAddress:T,idempotencyKey:this.executionId,isCash:S,accessToken:x,userID:E,skipActivityRecording:!1,skipNotification:!0,swapInfo:C,waitForActivityState:Me.Completed}),networkID:this.networkId}}catch(I){throw R.addBreadcrumb(U.Cash,"Swap failed",Y.Error,Lo(this.executingQuote,this.quote)),I}}async waitForConfirmation(t){R.addBreadcrumb(U.Cash,"Waiting for cash swap confirmation",Y.Info,Lo(this.executingQuote,this.quote));try{let r=aa(t.networkID);await wn({connection:r,signature:t.id}),R.addBreadcrumb(U.Cash,"Cash swap confirmed",Y.Info)}catch(r){throw R.addBreadcrumb(U.Cash,"Cash swap confirmation failed",Y.Error,Lo(this.executingQuote,this.quote)),r}}parsePendingActivity(t,r){let o=De(Oe(t.quote));return pr({swapTransactions:r,sellFungible:t.sell,buyFungible:t.buy,fungibles:[],currentQuote:t.quote,provider:o,t:v.t})}getSwapInfo(t,r){let o=t.sell,n=t.buy,a=t.quoteInput,c=o.data.walletAddress,p=n.data.walletAddress;if(!c&&a?.taker){let d=et(a?.taker);d.resourceType===J.address&&(c=d.address)}if(!p&&a?.takerDestination){let d=et(a?.takerDestination);d.resourceType===J.address&&(p=d.address)}return{type:Bo.Swap,input:{owner:c,mint:o.data.tokenAddress??"",amount:r.sellAmount,symbol:o.data.symbol??void 0,name:o.data.name??void 0,decimals:o.data.decimals,logoUri:o.data.logoUri??void 0},output:{owner:p,mint:n.data.tokenAddress??"",amount:r.buyAmount,symbol:n.data.symbol??void 0,name:n.data.name??void 0,decimals:n.data.decimals,logoUri:n.data.logoUri??void 0},quoteId:r.rfqProps?.quoteId,quoteSource:Oe(r).map(d=>d.name).join(",")}}};u();l();var sc=class{static{i(this,"EvmBridgeSwapCommand")}executingQuote;takerAddress;networkId;quote;executionId;evmSwapCommand;constructor(t,r,o,n,a,c){this.executingQuote=t,this.takerAddress=r,this.networkId=o,this.quote=n,this.executionId=a,this.evmSwapCommand=c}createTransaction(){return Ks({networkId:this.networkId,callerAddress:this.takerAddress,quote:this.quote})}async swap(t,r,o,n,a){return this.evmSwapCommand.swap(t,r,o,n,a)}async waitForConfirmation(t){return this.evmSwapCommand.waitForConfirmation(t)}};u();l();u();l();var j_=1.3,V_=i(e=>{switch(e){case me.Ethereum.Mainnet:case me.Ethereum.Sepolia:return 8e5;case me.Polygon.Mainnet:case me.Polygon.Amoy:return 5e5;case me.Base.Mainnet:case me.Base.Sepolia:return 5e5;case me.Arbitrum.Mainnet:case me.Arbitrum.Sepolia:return 5e5;case me.Hyperevm.Mainnet:case me.Hyperevm.Testnet:return 5e5;case me.Monad.Mainnet:case me.Monad.Testnet:return 5e5;default:return 0}},"getDefaultBridgeGasLimit"),$_=i(e=>{switch(e){case me.Ethereum.Mainnet:case me.Ethereum.Sepolia:return 6e4;case me.Polygon.Mainnet:case me.Polygon.Amoy:return 6e4;case me.Base.Mainnet:case me.Base.Sepolia:return 6e4;case me.Arbitrum.Mainnet:case me.Arbitrum.Sepolia:return 6e4;case me.Hyperevm.Mainnet:case me.Hyperevm.Testnet:return 6e4;case me.Monad.Mainnet:case me.Monad.Testnet:return 6e4;default:return 0}},"getDefaultApprovalGasLimit"),H_=i((e,t)=>e.steps.flatMap(r=>r.gasCosts??[V_(t)]),"getBridgeGasLimit"),W_=i((e,t,r)=>{let o=lr(t)?[t.gas]:H_(t,r);return e?e.transactionTypes.map(n=>n.includes("approval")?$_(r):o.shift()??0):o},"getQuoteGasLimit"),Pn={estimateGas:i(({swapTransactions:e,evmGasEstimation:t,currentQuote:r,scanResult:o,networkID:n,includeGasBuffer:a,gasBuffer:c})=>{let{maxFeePerGas:p,maxPriorityFeePerGas:d}=t,m=W_(e,r,n),f=o?.advancedDetails?.gas;return o?.advancedDetails?.gasLimit>0&&(m=f),m.map(y=>({maxFeePerGas:p,maxPriorityFeePerGas:d,networkID:n,gasLimit:new _(y).multipliedBy(a?c??j_:1).integerValue(_.ROUND_CEIL)}))},"estimateGas")};u();l();var Z_=i(({networkID:e,unsignedTransaction:t,pendingActivityRows:r,accountIdentifier:o,accountSigner:n,storage:a,includeCallPayload:c})=>({accountSigner:n,accountIdentifier:o,networkID:e,unsignedTransaction:t,...c&&{callPayload:{from:t.from,to:t.to,data:t.data,value:t.value}},pendingTransactionInput:{ownerAddress:t.from,networkID:e,data:{nonce:"",unsignedTransaction:t,hash:""},type:It.Swap,display:{summary:r}},storage:a}),"buildArgs"),ic=i(async({transactions:e,transactionTypes:t,networkID:r,gasEstimation:o,pendingApprovalActivityRows:n,pendingSwapActivityRows:a,accountIdentifier:c,accountSigner:p,storage:d})=>{let m=!0,f="";for(let[h,y]of e.entries()){let w=o[h],S={gas:`0x${w.gasLimit.toString(16)}`,maxFeePerGas:`0x${w.maxFeePerGas.toString(16)}`,maxPriorityFeePerGas:`0x${w.maxPriorityFeePerGas.toString(16)}`},T=nn.parse({...y,...S}),x=t[h].includes("approval")?n:a,E=Z_({networkID:r,accountIdentifier:c,pendingActivityRows:x.shift(),accountSigner:p,storage:d,unsignedTransaction:T,includeCallPayload:m});try{f="",f=await cg(E)}catch(C){return{signature:f,error:C instanceof Error?C:new Error("Failed to process EVM swap transaction")}}m&&(m=!1)}return{signature:f}},"swapTransactionEvm");var Yy=Tr.standard,ac=class{static{i(this,"EvmSwapCommand")}executingQuote;takerAddress;networkId;quote;executionId;gasEstimation;constructor(t,r,o,n,a,c){this.executingQuote=t,this.takerAddress=r,this.networkId=o,this.quote=n,this.executionId=a,this.gasEstimation=c}createTransaction(){return Vs({quote:this.quote,callerAddress:this.takerAddress,networkId:this.networkId,sellFungible:this.executingQuote.sell})}async swap(t,r,o,n,a){let c=this.gasEstimation??await this.estimateGas(this.quote,this.executingQuote.response,Yy,r,o);if(!c)throw new Error(`No gas estimation found for ${Yy}`);let p=this.parsePendingActivity(this.executingQuote,r),{signature:d,error:m}=await R.startSpan("Process EVM Swap Txns",()=>ic({transactions:r.transactions,transactionTypes:r.transactionTypes,networkID:this.networkId,gasEstimation:c,pendingSwapActivityRows:p.pendingSwapActivityRows,pendingApprovalActivityRows:p.pendingApprovalActivityRows,accountIdentifier:t,accountSigner:n,storage:a}));if(m)throw m;return{networkID:this.networkId,id:d}}async waitForConfirmation(t){await $f(t.networkID,t.id)}async estimateGas(t,r,o,n,a){let c=await hn(this.networkId,!0);if(!c)return;let p=c[o];if(!p)return;let d={networkID:this.networkId,gasLimit:new L(1),maxFeePerGas:p.maxFeePerGas,maxPriorityFeePerGas:p.maxPriorityFeePerGas};return Pn.estimateGas({swapTransactions:n,evmGasEstimation:d,currentQuote:t,scanResult:a??void 0,includeGasBuffer:!0,networkID:this.networkId,gasBuffer:r.gasBuffer})}parsePendingActivity(t,r){let o=De(Oe(t.quote));return pr({swapTransactions:r,sellFungible:t.sell,buyFungible:t.buy,fungibles:[],currentQuote:t.quote,provider:o,t:v.t})}};u();l();var Xy=P(Wm());u();l();u();l();var Y_=i(({networkID:e,transaction:t,feePayer:r,connection:o,pendingActivityRows:n,accountIdentifier:a,accountSigner:c,storage:p})=>({accountSigner:c,accountIdentifier:a,transaction:t,feePayer:r,connection:o,opts:{skipPreflight:!0},pendingTransactionInput:{ownerAddress:r.toBase58(),networkID:e,data:{signature:""},type:It.Swap,display:{summary:n}},storage:p}),"buildArgs"),cc=i(async({callerAddress:e,connection:t,networkID:r,transactions:o,pendingSwapActivityRows:n,accountIdentifier:a,accountSigner:c,storage:p})=>{let d=new Pe.PublicKey(e),m="";for(let[f,h]of o.entries()){let y=kt(h,"bs58"),w=Y_({networkID:r,transaction:y,feePayer:d,connection:t,pendingActivityRows:n[f],accountIdentifier:a,accountSigner:c,storage:p});try{m="",m=await dg(w),f!==o.length-1&&await wn({connection:t,signature:m})}catch(S){return{signature:m??"",error:S instanceof Error?S:new Error("Failed to process solana swap transaction")}}}return{signature:m??""}},"swapTransactionSolana");var Er=class{static{i(this,"SolanaSwapCommand")}executingQuote;takerAddress;networkId;quote;executionId;connection;constructor(t,r,o,n,a,c){this.executingQuote=t,this.takerAddress=r,this.networkId=o,this.quote=n,this.executionId=a,this.connection=c}async createTransaction(){return Fn({quote:this.quote,connection:this.connection})}async swap(t,r,o,n,a){let c=this.parsePendingActivity(this.executingQuote,r),{signature:p,error:d}=await cc({callerAddress:this.takerAddress,connection:this.connection,networkID:this.networkId,transactions:r.transactions,pendingSwapActivityRows:c.pendingSwapActivityRows,accountIdentifier:t,accountSigner:n,storage:a});if(d)throw d;return{networkID:this.networkId,id:p}}async waitForConfirmation(t){let r=aa(t.networkID);await wn({connection:r,signature:t.id})}parsePendingActivity(t,r){let o=De(Oe(t.quote));return pr({swapTransactions:r,sellFungible:t.sell,buyFungible:t.buy,fungibles:[],currentQuote:t.quote,provider:o,t:v.t})}};var X_=s.object({signature:s.string()}),uc=class extends Er{static{i(this,"GaslessSolanaSwapCommand")}executingQuote;takerAddress;networkId;quote;executionId;connection;gaslessSignature;constructor(t,r,o,n,a,c,p){super(t,r,o,n,a,c),this.executingQuote=t,this.takerAddress=r,this.networkId=o,this.quote=n,this.executionId=a,this.connection=c,this.gaslessSignature=p}async swap(t,r,o,n,a){let c=this.quote.transactionData[0];if(!c)throw new Error("No transaction data found in quote");let p=new Pe.PublicKey(this.takerAddress),m=this.parsePendingActivity(this.executingQuote,r).pendingSwapActivityRows[0];if(!m)throw new Error("Unable to create pending activity for gasless");let f=await pa({accountIdentifier:t,feePayer:p,connection:this.connection,accountSigner:n,transaction:kt(c,"bs58"),pendingTransactionInput:{ownerAddress:p.toBase58(),networkID:this.networkId,data:{signature:this.gaslessSignature},type:It.Swap,display:{summary:m}},storage:a,opts:{}});return{id:(await this.submitGaslessSwap(this.gaslessSignature,f)).signature,networkID:this.networkId}}async submitGaslessSwap(t,r){let o=await K.api().post("/gasless-swap/v1/submit",{quoteSignature:t,encoding:"bs58",chainId:this.networkId,transaction:Xy.default.encode(r.serialize())}),n=X_.safeParse(o.data);if(!n.success)throw new Error("Failed to submit gasless swap");return n.data}};u();l();var J_=s.object({quoteId:s.string(),transactionId:s.string()}),lc=class extends Er{static{i(this,"RFQSolanaSwapCommand")}executingQuote;takerAddress;networkId;quote;executionId;connection;constructor(t,r,o,n,a,c){super(t,r,o,n,a,c),this.executingQuote=t,this.takerAddress=r,this.networkId=o,this.quote=n,this.executionId=a,this.connection=c}async swap(t,r,o,n,a){let c=this.quote.transactionData[0];if(!c)throw new Error("No transaction data found in quote");let p=new Pe.PublicKey(this.takerAddress),m=this.parsePendingActivity(this.executingQuote,r).pendingSwapActivityRows[0];if(!m)throw new Error("Unable to create pending activity for rfq");let f=await pa({accountIdentifier:t,feePayer:p,connection:this.connection,accountSigner:n,transaction:kt(c,"bs58"),pendingTransactionInput:{ownerAddress:p.toBase58(),networkID:this.networkId,data:{signature:""},type:It.Swap,display:{summary:m}},storage:a,opts:{}});return{id:(await this.submitRFQSwap(f)).transactionId,networkID:this.networkId}}async submitRFQSwap(t){let r=Buffer.from(t.serialize()).toString("base64"),o=await K.api().post("/v0/rfq/swap",{chainId:this.networkId,quoteId:this.quote.rfqProps?.quoteId,signedPayload:r},{headers:{"X-Request-Id":this.executionId}}),n=J_.safeParse(o.data);if(!n.success)throw new Error("Failed to submit rfq swap");return n.data}};u();l();var pc=class{static{i(this,"SolanaBridgeSwapCommand")}executingQuote;takerAddress;networkId;quote;executionId;connection;solanaSwapCommand;constructor(t,r,o,n,a,c){this.executingQuote=t,this.takerAddress=r,this.networkId=o,this.quote=n,this.executionId=a,this.connection=c,this.solanaSwapCommand=new Er(t,r,o,t.quote,a,c)}createTransaction(){return js({quote:this.quote,connection:this.connection})}async swap(t,r,o,n,a){return this.solanaSwapCommand.swap(t,r,o,n,a)}async waitForConfirmation(t){return this.solanaSwapCommand.waitForConfirmation(t)}};u();l();u();l();u();l();var e0=i(({networkID:e,transaction:t,feePayer:r,pendingActivityRows:o,accountIdentifier:n,accountSigner:a,storage:c})=>({accountSigner:a,accountIdentifier:n,transaction:t,pendingTransactionInput:{ownerAddress:r,networkID:e,data:{digest:""},type:It.Swap,display:{summary:o}},storage:c}),"buildArgs"),dc=i(async({callerAddress:e,networkID:t,transactions:r,pendingSwapActivityRows:o,accountIdentifier:n,accountSigner:a,storage:c})=>{let p="";for(let[d,m]of r.entries()){let f=e0({networkID:t,transaction:ua.deserializeTransactionString(m),feePayer:e,pendingActivityRows:o[d],accountIdentifier:n,accountSigner:a,storage:c});try{p=(await lg(f)).digest,d!==r.length-1&&await la(t,p)}catch(h){return{signature:p??"",error:h instanceof Error?h:new Error("Failed to process sui swap transaction")}}}return{signature:p??""}},"swapTransactionSui");var Rn=class{static{i(this,"SuiSwapCommand")}executingQuote;takerAddress;networkId;quote;executionId;constructor(t,r,o,n,a){this.executingQuote=t,this.takerAddress=r,this.networkId=o,this.quote=n,this.executionId=a}async createTransaction(){return Hs({quote:this.quote})}async swap(t,r,o,n,a){let c=this.parsePendingActivity(this.executingQuote,r),{signature:p,error:d}=await dc({callerAddress:this.takerAddress,networkID:this.networkId,transactions:r.transactions,pendingSwapActivityRows:c.pendingSwapActivityRows,accountIdentifier:t,accountSigner:n,storage:a});if(d)throw d;return{networkID:this.networkId,id:p}}async waitForConfirmation(t){await la(this.networkId,t.id)}parsePendingActivity(t,r){let o=De(Oe(t.quote));return pr({swapTransactions:r,sellFungible:t.sell,buyFungible:t.buy,fungibles:[],currentQuote:t.quote,provider:o,t:v.t})}};var mc=class{static{i(this,"SuiBridgeSwapCommand")}executingQuote;takerAddress;networkId;quote;executionId;suiSwapCommand;constructor(t,r,o,n,a){this.executingQuote=t,this.takerAddress=r,this.networkId=o,this.quote=n,this.executionId=a,this.suiSwapCommand=new Rn(t,r,o,t.quote,a)}async createTransaction(){return $s({quote:this.quote})}async swap(t,r,o,n,a){return this.suiSwapCommand.swap(t,r,o,n,a)}async waitForConfirmation(t){return this.suiSwapCommand.waitForConfirmation(t)}};var fc=class{static{i(this,"WalletSwapCommandFactory")}bridgeStatusManager;constructor(t){this.bridgeStatusManager=t}create(t,r,o,n,a,c,p){if(yy(t.quote)&&(Ve(t.buy)||Ve(t.sell)))return new nc(t,r,o,t.quote,Ze(),n,a,c);if(A.isSolanaNetworkID(o)&&Pt(t.quote)){let d=new Er(t,r,o,t.quote,Ze(),n);return t.quote.rfqProps?new lc(t,r,o,t.quote,Ze(),n):t.quote.gaslessSignature?new uc(t,r,o,t.quote,Ze(),n,t.quote.gaslessSignature):d}else{if(A.isEVMNetworkID(o)&&lr(t.quote))return this.createEvmSwapCommand(t,r,o,p);if(A.isSuiNetworkID(o)&&qr(t.quote))return new Rn(t,r,o,t.quote,Ze());if(se(t.quote)){if(A.isSolanaNetworkID(o))return this.wrapBridgeTrackingCommand(new pc(t,r,o,t.quote,Ze(),n),t);if(A.isEVMNetworkID(o)){let d=this.createEvmSwapCommand(t,r,o,p);return this.wrapBridgeTrackingCommand(new sc(t,r,o,t.quote,Ze(),d),t)}else{if(A.isSuiNetworkID(o))return this.wrapBridgeTrackingCommand(new mc(t,r,o,t.quote,Ze()),t);if(A.isBitcoinNetworkID(o))return this.wrapBridgeTrackingCommand(new rc(t,r,o,t.quote,Ze()),t)}}}throw new Error("Unsupported SwapQuote}")}createEvmSwapCommand(t,r,o,n){let a=n?n.filter(ia):void 0;return a&&a.length===0&&(a=void 0),new ac(t,r,o,t.quote,Ze(),a)}wrapBridgeTrackingCommand(t,r){return!this.bridgeStatusManager||!se(r.quote)?t:new Wa(t,this.bridgeStatusManager,r)}};u();l();u();l();var Ys={name:"SwapperNoQuotes",message:"No quotes found"},Dn=class extends kg{static{i(this,"SwapperQuoteStreamEventProducer")}createStreamUrl({amount:t,amountUsd:r,buy:o,sell:n,taker:a,takerDestination:c,slippageTolerance:p,exactOut:d,autoSlippage:m,priorityFee:f,tipAmount:h,isLedger:y,phantomCashAccount:w,isPrediction:S,predictions:T}){let b=new URLSearchParams({taker:a,takerDestination:c,buyToken:M(te(o)),sellToken:M(te(n)),sellAmount:t,sellAmountUsd:r??"",exactOut:d?"true":"false",autoSlippage:m?"true":"false",clientEnableGaslessSwap:"true",phantomCashAccount:w?"true":"false"});return p&&b.set("slippageTolerance",String(p)),f&&b.set("priorityFee",String(f)),h&&b.set("tipAmount",String(h)),y!==void 0&&b.set("isLedger",String(y)),S&&b.set("isPrediction","true"),T&&(b.set("predictionsPlatform",T.platform),b.set("predictionsMintAddress",T.mintAddress),b.set("predictionsTokenPerspective",T.tokenPerspective)),`${this.getApiEnvironment()}/swap/v2/stream/quotes?${b.toString()}`}handleNewQuoteResponse(t,r){let o=this.safeJsonParse(t);if(!o.success||!o.data){r({type:"error",errorResponse:Ys});return}try{let n=this.parseSwapQuotesResponse(o.data);r({type:"newQuoteResponse",quoteResponse:n})}catch{r({type:"error",errorResponse:Ys})}}handleErrorQuoteResponse(t,r){let o=this.safeJsonParse(t);if(!o.success||!o.data){r({type:"error",errorResponse:Ys});return}try{let n=Ca.safeParse(o.data);r({type:"error",errorResponse:n.success?n.data:Ys})}catch{r({type:"error",errorResponse:Ys})}}parseSwapQuotesResponse(t){let r=new je({key:"SwapperNoQuotes"});if(Os.safeParse(t?.type).success===!1)throw R.captureError(new Error("Failed to parse a valid quote type."),U.Swapper),new Error("Invalid input");let o=Fa.safeParse(t);if(!o.success)throw R.captureError(new Error("Failed to parse a valid swap quotes response."),U.Swapper),r;if(o.data.includesAllProviders&&o.data.quotes.length===0)throw r;return o.data}};var gc=class extends Dn{static{i(this,"EventStreamQuoteStreamProducer")}eventSource;open(t,r){this.close();let o=this.createStreamUrl(t);this.eventSource=new ha(o,this.getOptionsWithAuth(o));let n=i(a=>{switch(a.type){case"new-quote-response":this.handleNewQuoteResponse(a.data,r);break;case"error-quote-response":this.handleErrorQuoteResponse(a.data,r);break;case"open":r({type:"open"});break;case"error":r({type:"error",errorResponse:{name:"UnknownError",message:a.message}});break;case"close":r({type:"close"});break}},"eventSourceListener");this.eventSource.addEventListener("new-quote-response",n),this.eventSource.addEventListener("error-quote-response",n),this.eventSource.addEventListener("open",n),this.eventSource.addEventListener("error",n),this.eventSource.addEventListener("close",n)}close(){this.eventSource&&(this.eventSource.removeAllEventListeners(),this.eventSource.close())}};u();l();var hc=class extends Dn{static{i(this,"NativeEventStreamQuoteStreamProducer")}eventSource;open(t,r){this.close();let o=this.createStreamUrl(t);this.eventSource=new ha(o,this.getOptionsWithAuth(o));let n=i(a=>{switch(a.type){case"new-quote-response":this.handleNewQuoteResponse(a.data,r);break;case"error-quote-response":this.handleErrorQuoteResponse(a.data,r);break;case"open":r({type:"open"});break;case"error":r({type:"error",errorResponse:{name:"UnknownError",message:a.message}});break;case"close":r({type:"close"});break}},"eventSourceListener");this.eventSource.addEventListener("new-quote-response",n),this.eventSource.addEventListener("error-quote-response",n),this.eventSource.addEventListener("open",n),this.eventSource.addEventListener("error",n),this.eventSource.addEventListener("close",n)}close(){this.eventSource&&(this.eventSource.removeAllEventListeners(),this.eventSource.close())}};u();l();var yc=class{static{i(this,"QuoteStreamer")}producer;listeners=new Set;constructor(t){this.producer=t}openStream(t){this.listeners.forEach(r=>r.onEvent({type:"openRequested"})),this.producer.close(),this.producer.open(t,r=>{this.listeners.forEach(o=>o.onEvent(r)),r.type==="error"&&this.closeStream()})}closeStream(){this.producer.close()}subscribe(t){this.listeners.add(t)}unsubscribe(t){this.listeners.delete(t)}};u();l();u();l();function Jy(e){return e<3e5?1e4:e<6e5?15e3:3e4}i(Jy,"getBridgeStatusPollInterval");function t0(e){let t="pending";switch(e.status){case"DONE":t="completed";break;case"FAILED":t="failed";break;case"PENDING":case"NOT_FOUND":default:t="pending";break}return{state:t,rawStatus:e.status,updatedAt:Date.now(),fromAddress:e.fromAddress,toAddress:e.toAddress}}i(t0,"normalizeSwapperStatus");var Cp=class{static{i(this,"BridgeStatusPoller")}args;timeoutId=null;isActive=!1;client;constructor(t){this.args=t,this.client=t.client}start(){this.isActive||(this.isActive=!0,this.scheduleNext(0))}stop(){this.isActive=!1,this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}scheduleNext(t){this.isActive&&(this.timeoutId=setTimeout(()=>{this.poll()},t))}async poll(){if(this.isActive)try{let t=await this.client.fetchStatus(this.args.record.transactionHash),r=t0(t),o;switch(r.state){case"completed":o={type:"completed",status:r},this.stop();break;case"failed":o={type:"failed",status:r},this.stop();break;case"pending":default:{o={type:"pending",status:r};let n=Date.now()-this.args.record.startedAt;this.scheduleNext(Jy(n));break}}this.args.onEvent(o)}catch(t){this.args.onEvent({type:"error",error:t});let r=Date.now()-this.args.record.startedAt;this.scheduleNext(Jy(r))}}};function ew(e){return new Cp(e)}i(ew,"createBridgeStatusPoller");u();l();var r0=s.object({status:s.string(),sending:s.object({txHash:s.string().optional()}).optional(),receiving:s.object({txHash:s.string().optional()}).optional(),fromAddress:s.string().optional(),toAddress:s.string().optional()}).passthrough(),wc=class{static{i(this,"SwapperStatusClient")}async fetchStatus(t){let r=await K.api().get("/swap/v2/status/lifi",{params:{txHash:t}}),o=r?.data??r,n=r0.safeParse(o);if(!n.success)throw new Error("Unable to parse bridge status response");return n.data}};u();l();var _p="sdk.bridgeStatus.pending";var Ip=class{static{i(this,"BridgeStatusManager")}storage;client;createPoller;records=new Map;pollers=new Map;listeners=new Set;hydratePromise;constructor(t,r={}){this.storage=t,this.client=r.client??new wc,this.createPoller=r.createPoller??ew}async initialize(){this.hydratePromise||(this.hydratePromise=this.hydrate()),await this.hydratePromise}destroy(){this.pollers.forEach(t=>t.stop()),this.pollers.clear(),this.records.clear()}addListener(t){this.listeners.add(t)}removeListener(t){this.listeners.delete(t)}getPendingRecords(){return Array.from(this.records.values())}getPendingActivityRows(t,r){return this.getPendingBridgeActivities(t,r).map(o=>o.row)}getPendingBridgeActivities(t,r){return this.filterRecordsByAddresses(r?.addresses).map(n=>({record:n,row:nw(n,t)}))}getPendingBridgeTransactions(t,r){return this.filterRecordsByAddresses(r?.addresses).map(n=>tw(n,t))}getPendingBridgeTransactionById(t,r){let o=this.records.get(t);if(o)return tw(o,r)}isPendingBridgeTransaction(t){return this.records.has(t)}async track(t){if(await this.initialize(),!this.shouldTrackQuote(t.executingQuote))return;let r=o0(t.executingQuote),o=this.records.get(t.executionId),n={executionId:t.executionId,transactionHash:t.transactionHash,startedAt:o?.startedAt??Date.now(),quote:r,status:o?.status};this.records.set(t.executionId,n),this.restartPoller(n),await this.persistRecords()}async hydrate(){try{let t=await this.storage.get(_p)??"[]",r=JSON.parse(t);for(let o of r){let n=this.normalizePersistedRecord(o);n&&(this.records.set(n.executionId,n),this.startPoller(n))}}catch(t){console.error("Failed to hydrate bridge status records",t)}}shouldTrackQuote(t){if(!se(t.quote))return!1;let r=t.sell?.data?.chain?.id,o=t.buy?.data?.chain?.id;return o&&A.isBitcoinNetworkID(o)||r&&A.isBitcoinNetworkID(r)||!1}startPoller(t){let r=this.createPoller({record:t,client:this.client,onEvent:i(o=>this.handlePollerEvent(t.executionId,o),"onEvent")});this.pollers.set(t.executionId,r),r.start()}restartPoller(t){this.stopPoller(t.executionId),this.startPoller(t)}stopPoller(t){let r=this.pollers.get(t);r&&(r.stop(),this.pollers.delete(t))}async persistRecords(){try{let t=Array.from(this.records.values()).map(r=>({executionId:r.executionId,transactionHash:r.transactionHash,startedAt:r.startedAt,quote:r.quote,status:r.status}));await this.storage.set(_p,JSON.stringify(t))}catch(t){console.error("Failed to persist bridge status records",t)}}removeRecord(t){this.records.delete(t),this.stopPoller(t),this.persistRecords()}normalizePersistedRecord(t){return"quote"in t&&n0(t.quote)?t:null}handlePollerEvent(t,r){let o=this.records.get(t);if(o)switch(r.type){case"pending":o.status=r.status,this.notifyListeners({type:"pending",record:o,status:r.status}),this.persistRecords();break;case"completed":o.status=r.status,this.notifyListeners({type:"completed",record:o,status:r.status}),this.removeRecord(t);break;case"failed":o.status=r.status,this.notifyListeners({type:"failed",record:o,status:r.status}),this.removeRecord(t);break;case"error":this.notifyListeners({type:"error",record:o,error:r.error});break}}notifyListeners(t){this.listeners.forEach(r=>{try{r.onBridgeStatusChange(t)}catch(o){console.error("BridgeStatusListener error",o)}})}filterRecordsByAddresses(t){if(!t?.length)return this.getPendingRecords();let r=s0(t);return this.getPendingRecords().filter(o=>o.quote.accountAddresses.some(n=>r.has(ow(n))))}};function o0(e){if(!se(e.quote))throw new Error("Non-bridge quotes cannot be tracked");return{sell:e.sell,buy:e.buy,quote:e.quote,amount:e.amount,accountAddresses:e.account.addresses}}i(o0,"createQuoteSnapshot");function n0(e){return!!(e&&se(e.quote))}i(n0,"isValidSnapshot");function s0(e){return new Set(e.map(ow))}i(s0,"createAddressLookup");function ow(e){return`${e.networkID}:${i0(e.address,e.networkID)}`}i(ow,"createAddressKey");function i0(e,t){return A.isEVMNetworkID(t)?e.toLowerCase():e}i(i0,"normalizeAddress");function nw(e,t){let r=e.quote.quote,o=e.quote.sell,n=e.quote.buy,a=ke(r.sellAmount,o?.data.decimals??0),c=ke(r.buyAmount,n?.data.decimals??0),p=o?.data.symbol??"",d=n?.data.symbol??"",m=e.startedAt+z({minutes:20}),f=Date.now(),h=m-f,y=Math.max(0,Math.ceil(h/(60*1e3))),w=y>0?`Est. ${y}m`:"Est. <1m";return{topLeft:{text:t("transactionsPendingSwapping")},topRight:{text:`${c} ${d}`,color:"spotPositive"},bottomLeft:{text:w},bottomRight:{text:`${a} ${p}`}}}i(nw,"createPendingBridgeActivityRow");function a0(e,t){if(A.isEVMNetworkID(e))return{nonce:0,transactions:[{hash:t.transactionHash,timestamp:t.startedAt,unsignedTransaction:{},confirmations:0}]};if(A.isBitcoinNetworkID(e))return{txID:t.transactionHash,psbtHex:"",confirmations:0};if(A.isSolanaNetworkID(e))return{signature:t.transactionHash};if(A.isSuiNetworkID(e))return{digest:t.transactionHash};throw new Error(`Unsupported network for bridge transaction: ${e}`)}i(a0,"createBridgePendingTransactionData");function tw(e,t){let r=e.quote.sell,o=e.quote.buy,n=r?.data.chain?.id;if(!n)throw new Error("Cannot create pending transaction: missing network ID");let a=nw(e,t),c=e.quote.accountAddresses.find(w=>w.networkID===n)?.address??"",p=o?.data.chain?.id,d=p?e.quote.accountAddresses.find(w=>w.networkID===p)?.address:void 0,m=d?mn(d,4):"",f=ke(e.quote.quote.buyAmount,o?.data.decimals??0),h=o?.data.symbol??"",y=`${f} ${h}`;return{id:e.executionId,timestamp:e.startedAt,ownerAddress:c,networkID:n,type:It.Swap,display:{summary:{topLeft:a.topLeft,topRight:a.topRight,bottomLeft:a.bottomLeft,bottomRight:a.bottomRight},detail:{header:y,assetSymbol:h,uiRecipient:m}},data:a0(n,e)}}i(tw,"createPendingTransactionFromBridgeRecord");var Sc=null,rw=null;function sw(e){return Sc||(Sc=new Ip(e)),rw||(rw=Sc.initialize()),Sc}i(sw,"getBridgeStatusManager");u();l();u();l();var $t=i((e,t)=>!!e&&!!t&&A.compareNetworkID(e,t)!==0,"isBridgeSwap");u();l();var Tc=P(cf()),iw=P(kk()),xc=P(Ek());u();l();u();l();function qt(e,t,r){if(t.lte(0))return null;let o=M({chainId:e,resourceType:J.nativeToken,slip44:A.getSlip44(e)}),n=A.getTokenDecimals(e),a=A.getTokenSymbol(e);if(!o||!n||!a)return null;let c=t.div(yn(n)),p=r[o];return p?.usd?c.times(p.usd).toNumber():null}i(qt,"getFeeInUsd");var c0={"Allbridge's fee":"destinationNetwork","Allbridge Liquidity Fee":"liquidityProvider"};function u0(e,t){return{type:e,amountUsd:new _(t.amountUSD??0),amount:new _(t.amount??0)}}i(u0,"bridgeFeeToFee");function po(e){return e.steps.flatMap(t=>t.includedFeeCosts).reduce((t,r)=>{if(!r)return t;let o=c0[r.name];return o&&new _(r.amount).gt(0)&&t.push(u0(o,r)),t},[])}i(po,"getIncludedBridgeFees");function mo(e,t,r){let o=e.steps.reduce((n,a)=>n.plus(a.nonIncludedNonGasFees),new _(0));return o.isZero()?[]:[{type:"nonIncludedNonGas",amountUsd:new _(qt(t,o,r)??0),amount:o}]}i(mo,"getNonIncludedBridgeFees");var bc=class{static{i(this,"BtcProcessBridgeQuoteCommand")}networkID;priceClient;constructor(t,r){this.networkID=t,this.priceClient=r}getNativeTokenCaip19(){return M({chainId:this.networkID,resourceType:J.nativeToken,slip44:A.getSlip44(this.networkID)})}async processQuote(t,r){let o=await this.createSwapTransactions(t),n=await this.priceClient.getPrice(this.getNativeTokenCaip19());if(!n.usd)throw new Error("Price data not found");let a=await this.calculateNetworkFee(t,n),c=this.appendBridgeFees([a],t,n),p=this.appendPhantomFee(c,t);return{quote:t,fees:{totalFees:this.sumFees(p),fees:p},swapTransactions:o}}createSwapTransactions(t){let r=[],o=[],n=[];for(let a of t.steps){let{transactionData:c,sellToken:p,buyToken:d}=a;r.push(c),o.push("bridge"),n.push({sellToken:p,buyToken:d})}return Promise.resolve({type:"bitcoin",transactions:r,transactionTypes:o,transactionPairs:n})}appendPhantomFee(t,r){let o=r.steps.flatMap(n=>n.feeCosts).find(n=>n.name==="phantom");return o?[...t,{type:"phantom",percentage:new _(o.percentage),amountUsd:new _(0),amount:new _(0)}]:t}appendBridgeFees(t,r,o){let n={[this.getNativeTokenCaip19()]:o},a=mo(r,this.networkID,n),c=po(r);return[...t,...c,...a]}async calculateNetworkFee(t,r){if(!r.usd)throw new Error("Price data not found");let o=t.steps.flatMap(n=>n.gasCosts??[]);if(o.length>0){let n=o.reduce((p,d)=>p+d,0);return{type:"bitcoinNetwork",amountUsd:new _(n).shiftedBy(-8).times(r.usd),amount:new _(n)}}try{let n=t.steps[0];if(!n?.transactionData)throw new Error("No transaction data available for fee estimation");let a=Tc.Psbt.fromHex(n.transactionData),c=l0(a),d=(await _g(this.networkID))[Tr.standard]?.btcPerKilobyte;if(!d)throw new Error("Failed to get standard fee rate");let f=Hf(d).times(c).integerValue(_.ROUND_UP);return{type:"bitcoinNetwork",amountUsd:f.shiftedBy(-8).times(r.usd),amount:f}}catch{let a=new _(1e4);return{type:"bitcoinNetwork",amountUsd:a.shiftedBy(-8).times(r.usd),amount:a}}}sumFees(t){return t.reduce((r,o)=>r.plus(o.amountUsd),new _(0))}};function l0(e){let{header:t,perInput:r}=sa[Wf(e)],{inputs:o}=e.data,n=new _(t),a=new _(o.length).times(r),c=e.txOutputs.reduce((p,d)=>{let m=xc.decompile(d.script);if(m&&m[0]===xc.OPS.OP_RETURN)return p;let f;if(d.address)f=d.address;else try{f=(0,iw.fromOutputScript)(d.script,Tc.networks.bitcoin)}catch{return p.plus(sa[ye.BitcoinNativeSegwit].perOutput)}let h=df(me.Bitcoin.Mainnet,f);return p.plus(sa[h].perOutput)},new _(0));return n.plus(a).plus(c)}i(l0,"calculateVirtualBytes");u();l();u();l();var aw=P(O());u();l();var _e;(function(e){e.SlippageTolerance="slippageTolerance",e.PriorityFee="priorityFee",e.TipAmount="tipAmount",e.LastSubmittedPairs="lastSubmittedPairsV2",e.LastSelectedTokens="lastSelectedTokens",e.SlippageSettings="slippageSettings",e.HasViewedAutoSlippageOptIn="hasViewedAutoSlippageOptIn",e.PriorityFeeSettings="priorityFeeSettings",e.TipSettings="tipSettings"})(_e||(_e={}));function Dt({key:e,queryKey:t,defaultValue:r=null}){let o=Tt();return ie({enabled:!0,queryKey:t,gcTime:Za.Long,staleTime:Ya.Never,async queryFn(){try{return await o.get(e)}catch(n){return n instanceof Error&&R.captureError(n,U.Swapper),r}}})}i(Dt,"useSwapStorageValue");function Nt({key:e,queryKey:t}){let r=Tt(),o=qe();return vo({async mutationFn(n){try{return await r.set(e,n)}catch(a){a instanceof Error&&R.captureError(a,U.Swapper);return}},async onMutate(n){await o.cancelQueries({queryKey:t});let a=o.getQueryData(t);return o.setQueryData(t,n),{previousValue:a}},onError(n,a,c){o.setQueryData(t,c?.previousValue)}})}i(Nt,"useSetSwapStorageValue");var ce;(function(e){e.Auto="auto",e.Fixed="fixed"})(ce||(ce={}));var p0={type:ce.Auto},fo=i(()=>{let{slippageSetting:e,isFetched:t,save:r}=d0();return{isFetched:t,selectedSetting:e??p0,setSlippageSetting:r}},"useSlippageSettings"),d0=i(()=>{let{data:e,isFetched:t}=Dt({key:_e.SlippageSettings,queryKey:we.slippageSettings()}),{mutateAsync:r}=Nt({key:_e.SlippageSettings,queryKey:we.slippageSettings()}),o=(0,aw.useCallback)(async n=>{await r(n)},[r]);return{isFetched:t,slippageSetting:e,save:o}},"useSlippageSettingsStore");u();l();async function Nn({transactions:e,locale:t,url:r,deviceId:o,takerAddress:n,networkId:a,slippageType:c,quote:p,quoteResponse:d,isSimulationKilled:m}){try{return m?{status:"skipped"}:A.isHyperevmNetworkID(a)?{status:"skipped"}:{status:"success",result:await Bl(t,o,{type:"transaction",userAccount:n,params:m0(e),url:r,networkID:a,context:se(p)?"bridge":wy(p)?"gaslessSwap":"swap",provider:f0(p),slippageType:c,metadata:{swapper:{quoteOutputAmount:p.buyAmount,quoteOutputToken:M(d.buyToken),quoteInputAmount:p.sellAmount,quoteInputToken:M(d.sellToken)}}})}}catch(f){return{status:"error",error:f}}}i(Nn,"simulateSwap");var m0=i(e=>{switch(e.type){case"evm":return{transactions:e.transactions};case"solana":return{transactions:e.transactions,method:"signAndSendTransaction",simulatorConfig:{decodeAccounts:!1}};case"sui":case"bitcoin":return{transactions:e.transactions,method:"signAndSendTransaction"}}},"getScannedTransactionParams"),f0=i(e=>{let t=se(e)?vn(e):e?.sources??[];return De(t)},"getProvider");var Ac=class{static{i(this,"EVMProcessBridgeQuoteCommand")}networkID;account;priceClient;quoteInput;quoteResponse;constructor(t,r,o,n,a){this.networkID=t,this.account=r,this.priceClient=o,this.quoteInput=n,this.quoteResponse=a}getNativeTokenCaip19(){return M({chainId:this.networkID,resourceType:J.nativeToken,slip44:A.getSlip44(this.networkID)})}async processQuote(t,r){let o=await this.createSwapTransactions(t),n=await this.priceClient.getPrice(this.getNativeTokenCaip19());if(!n.usd)throw new Error("Price data not found");let a=await this.calculateNetworkFee(o,t,n,r),c=this.appendBridgeFees([a],t,n),p=this.appendPhantomFee(c,t);return{quote:t,fees:{totalFees:this.sumFees(p),fees:p},swapTransactions:o}}createSwapTransactions(t){return Ks({networkId:this.networkID,callerAddress:this.checkChainAddress().address,quote:t})}appendPhantomFee(t,r){let o=r.steps.flatMap(n=>n.feeCosts).find(n=>n.name==="phantom");return o?[...t,{type:"phantom",percentage:new _(o.percentage),amountUsd:new _(0),amount:new _(0)}]:t}appendBridgeFees(t,r,o){let n={[this.getNativeTokenCaip19()]:o},a=mo(r,this.networkID,n),c=po(r);return[...t,...c,...a]}async calculateNetworkFee(t,r,o,n){let a=await this.estimateGas(r,t,n);if(!a)throw new Error("Unable to estimate gas");if(!o.usd)throw new Error("Price data not found");let c=a[0],p=A.getTokenDecimals(this.networkID),d=c.gasLimit.times(c.maxFeePerGas);return{type:"evmGas",amountUsd:new _(d).shiftedBy(-p).times(o.usd),amount:d}}async estimateGas(t,r,o){let n=await hn(this.networkID,!0);if(!n)return;let a=n[Tr.standard];if(!a)return;let c={networkID:this.networkID,gasLimit:new _(1),maxFeePerGas:a.maxFeePerGas,maxPriorityFeePerGas:a.maxPriorityFeePerGas},p=await Nn({transactions:r,locale:"en-us",url:"https://phantom.app",deviceId:"123",takerAddress:this.checkChainAddress().address,networkId:this.networkID,slippageType:this.quoteInput.autoSlippage?ce.Auto:ce.Fixed,quote:t,quoteResponse:this.quoteResponse,isSimulationKilled:o});return Pn.estimateGas({swapTransactions:r,evmGasEstimation:c,currentQuote:t,scanResult:p.status==="success"?p.result:void 0,includeGasBuffer:!0,networkID:this.networkID,gasBuffer:this.quoteResponse.gasBuffer})}checkChainAddress(){let t=this.account.addresses.find(o=>o.networkID===this.networkID);if(!t)throw new Error(`No address found for chain ${this.networkID}`);let r={...t};return gr(r)&&(r.address=r.address.toLowerCase()),r}sumFees(t){return t.reduce((r,o)=>r.plus(o.amountUsd),new _(0))}};u();l();var Ec=class{static{i(this,"EVMProcessQuoteCommand")}networkID;account;priceClient;quoteInput;quoteResponse;constructor(t,r,o,n,a){this.networkID=t,this.account=r,this.priceClient=o,this.quoteInput=n,this.quoteResponse=a}getNativeTokenCaip19(){return M({chainId:this.networkID,resourceType:J.nativeToken,slip44:A.getSlip44(this.networkID)})}async processQuote(t,r){let o=await this.createSwapTransactions(t),n=await this.calculateNetworkFee(o,t,r),a=this.appendPhantomFee([n],t);return{quote:t,fees:{totalFees:this.sumFees(a),fees:a},swapTransactions:o}}createSwapTransactions(t){return Vs({networkId:this.networkID,callerAddress:this.checkChainAddress().address,quote:t,sellFungible:this.quoteInput.sell})}appendPhantomFee(t,r){let o=r.fees.find(n=>n.type==="phantom");return o?[...t,{type:"phantom",percentage:new _(o.percentage),amountUsd:new _(0),amount:new _(0)}]:t}async calculateNetworkFee(t,r,o){let n=await this.estimateGas(r,t,o);if(!n)throw new Error("Unable to estimate gas");let a=await this.priceClient.getPrice(this.getNativeTokenCaip19());if(!a.usd)throw new Error("Price data not found");let c=n[0],p=A.getTokenDecimals(this.networkID),d=c.gasLimit.times(c.maxFeePerGas);return{type:"evmGas",amountUsd:new _(d).shiftedBy(-p).times(a.usd),amount:d}}async estimateGas(t,r,o){let n=await hn(this.networkID,!0);if(!n)return;let a=n[Tr.standard];if(!a)return;let c={networkID:this.networkID,gasLimit:new _(1),maxFeePerGas:a.maxFeePerGas,maxPriorityFeePerGas:a.maxPriorityFeePerGas},p=await Nn({transactions:r,locale:"en-us",url:"https://phantom.app",deviceId:"123",takerAddress:this.checkChainAddress().address,networkId:this.networkID,slippageType:this.quoteInput.autoSlippage?ce.Auto:ce.Fixed,quote:t,quoteResponse:this.quoteResponse,isSimulationKilled:o});return Pn.estimateGas({swapTransactions:r,evmGasEstimation:c,currentQuote:t,scanResult:p.status==="success"?p.result:void 0,includeGasBuffer:!0,networkID:this.networkID,gasBuffer:this.quoteResponse.gasBuffer})}checkChainAddress(){let t=this.account.addresses.find(o=>o.networkID===this.networkID);if(!t)throw new Error(`No address found for chain ${this.networkID}`);let r={...t};return gr(r)&&(r.address=r.address.toLowerCase()),r}sumFees(t){return t.reduce((r,o)=>r.plus(o.amountUsd),new _(0))}};u();l();var kc=class{static{i(this,"SolanaProcessBridgeQuoteCommand")}networkID;priceClient;connection;constructor(t,r,o){this.networkID=t,this.priceClient=r,this.connection=o}getNativeTokenCaip19(){return M({chainId:this.networkID,resourceType:J.nativeToken,slip44:A.getSlip44(this.networkID)})}async processQuote(t,r){let o=await this.createSwapTransactions(t),n=await this.priceClient.getPrice(this.getNativeTokenCaip19());if(!n.usd)throw new Error("Price data not found");let a=await this.calculateNetworkFee(o,n),c=this.appendBridgeFees([a],t,n),p=this.appendPhantomFee(c,t);return{quote:t,fees:{totalFees:this.sumFees(p),fees:p},swapTransactions:o}}createSwapTransactions(t){return js({quote:t,connection:this.connection})}appendPhantomFee(t,r){let o=r.steps.flatMap(n=>n.feeCosts).find(n=>n.name==="phantom");return o?[...t,{type:"phantom",percentage:new _(o.percentage),amountUsd:new _(0),amount:new _(0)}]:t}appendBridgeFees(t,r,o){let n={[this.getNativeTokenCaip19()]:o},a=mo(r,this.networkID,n),c=po(r);return[...t,...c,...a]}async calculateNetworkFee(t,r){if(!r.usd)throw new Error("Price data not found");let o=t.transactions.map(m=>this.processEncodedTx(m,this.networkID,this.connection)),a=(await Promise.all(o)).map(m=>m.networkFeeEstimation.value),c=new _(a[0]);return{type:"solanaNetwork",amountUsd:c.div(new _(Pe.LAMPORTS_PER_SOL)).times(r.usd),amount:c}}async processEncodedTx(t,r,o){let n=kt(t,"bs58");return await Jm(n,o),{networkFeeEstimation:await pg(r,[n.message])}}sumFees(t){return t.reduce((r,o)=>r.plus(o.amountUsd),new _(0))}};u();l();u();l();function cw(e,t){return g0(e.fees,r=>{switch(r.type){case"gasless":return{type:"gasless",amountUsd:new _(0),amount:new _(0),percentage:new _(r.percentage)};case"phantom":return{type:"phantom",percentage:new _(r.percentage),amountUsd:new _(0),amount:new _(0)};case"ata":return new _(r.amount).isZero()?void 0:{type:"ata",amountUsd:new _(r.amount),amount:new _(0)};case"gasless_network":return{type:"solanaGaslessNetwork",amountUsd:new _(r.amount),amount:new _(0)};case"network":{let{amountUsd:o,amount:n}=Fp(r,t);return{type:"solanaNetwork",amountUsd:o,amount:n}}case"tips":{let{amountUsd:o,amount:n}=Fp(r,t);return{type:"tips",amountUsd:o,amount:n}}case"priority_fee":{let{amountUsd:o,amount:n}=Fp(r,t);return{type:"priorityFee",amountUsd:o,amount:n}}case"prediction_fee_per_contract":return{type:"predictionFeePerContract",amountUsd:new _(r.amount),amount:new _(r.amount)};default:return}})}i(cw,"parseFees");function Fp(e,t){let r=new _(e.amount);return{amountUsd:r.div(new _(Pe.LAMPORTS_PER_SOL)).times(t),amount:r}}i(Fp,"getAmountsFromNativeAmount");function g0(e,t){return e.reduce((r,o,n)=>{let a=t(o,n,e);return a!=null&&r.push(a),r},[])}i(g0,"compactMap");var uw=["solanaNetwork","tips","priorityFee"],Cc=class{static{i(this,"SolanaProcessQuoteCommand")}networkID;priceClient;connection;constructor(t,r,o){this.networkID=t,this.priceClient=r,this.connection=o}getNativeTokenCaip19(){return M({chainId:this.networkID,resourceType:J.nativeToken,slip44:A.getSlip44(this.networkID)})}async processQuote(t,r){let n=(await this.priceClient.getPrice(this.getNativeTokenCaip19())).usd;if(!n)throw new Error(`Price data not found for native token ${this.getNativeTokenCaip19()}`);let a=await this.createSwapTransactions(t),c=cw(t,n),p=await this.processParsedFees(c,n);return{quote:t,fees:{totalFees:this.sumFees(p),fees:p},swapTransactions:a}}async processParsedFees(t,r){if(t.find(d=>d.type==="solanaGaslessNetwork"))return t;let o=t.filter(d=>!uw.includes(d.type)),n=t.filter(d=>uw.includes(d.type)),a=t.find(d=>d.type==="priorityFee"),c=await this.calculateNetworkFee(a,r),p=this.sumNetworkFees(c,n);return[...o,p]}sumNetworkFees(t,r){return r.reduce((o,n)=>({...o,amount:o.amount.plus(n.amount),amountUsd:o.amountUsd.plus(n.amountUsd)}),t)}createSwapTransactions(t){return Fn({quote:t,connection:this.connection})}getAmountsFromNativeAmount(t,r){let o=new _(t.amount);return{amountUsd:o.div(new _(Pe.LAMPORTS_PER_SOL)).times(r),amount:o}}async calculateNetworkFee(t,r){let o=new _(t?.amount??0);return{type:"solanaNetwork",amountUsd:o.div(new _(Pe.LAMPORTS_PER_SOL)).times(r),amount:o}}sumFees(t){return t.reduce((r,o)=>r.plus(o.amountUsd),new _(0))}};u();l();u();l();var Bn=class{static{i(this,"SuiProcessQuoteCommand")}networkID;priceClient;constructor(t,r){this.networkID=t,this.priceClient=r}getNativeTokenCaip19(){return M({chainId:this.networkID,resourceType:J.nativeToken,slip44:A.getSlip44(this.networkID)})}async processQuote(t,r){let o=await this.createSwapTransactions(t),n=await this.calculateNetworkFee(o),a=this.appendPhantomFee([n],t);return{quote:t,fees:{totalFees:this.sumFees(a),fees:a},swapTransactions:o}}createSwapTransactions(t){return Hs({quote:t})}appendPhantomFee(t,r){let o=r.fees.find(n=>n.type==="phantom");return o?[...t,{type:"phantom",percentage:new _(o.percentage),amountUsd:new _(0),amount:new _(0)}]:t}async calculateNetworkFee(t){let r=await this.priceClient.getPrice(this.getNativeTokenCaip19());if(!r.usd)throw new Error("Price data not found");let o=new _(0),n=new _(0);try{let a=await Promise.all(t.transactions.map(c=>ug({networkID:this.networkID,transaction:ua.deserializeTransactionString(c)})));n=new _(a.reduce((c,p)=>c+p.gasBudget.toNumber(),0)),o=n.dividedBy(1e9).multipliedBy(r.usd)}catch{return{type:"suiNetwork",amountUsd:new _(0),amount:new _(0)}}return{type:"suiNetwork",amountUsd:o,amount:n}}sumFees(t){return t.reduce((r,o)=>r.plus(o.amountUsd),new _(0))}};var _c=class{static{i(this,"SuiBridgeProcessQuoteCommand")}networkID;priceClient;suiProcessQuoteCommand;constructor(t,r){this.networkID=t,this.priceClient=r,this.suiProcessQuoteCommand=new Bn(t,r)}getNativeTokenCaip19(){return this.suiProcessQuoteCommand.getNativeTokenCaip19()}async processQuote(t,r){let o=await this.createSwapTransactions(t),n=await this.priceClient.getPrice(this.getNativeTokenCaip19());if(!n.usd)throw new Error("Price data not found");let a=await this.suiProcessQuoteCommand.calculateNetworkFee(o),c=this.appendBridgeFees([a],t,n),p=this.appendPhantomFee(c,t);return{quote:t,fees:{totalFees:this.sumFees(p),fees:p},swapTransactions:o}}appendBridgeFees(t,r,o){let n={[this.getNativeTokenCaip19()]:o},a=mo(r,this.networkID,n),c=po(r);return[...t,...c,...a]}appendPhantomFee(t,r){let o=r.steps.flatMap(n=>n.feeCosts).find(n=>n.name==="phantom");return o?[...t,{type:"phantom",percentage:new _(o.percentage),amountUsd:new _(0),amount:new _(0)}]:t}createSwapTransactions(t){return $s({quote:t})}sumFees(t){return t.reduce((r,o)=>r.plus(o.amountUsd),new _(0))}};var Ic=class{static{i(this,"ProcessQuoteCommandFactoryImpl")}create(t,r,o,n){let a=r.sell.data.chain.id,c=r.buy.data.chain.id,p=$t(a,c);if(A.isSolanaNetworkID(a)){let d=Fg(t).connection;return p?new kc(a,this.priceClient,d):new Cc(a,this.priceClient,d)}else{if(A.isEVMNetworkID(a))return p?new Ac(a,t,this.priceClient,r,o):new Ec(a,t,this.priceClient,r,o);if(A.isSuiNetworkID(a))return p?new _c(a,this.priceClient):new Bn(a,this.priceClient);if(A.isBitcoinNetworkID(a)&&p)return new bc(a,this.priceClient)}throw new Error(`Unsupported network ID: ${a}`)}priceClient={getPrice:i(async t=>(await ga({tokens:[et(t)]}))[t],"getPrice")};isSupportedNetwork(t){return A.isSolanaNetworkID(t)||A.isEVMNetworkID(t)}},Fc=class{static{i(this,"NoOpProcessQuoteCommandFactory")}create(t,r,o,n){return{processQuote:i(async(a,c)=>({quote:a,fees:{totalFees:new _(0),fees:[]}}),"processQuote")}}};u();l();u();l();u();l();var lw="CASH";u();l();var pw=i(e=>e.reduce((t,r)=>{if(!r||r.type!==oe.SPL)return t;let o;return r.type===oe.SPL&&(o=h0(r)),o?{fees:[...t.fees,o],totalPercentFees:t.totalPercentFees+o.percentFee}:t},{fees:[],totalPercentFees:0}),"getSwapTransferFees"),h0=i(e=>{if(e.type!==oe.SPL)return;let r=(e.data.mintExtensions??[]).find(o=>o.extension===ma.transferFeeConfig);if(r)return{caip19:M(te(e)),fungibleKey:e.data.key,symbol:e.data.symbol??"",name:e.data.name??"",percentFee:r.state.newerTransferFee.transferFeeBasisPoints/100}},"getSplTransferFee");u();l();var y0=i(e=>e.isGreaterThanOrEqualTo(1)?"0,0.[00]":"0,0.[00000]","getFormatString"),Ln=i(e=>{let t=_(e);return wa(e,y0(t))},"formatTokenAmountGreaterThan1");var w0=.05,S0=5,b0=.5;function vp(e,t,r,o){let{priceImpact:n,quoteSlippageTolerance:a}=T0(e),c=t.autoSlippage?a??r.slippageTolerance:r.slippageTolerance,p={type:"slippage",slippage:c,slippageType:t.autoSlippage?ce.Auto:ce.Fixed,alert:c&&c>=S0?"highSlippage":void 0},d={type:"priceImpact",priceImpactPercentage:n.gt(0)?Mg(n.toNumber()):"-",alert:n&&n.gte(w0)?"highPriceImpact":void 0,warning:n&&n.gte(b0)?"veryHighPriceImpact":void 0},f=[Pp(e,t.buy,t.sell),p,d],h=pw([t.sell,t.buy]);return h.fees.length>0&&f.push({type:"transferFees",transferFees:h.totalPercentFees,transferTokenSymbol:t.sell.data.symbol??"",alert:"transferFees"}),o&&f.push({type:"fees",quoteFees:o}),f}i(vp,"entriesForQuote");function T0(e){return Pt(e)?{priceImpact:e.priceImpact?_(e.priceImpact):_(0),quoteSlippageTolerance:e.slippageTolerance}:lr(e)?{priceImpact:e.priceImpact?_(e.priceImpact):_(0),quoteSlippageTolerance:e.slippageTolerance}:qr(e)?{priceImpact:e.priceImpact?_(e.priceImpact):_(0),quoteSlippageTolerance:e.slippageTolerance}:{priceImpact:_(0),quoteSlippageTolerance:void 0}}i(T0,"extractQuoteInfo");function Pp(e,t,r){let{buyAmount:o,sellAmount:n}=e,a=new _(o).shiftedBy(-t.data.decimals).dividedBy(new _(n).shiftedBy(-r.data.decimals));return{type:"pricing",ratio:a,exchangeRate:`1 ${vc(r)} \u2248 ${Ln(a)} ${vc(t)}`,exchangeRateFlipped:`1 ${vc(t)} \u2248 ${Ln(_(1).dividedBy(a))} ${vc(r)}`}}i(Pp,"parsePricing");function vc(e){return fa(e)?lw:e.data.symbol??""}i(vc,"cashDeobfuscatedSymbol");u();l();var Pc=class{static{i(this,"AsyncQueue")}queue=[];processing=!1;enqueue(t){this.queue.push(t),this.processNext()}clearQueue(){this.queue=[],this.processing=!1}async processNext(){if(this.processing||this.queue.length===0)return;this.processing=!0;let t=this.queue.shift();if(t)try{await t()}catch(r){console.error("Error processing task:",r)}this.processing=!1,this.processNext()}};u();l();var Xs=class{static{i(this,"QuoteDetails")}entries;alerts=[];warnings=[];constructor(t){this.entries=t;for(let r of t)r.alert&&this.alerts.push(r.alert),r.warning&&this.warnings.push(r.warning)}};u();l();var Rp;(function(e){e.SwapperNoQuotes="SwapperNoQuotes",e.InsufficientSellAmount="InsufficientSellAmount",e.CrossChainUnavailable="CrossChainUnavailable",e.TokenNotTradable="TokenNotTradable",e.NotEnoughSuiObjects="NotEnoughSuiObjects",e.FromTokenIsHoneyPotToken="FromTokenIsHoneyPotToken",e.ToTokenIsHoneyPotToken="ToTokenIsHoneyPotToken",e.InsufficientLiquidity="InsufficientLiquidity",e.SwapInitializationFailed="SwapInitializationFailed",e.pSolHighImpactError="pSolHighImpactError"})(Rp||(Rp={}));var Rc=class e extends Error{static{i(this,"QuoteError")}name;type;constructor(t,r,o){super(r),this.name=t,this.type=o}static fromErrorResponse(t,r){return i(n=>Object.values(Rp).includes(n),"isValidType")(t)?new e(t,r,t):new e(t,r)}};var x0="swap-quotes",Dc=class{static{i(this,"QuoteProcessor")}quoteStreamer;commandFactory;state={type:"idle"};listeners=[];swapTransactionQueue=new Pc;constructor(t,r){this.quoteStreamer=t,this.commandFactory=r}start(t,r){this.setState({type:"starting",input:t,account:r}),this.quoteStreamer.subscribe(this.quoteStreamListener),this.quoteStreamer.openStream(t)}stop(){this.swapTransactionQueue.clearQueue(),this.setState({type:"idle"}),this.quoteStreamer.closeStream(),this.quoteStreamer.unsubscribe(this.quoteStreamListener)}setQuoteStreamer(t){this.stop(),this.quoteStreamer=t}quoteStreamListener={onEvent:i(t=>{switch(t.type){case"newQuoteResponse":switch(this.state.type){case"starting":let n=this.findPreferredQuote(this.state.input,t.quoteResponse);this.setState({type:"firstQuoteReceived",input:this.state.input,quote:n,response:t.quoteResponse,account:this.state.account,quoteDetails:new Xs(vp(n,this.state.input,t.quoteResponse))}),this.enqueueQuoteToProcess(this.state.input,t.quoteResponse,this.state.account);break;case"quoteProcessed":this.enqueueQuoteToProcess(this.state.input,t.quoteResponse,this.state.account,this.state.prevProcessedQuote);break}break;case"error":let r=Rc.fromErrorResponse(t.errorResponse.name,t.errorResponse.message),o=new je({key:r.name});switch(R.addBreadcrumb(x0,JSON.stringify(r.name),Y.Info),this.state.type){case"starting":case"firstQuoteReceived":case"quoteProcessed":case"error":this.setState({type:"error",error:o,quoteError:r,account:this.state.account,input:this.state.input});break}break;case"openRequested":break;case"close":this.setState({type:"idle"});break}},"onEvent")};enqueueQuoteToProcess(t,r,o,n){this.swapTransactionQueue.enqueue(()=>this.processQuote(r,t,o,n))}async processQuote(t,r,o,n){try{let a=this.findPreferredQuote(r,t),p=await this.commandFactory.create(o,r,t,r.isSimulationKilled).processQuote(a,r.isSimulationKilled);switch(this.state.type){case"firstQuoteReceived":case"quoteProcessed":case"error":this.setState({type:"quoteProcessed",input:r,response:t,quote:a,prevProcessedQuote:n,nextProcessedQuote:p,account:o,quoteDetails:new Xs(vp(a,r,t,p.fees))});break}return p}catch(a){throw R.captureError(a,U.Swapper),a}}subscribe(t){this.listeners.push(t)}unsubscribe(t){this.listeners=this.listeners.filter(r=>r!==t)}getState(){return this.state}findPreferredQuote(t,r){let o=t.preferredProvider;return o&&r.quotes.find(n=>n.baseProvider.id===o)||r.quotes[0]}setState(t){let r=this.state;this.state=t,this.listeners.forEach(o=>o.onStateChange(r,t))}};u();l();u();l();u();l();u();l();function zn(e){let t=e.length;for(;--t>=0;)e[t]=0}i(zn,"zero$1");var A0=0,Zw=1,E0=2,k0=3,C0=258,rd=29,mi=256,si=mi+1+rd,On=30,od=19,Yw=2*si+1,Uo=15,Dp=16,_0=7,nd=256,Xw=16,Jw=17,eS=18,$p=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Oc=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),I0=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),tS=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),F0=512,Vr=new Array((si+2)*2);zn(Vr);var ri=new Array(On*2);zn(ri);var ii=new Array(F0);zn(ii);var ai=new Array(C0-k0+1);zn(ai);var sd=new Array(rd);zn(sd);var Qc=new Array(On);zn(Qc);function Np(e,t,r,o,n){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=o,this.max_length=n,this.has_stree=e&&e.length}i(Np,"StaticTreeDesc");var rS,oS,nS;function Bp(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}i(Bp,"TreeDesc");var sS=i(e=>e<256?ii[e]:ii[256+(e>>>7)],"d_code"),ci=i((e,t)=>{e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255},"put_short"),Bt=i((e,t,r)=>{e.bi_valid>Dp-r?(e.bi_buf|=t<<e.bi_valid&65535,ci(e,e.bi_buf),e.bi_buf=t>>Dp-e.bi_valid,e.bi_valid+=r-Dp):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)},"send_bits"),Cr=i((e,t,r)=>{Bt(e,r[t*2],r[t*2+1])},"send_code"),iS=i((e,t)=>{let r=0;do r|=e&1,e>>>=1,r<<=1;while(--t>0);return r>>>1},"bi_reverse"),v0=i(e=>{e.bi_valid===16?(ci(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},"bi_flush"),P0=i((e,t)=>{let r=t.dyn_tree,o=t.max_code,n=t.stat_desc.static_tree,a=t.stat_desc.has_stree,c=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,d=t.stat_desc.max_length,m,f,h,y,w,S,T=0;for(y=0;y<=Uo;y++)e.bl_count[y]=0;for(r[e.heap[e.heap_max]*2+1]=0,m=e.heap_max+1;m<Yw;m++)f=e.heap[m],y=r[r[f*2+1]*2+1]+1,y>d&&(y=d,T++),r[f*2+1]=y,!(f>o)&&(e.bl_count[y]++,w=0,f>=p&&(w=c[f-p]),S=r[f*2],e.opt_len+=S*(y+w),a&&(e.static_len+=S*(n[f*2+1]+w)));if(T!==0){do{for(y=d-1;e.bl_count[y]===0;)y--;e.bl_count[y]--,e.bl_count[y+1]+=2,e.bl_count[d]--,T-=2}while(T>0);for(y=d;y!==0;y--)for(f=e.bl_count[y];f!==0;)h=e.heap[--m],!(h>o)&&(r[h*2+1]!==y&&(e.opt_len+=(y-r[h*2+1])*r[h*2],r[h*2+1]=y),f--)}},"gen_bitlen"),aS=i((e,t,r)=>{let o=new Array(Uo+1),n=0,a,c;for(a=1;a<=Uo;a++)n=n+r[a-1]<<1,o[a]=n;for(c=0;c<=t;c++){let p=e[c*2+1];p!==0&&(e[c*2]=iS(o[p]++,p))}},"gen_codes"),R0=i(()=>{let e,t,r,o,n,a=new Array(Uo+1);for(r=0,o=0;o<rd-1;o++)for(sd[o]=r,e=0;e<1<<$p[o];e++)ai[r++]=o;for(ai[r-1]=o,n=0,o=0;o<16;o++)for(Qc[o]=n,e=0;e<1<<Oc[o];e++)ii[n++]=o;for(n>>=7;o<On;o++)for(Qc[o]=n<<7,e=0;e<1<<Oc[o]-7;e++)ii[256+n++]=o;for(t=0;t<=Uo;t++)a[t]=0;for(e=0;e<=143;)Vr[e*2+1]=8,e++,a[8]++;for(;e<=255;)Vr[e*2+1]=9,e++,a[9]++;for(;e<=279;)Vr[e*2+1]=7,e++,a[7]++;for(;e<=287;)Vr[e*2+1]=8,e++,a[8]++;for(aS(Vr,si+1,a),e=0;e<On;e++)ri[e*2+1]=5,ri[e*2]=iS(e,5);rS=new Np(Vr,$p,mi+1,si,Uo),oS=new Np(ri,Oc,0,On,Uo),nS=new Np(new Array(0),I0,0,od,_0)},"tr_static_init"),cS=i(e=>{let t;for(t=0;t<si;t++)e.dyn_ltree[t*2]=0;for(t=0;t<On;t++)e.dyn_dtree[t*2]=0;for(t=0;t<od;t++)e.bl_tree[t*2]=0;e.dyn_ltree[nd*2]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},"init_block"),uS=i(e=>{e.bi_valid>8?ci(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},"bi_windup"),dw=i((e,t,r,o)=>{let n=t*2,a=r*2;return e[n]<e[a]||e[n]===e[a]&&o[t]<=o[r]},"smaller"),Lp=i((e,t,r)=>{let o=e.heap[r],n=r<<1;for(;n<=e.heap_len&&(n<e.heap_len&&dw(t,e.heap[n+1],e.heap[n],e.depth)&&n++,!dw(t,o,e.heap[n],e.depth));)e.heap[r]=e.heap[n],r=n,n<<=1;e.heap[r]=o},"pqdownheap"),mw=i((e,t,r)=>{let o,n,a=0,c,p;if(e.sym_next!==0)do o=e.pending_buf[e.sym_buf+a++]&255,o+=(e.pending_buf[e.sym_buf+a++]&255)<<8,n=e.pending_buf[e.sym_buf+a++],o===0?Cr(e,n,t):(c=ai[n],Cr(e,c+mi+1,t),p=$p[c],p!==0&&(n-=sd[c],Bt(e,n,p)),o--,c=sS(o),Cr(e,c,r),p=Oc[c],p!==0&&(o-=Qc[c],Bt(e,o,p)));while(a<e.sym_next);Cr(e,nd,t)},"compress_block"),Hp=i((e,t)=>{let r=t.dyn_tree,o=t.stat_desc.static_tree,n=t.stat_desc.has_stree,a=t.stat_desc.elems,c,p,d=-1,m;for(e.heap_len=0,e.heap_max=Yw,c=0;c<a;c++)r[c*2]!==0?(e.heap[++e.heap_len]=d=c,e.depth[c]=0):r[c*2+1]=0;for(;e.heap_len<2;)m=e.heap[++e.heap_len]=d<2?++d:0,r[m*2]=1,e.depth[m]=0,e.opt_len--,n&&(e.static_len-=o[m*2+1]);for(t.max_code=d,c=e.heap_len>>1;c>=1;c--)Lp(e,r,c);m=a;do c=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Lp(e,r,1),p=e.heap[1],e.heap[--e.heap_max]=c,e.heap[--e.heap_max]=p,r[m*2]=r[c*2]+r[p*2],e.depth[m]=(e.depth[c]>=e.depth[p]?e.depth[c]:e.depth[p])+1,r[c*2+1]=r[p*2+1]=m,e.heap[1]=m++,Lp(e,r,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],P0(e,t),aS(r,d,e.bl_count)},"build_tree"),fw=i((e,t,r)=>{let o,n=-1,a,c=t[0*2+1],p=0,d=7,m=4;for(c===0&&(d=138,m=3),t[(r+1)*2+1]=65535,o=0;o<=r;o++)a=c,c=t[(o+1)*2+1],!(++p<d&&a===c)&&(p<m?e.bl_tree[a*2]+=p:a!==0?(a!==n&&e.bl_tree[a*2]++,e.bl_tree[Xw*2]++):p<=10?e.bl_tree[Jw*2]++:e.bl_tree[eS*2]++,p=0,n=a,c===0?(d=138,m=3):a===c?(d=6,m=3):(d=7,m=4))},"scan_tree"),gw=i((e,t,r)=>{let o,n=-1,a,c=t[0*2+1],p=0,d=7,m=4;for(c===0&&(d=138,m=3),o=0;o<=r;o++)if(a=c,c=t[(o+1)*2+1],!(++p<d&&a===c)){if(p<m)do Cr(e,a,e.bl_tree);while(--p!==0);else a!==0?(a!==n&&(Cr(e,a,e.bl_tree),p--),Cr(e,Xw,e.bl_tree),Bt(e,p-3,2)):p<=10?(Cr(e,Jw,e.bl_tree),Bt(e,p-3,3)):(Cr(e,eS,e.bl_tree),Bt(e,p-11,7));p=0,n=a,c===0?(d=138,m=3):a===c?(d=6,m=3):(d=7,m=4)}},"send_tree"),D0=i(e=>{let t;for(fw(e,e.dyn_ltree,e.l_desc.max_code),fw(e,e.dyn_dtree,e.d_desc.max_code),Hp(e,e.bl_desc),t=od-1;t>=3&&e.bl_tree[tS[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t},"build_bl_tree"),N0=i((e,t,r,o)=>{let n;for(Bt(e,t-257,5),Bt(e,r-1,5),Bt(e,o-4,4),n=0;n<o;n++)Bt(e,e.bl_tree[tS[n]*2+1],3);gw(e,e.dyn_ltree,t-1),gw(e,e.dyn_dtree,r-1)},"send_all_trees"),B0=i(e=>{let t=4093624447,r;for(r=0;r<=31;r++,t>>>=1)if(t&1&&e.dyn_ltree[r*2]!==0)return 0;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return 1;for(r=32;r<mi;r++)if(e.dyn_ltree[r*2]!==0)return 1;return 0},"detect_data_type"),hw=!1,L0=i(e=>{hw||(R0(),hw=!0),e.l_desc=new Bp(e.dyn_ltree,rS),e.d_desc=new Bp(e.dyn_dtree,oS),e.bl_desc=new Bp(e.bl_tree,nS),e.bi_buf=0,e.bi_valid=0,cS(e)},"_tr_init$1"),lS=i((e,t,r,o)=>{Bt(e,(A0<<1)+(o?1:0),3),uS(e),ci(e,r),ci(e,~r),r&&e.pending_buf.set(e.window.subarray(t,t+r),e.pending),e.pending+=r},"_tr_stored_block$1"),U0=i(e=>{Bt(e,Zw<<1,3),Cr(e,nd,Vr),v0(e)},"_tr_align$1"),M0=i((e,t,r,o)=>{let n,a,c=0;e.level>0?(e.strm.data_type===2&&(e.strm.data_type=B0(e)),Hp(e,e.l_desc),Hp(e,e.d_desc),c=D0(e),n=e.opt_len+3+7>>>3,a=e.static_len+3+7>>>3,a<=n&&(n=a)):n=a=r+5,r+4<=n&&t!==-1?lS(e,t,r,o):e.strategy===4||a===n?(Bt(e,(Zw<<1)+(o?1:0),3),mw(e,Vr,ri)):(Bt(e,(E0<<1)+(o?1:0),3),N0(e,e.l_desc.max_code+1,e.d_desc.max_code+1,c+1),mw(e,e.dyn_ltree,e.dyn_dtree)),cS(e),o&&uS(e)},"_tr_flush_block$1"),O0=i((e,t,r)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=r,t===0?e.dyn_ltree[r*2]++:(e.matches++,t--,e.dyn_ltree[(ai[r]+mi+1)*2]++,e.dyn_dtree[sS(t)*2]++),e.sym_next===e.sym_end),"_tr_tally$1"),Q0=L0,q0=lS,z0=M0,G0=O0,K0=U0,j0={_tr_init:Q0,_tr_stored_block:q0,_tr_flush_block:z0,_tr_tally:G0,_tr_align:K0},V0=i((e,t,r,o)=>{let n=e&65535|0,a=e>>>16&65535|0,c=0;for(;r!==0;){c=r>2e3?2e3:r,r-=c;do n=n+t[o++]|0,a=a+n|0;while(--c);n%=65521,a%=65521}return n|a<<16|0},"adler32"),ui=V0,$0=i(()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var o=0;o<8;o++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},"makeTable"),H0=new Uint32Array($0()),W0=i((e,t,r,o)=>{let n=H0,a=o+r;e^=-1;for(let c=o;c<a;c++)e=e>>>8^n[(e^t[c])&255];return e^-1},"crc32"),st=W0,Qo={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Go={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},{_tr_init:Z0,_tr_stored_block:Wp,_tr_flush_block:Y0,_tr_tally:yo,_tr_align:X0}=j0,{Z_NO_FLUSH:wo,Z_PARTIAL_FLUSH:J0,Z_FULL_FLUSH:eI,Z_FINISH:Ht,Z_BLOCK:yw,Z_OK:at,Z_STREAM_END:ww,Z_STREAM_ERROR:_r,Z_DATA_ERROR:tI,Z_BUF_ERROR:Up,Z_DEFAULT_COMPRESSION:rI,Z_FILTERED:oI,Z_HUFFMAN_ONLY:Nc,Z_RLE:nI,Z_FIXED:sI,Z_DEFAULT_STRATEGY:iI,Z_UNKNOWN:aI,Z_DEFLATED:Gc}=Go,cI=9,uI=15,lI=8,pI=29,dI=256,Zp=dI+1+pI,mI=30,fI=19,gI=2*Zp+1,hI=15,he=3,ho=258,Ir=ho+he+1,yI=32,Qn=42,id=57,Yp=69,Xp=73,Jp=91,ed=103,Mo=113,ei=666,Et=1,Gn=2,qo=3,Kn=4,wI=3,Oo=i((e,t)=>(e.msg=Qo[t],t),"err"),Sw=i(e=>e*2-(e>4?9:0),"rank"),go=i(e=>{let t=e.length;for(;--t>=0;)e[t]=0},"zero"),SI=i(e=>{let t,r,o,n=e.w_size;t=e.hash_size,o=t;do r=e.head[--o],e.head[o]=r>=n?r-n:0;while(--t);t=n,o=t;do r=e.prev[--o],e.prev[o]=r>=n?r-n:0;while(--t)},"slide_hash"),bI=i((e,t,r)=>(t<<e.hash_shift^r)&e.hash_mask,"HASH_ZLIB"),So=bI,zt=i(e=>{let t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),r!==0&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,t.pending===0&&(t.pending_out=0))},"flush_pending"),Gt=i((e,t)=>{Y0(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,zt(e.strm)},"flush_block_only"),Ee=i((e,t)=>{e.pending_buf[e.pending++]=t},"put_byte"),Js=i((e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255},"putShortMSB"),td=i((e,t,r,o)=>{let n=e.avail_in;return n>o&&(n=o),n===0?0:(e.avail_in-=n,t.set(e.input.subarray(e.next_in,e.next_in+n),r),e.state.wrap===1?e.adler=ui(e.adler,t,n,r):e.state.wrap===2&&(e.adler=st(e.adler,t,n,r)),e.next_in+=n,e.total_in+=n,n)},"read_buf"),pS=i((e,t)=>{let r=e.max_chain_length,o=e.strstart,n,a,c=e.prev_length,p=e.nice_match,d=e.strstart>e.w_size-Ir?e.strstart-(e.w_size-Ir):0,m=e.window,f=e.w_mask,h=e.prev,y=e.strstart+ho,w=m[o+c-1],S=m[o+c];e.prev_length>=e.good_match&&(r>>=2),p>e.lookahead&&(p=e.lookahead);do if(n=t,!(m[n+c]!==S||m[n+c-1]!==w||m[n]!==m[o]||m[++n]!==m[o+1])){o+=2,n++;do;while(m[++o]===m[++n]&&m[++o]===m[++n]&&m[++o]===m[++n]&&m[++o]===m[++n]&&m[++o]===m[++n]&&m[++o]===m[++n]&&m[++o]===m[++n]&&m[++o]===m[++n]&&o<y);if(a=ho-(y-o),o=y-ho,a>c){if(e.match_start=t,c=a,a>=p)break;w=m[o+c-1],S=m[o+c]}}while((t=h[t&f])>d&&--r!==0);return c<=e.lookahead?c:e.lookahead},"longest_match"),qn=i(e=>{let t=e.w_size,r,o,n;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-Ir)&&(e.window.set(e.window.subarray(t,t+t-o),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),SI(e),o+=t),e.strm.avail_in===0)break;if(r=td(e.strm,e.window,e.strstart+e.lookahead,o),e.lookahead+=r,e.lookahead+e.insert>=he)for(n=e.strstart-e.insert,e.ins_h=e.window[n],e.ins_h=So(e,e.ins_h,e.window[n+1]);e.insert&&(e.ins_h=So(e,e.ins_h,e.window[n+he-1]),e.prev[n&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=n,n++,e.insert--,!(e.lookahead+e.insert<he)););}while(e.lookahead<Ir&&e.strm.avail_in!==0)},"fill_window"),dS=i((e,t)=>{let r=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,o,n,a,c=0,p=e.strm.avail_in;do{if(o=65535,a=e.bi_valid+42>>3,e.strm.avail_out<a||(a=e.strm.avail_out-a,n=e.strstart-e.block_start,o>n+e.strm.avail_in&&(o=n+e.strm.avail_in),o>a&&(o=a),o<r&&(o===0&&t!==Ht||t===wo||o!==n+e.strm.avail_in)))break;c=t===Ht&&o===n+e.strm.avail_in?1:0,Wp(e,0,0,c),e.pending_buf[e.pending-4]=o,e.pending_buf[e.pending-3]=o>>8,e.pending_buf[e.pending-2]=~o,e.pending_buf[e.pending-1]=~o>>8,zt(e.strm),n&&(n>o&&(n=o),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+n),e.strm.next_out),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n,e.block_start+=n,o-=n),o&&(td(e.strm,e.strm.output,e.strm.next_out,o),e.strm.next_out+=o,e.strm.avail_out-=o,e.strm.total_out+=o)}while(c===0);return p-=e.strm.avail_in,p&&(p>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=p&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-p,e.strm.next_in),e.strstart),e.strstart+=p,e.insert+=p>e.w_size-e.insert?e.w_size-e.insert:p),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),c?Kn:t!==wo&&t!==Ht&&e.strm.avail_in===0&&e.strstart===e.block_start?Gn:(a=e.window_size-e.strstart,e.strm.avail_in>a&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,a+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),a>e.strm.avail_in&&(a=e.strm.avail_in),a&&(td(e.strm,e.window,e.strstart,a),e.strstart+=a,e.insert+=a>e.w_size-e.insert?e.w_size-e.insert:a),e.high_water<e.strstart&&(e.high_water=e.strstart),a=e.bi_valid+42>>3,a=e.pending_buf_size-a>65535?65535:e.pending_buf_size-a,r=a>e.w_size?e.w_size:a,n=e.strstart-e.block_start,(n>=r||(n||t===Ht)&&t!==wo&&e.strm.avail_in===0&&n<=a)&&(o=n>a?a:n,c=t===Ht&&e.strm.avail_in===0&&o===n?1:0,Wp(e,e.block_start,o,c),e.block_start+=o,zt(e.strm)),c?qo:Et)},"deflate_stored"),Mp=i((e,t)=>{let r,o;for(;;){if(e.lookahead<Ir){if(qn(e),e.lookahead<Ir&&t===wo)return Et;if(e.lookahead===0)break}if(r=0,e.lookahead>=he&&(e.ins_h=So(e,e.ins_h,e.window[e.strstart+he-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),r!==0&&e.strstart-r<=e.w_size-Ir&&(e.match_length=pS(e,r)),e.match_length>=he)if(o=yo(e,e.strstart-e.match_start,e.match_length-he),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=he){e.match_length--;do e.strstart++,e.ins_h=So(e,e.ins_h,e.window[e.strstart+he-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=So(e,e.ins_h,e.window[e.strstart+1]);else o=yo(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(o&&(Gt(e,!1),e.strm.avail_out===0))return Et}return e.insert=e.strstart<he-1?e.strstart:he-1,t===Ht?(Gt(e,!0),e.strm.avail_out===0?qo:Kn):e.sym_next&&(Gt(e,!1),e.strm.avail_out===0)?Et:Gn},"deflate_fast"),Un=i((e,t)=>{let r,o,n;for(;;){if(e.lookahead<Ir){if(qn(e),e.lookahead<Ir&&t===wo)return Et;if(e.lookahead===0)break}if(r=0,e.lookahead>=he&&(e.ins_h=So(e,e.ins_h,e.window[e.strstart+he-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=he-1,r!==0&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-Ir&&(e.match_length=pS(e,r),e.match_length<=5&&(e.strategy===oI||e.match_length===he&&e.strstart-e.match_start>4096)&&(e.match_length=he-1)),e.prev_length>=he&&e.match_length<=e.prev_length){n=e.strstart+e.lookahead-he,o=yo(e,e.strstart-1-e.prev_match,e.prev_length-he),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=n&&(e.ins_h=So(e,e.ins_h,e.window[e.strstart+he-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=he-1,e.strstart++,o&&(Gt(e,!1),e.strm.avail_out===0))return Et}else if(e.match_available){if(o=yo(e,0,e.window[e.strstart-1]),o&&Gt(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return Et}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(o=yo(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<he-1?e.strstart:he-1,t===Ht?(Gt(e,!0),e.strm.avail_out===0?qo:Kn):e.sym_next&&(Gt(e,!1),e.strm.avail_out===0)?Et:Gn},"deflate_slow"),TI=i((e,t)=>{let r,o,n,a,c=e.window;for(;;){if(e.lookahead<=ho){if(qn(e),e.lookahead<=ho&&t===wo)return Et;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=he&&e.strstart>0&&(n=e.strstart-1,o=c[n],o===c[++n]&&o===c[++n]&&o===c[++n])){a=e.strstart+ho;do;while(o===c[++n]&&o===c[++n]&&o===c[++n]&&o===c[++n]&&o===c[++n]&&o===c[++n]&&o===c[++n]&&o===c[++n]&&n<a);e.match_length=ho-(a-n),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=he?(r=yo(e,1,e.match_length-he),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=yo(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(Gt(e,!1),e.strm.avail_out===0))return Et}return e.insert=0,t===Ht?(Gt(e,!0),e.strm.avail_out===0?qo:Kn):e.sym_next&&(Gt(e,!1),e.strm.avail_out===0)?Et:Gn},"deflate_rle"),xI=i((e,t)=>{let r;for(;;){if(e.lookahead===0&&(qn(e),e.lookahead===0)){if(t===wo)return Et;break}if(e.match_length=0,r=yo(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(Gt(e,!1),e.strm.avail_out===0))return Et}return e.insert=0,t===Ht?(Gt(e,!0),e.strm.avail_out===0?qo:Kn):e.sym_next&&(Gt(e,!1),e.strm.avail_out===0)?Et:Gn},"deflate_huff");function kr(e,t,r,o,n){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=o,this.func=n}i(kr,"Config");var ti=[new kr(0,0,0,0,dS),new kr(4,4,8,4,Mp),new kr(4,5,16,8,Mp),new kr(4,6,32,32,Mp),new kr(4,4,16,16,Un),new kr(8,16,32,32,Un),new kr(8,16,128,128,Un),new kr(8,32,128,256,Un),new kr(32,128,258,1024,Un),new kr(32,258,258,4096,Un)],AI=i(e=>{e.window_size=2*e.w_size,go(e.head),e.max_lazy_match=ti[e.level].max_lazy,e.good_match=ti[e.level].good_length,e.nice_match=ti[e.level].nice_length,e.max_chain_length=ti[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=he-1,e.match_available=0,e.ins_h=0},"lm_init");function EI(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Gc,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(gI*2),this.dyn_dtree=new Uint16Array((2*mI+1)*2),this.bl_tree=new Uint16Array((2*fI+1)*2),go(this.dyn_ltree),go(this.dyn_dtree),go(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(hI+1),this.heap=new Uint16Array(2*Zp+1),go(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Zp+1),go(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}i(EI,"DeflateState");var fi=i(e=>{if(!e)return 1;let t=e.state;return!t||t.strm!==e||t.status!==Qn&&t.status!==id&&t.status!==Yp&&t.status!==Xp&&t.status!==Jp&&t.status!==ed&&t.status!==Mo&&t.status!==ei?1:0},"deflateStateCheck"),mS=i(e=>{if(fi(e))return Oo(e,_r);e.total_in=e.total_out=0,e.data_type=aI;let t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap===2?id:t.wrap?Qn:Mo,e.adler=t.wrap===2?0:1,t.last_flush=-2,Z0(t),at},"deflateResetKeep"),fS=i(e=>{let t=mS(e);return t===at&&AI(e.state),t},"deflateReset"),kI=i((e,t)=>fi(e)||e.state.wrap!==2?_r:(e.state.gzhead=t,at),"deflateSetHeader"),gS=i((e,t,r,o,n,a)=>{if(!e)return _r;let c=1;if(t===rI&&(t=6),o<0?(c=0,o=-o):o>15&&(c=2,o-=16),n<1||n>cI||r!==Gc||o<8||o>15||t<0||t>9||a<0||a>sI||o===8&&c!==1)return Oo(e,_r);o===8&&(o=9);let p=new EI;return e.state=p,p.strm=e,p.status=Qn,p.wrap=c,p.gzhead=null,p.w_bits=o,p.w_size=1<<p.w_bits,p.w_mask=p.w_size-1,p.hash_bits=n+7,p.hash_size=1<<p.hash_bits,p.hash_mask=p.hash_size-1,p.hash_shift=~~((p.hash_bits+he-1)/he),p.window=new Uint8Array(p.w_size*2),p.head=new Uint16Array(p.hash_size),p.prev=new Uint16Array(p.w_size),p.lit_bufsize=1<<n+6,p.pending_buf_size=p.lit_bufsize*4,p.pending_buf=new Uint8Array(p.pending_buf_size),p.sym_buf=p.lit_bufsize,p.sym_end=(p.lit_bufsize-1)*3,p.level=t,p.strategy=a,p.method=r,fS(e)},"deflateInit2"),CI=i((e,t)=>gS(e,t,Gc,uI,lI,iI),"deflateInit"),_I=i((e,t)=>{if(fi(e)||t>yw||t<0)return e?Oo(e,_r):_r;let r=e.state;if(!e.output||e.avail_in!==0&&!e.input||r.status===ei&&t!==Ht)return Oo(e,e.avail_out===0?Up:_r);let o=r.last_flush;if(r.last_flush=t,r.pending!==0){if(zt(e),e.avail_out===0)return r.last_flush=-1,at}else if(e.avail_in===0&&Sw(t)<=Sw(o)&&t!==Ht)return Oo(e,Up);if(r.status===ei&&e.avail_in!==0)return Oo(e,Up);if(r.status===Qn&&r.wrap===0&&(r.status=Mo),r.status===Qn){let n=Gc+(r.w_bits-8<<4)<<8,a=-1;if(r.strategy>=Nc||r.level<2?a=0:r.level<6?a=1:r.level===6?a=2:a=3,n|=a<<6,r.strstart!==0&&(n|=yI),n+=31-n%31,Js(r,n),r.strstart!==0&&(Js(r,e.adler>>>16),Js(r,e.adler&65535)),e.adler=1,r.status=Mo,zt(e),r.pending!==0)return r.last_flush=-1,at}if(r.status===id){if(e.adler=0,Ee(r,31),Ee(r,139),Ee(r,8),r.gzhead)Ee(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),Ee(r,r.gzhead.time&255),Ee(r,r.gzhead.time>>8&255),Ee(r,r.gzhead.time>>16&255),Ee(r,r.gzhead.time>>24&255),Ee(r,r.level===9?2:r.strategy>=Nc||r.level<2?4:0),Ee(r,r.gzhead.os&255),r.gzhead.extra&&r.gzhead.extra.length&&(Ee(r,r.gzhead.extra.length&255),Ee(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=st(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=Yp;else if(Ee(r,0),Ee(r,0),Ee(r,0),Ee(r,0),Ee(r,0),Ee(r,r.level===9?2:r.strategy>=Nc||r.level<2?4:0),Ee(r,wI),r.status=Mo,zt(e),r.pending!==0)return r.last_flush=-1,at}if(r.status===Yp){if(r.gzhead.extra){let n=r.pending,a=(r.gzhead.extra.length&65535)-r.gzindex;for(;r.pending+a>r.pending_buf_size;){let p=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+p),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>n&&(e.adler=st(e.adler,r.pending_buf,r.pending-n,n)),r.gzindex+=p,zt(e),r.pending!==0)return r.last_flush=-1,at;n=0,a-=p}let c=new Uint8Array(r.gzhead.extra);r.pending_buf.set(c.subarray(r.gzindex,r.gzindex+a),r.pending),r.pending+=a,r.gzhead.hcrc&&r.pending>n&&(e.adler=st(e.adler,r.pending_buf,r.pending-n,n)),r.gzindex=0}r.status=Xp}if(r.status===Xp){if(r.gzhead.name){let n=r.pending,a;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>n&&(e.adler=st(e.adler,r.pending_buf,r.pending-n,n)),zt(e),r.pending!==0)return r.last_flush=-1,at;n=0}r.gzindex<r.gzhead.name.length?a=r.gzhead.name.charCodeAt(r.gzindex++)&255:a=0,Ee(r,a)}while(a!==0);r.gzhead.hcrc&&r.pending>n&&(e.adler=st(e.adler,r.pending_buf,r.pending-n,n)),r.gzindex=0}r.status=Jp}if(r.status===Jp){if(r.gzhead.comment){let n=r.pending,a;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>n&&(e.adler=st(e.adler,r.pending_buf,r.pending-n,n)),zt(e),r.pending!==0)return r.last_flush=-1,at;n=0}r.gzindex<r.gzhead.comment.length?a=r.gzhead.comment.charCodeAt(r.gzindex++)&255:a=0,Ee(r,a)}while(a!==0);r.gzhead.hcrc&&r.pending>n&&(e.adler=st(e.adler,r.pending_buf,r.pending-n,n))}r.status=ed}if(r.status===ed){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(zt(e),r.pending!==0))return r.last_flush=-1,at;Ee(r,e.adler&255),Ee(r,e.adler>>8&255),e.adler=0}if(r.status=Mo,zt(e),r.pending!==0)return r.last_flush=-1,at}if(e.avail_in!==0||r.lookahead!==0||t!==wo&&r.status!==ei){let n=r.level===0?dS(r,t):r.strategy===Nc?xI(r,t):r.strategy===nI?TI(r,t):ti[r.level].func(r,t);if((n===qo||n===Kn)&&(r.status=ei),n===Et||n===qo)return e.avail_out===0&&(r.last_flush=-1),at;if(n===Gn&&(t===J0?X0(r):t!==yw&&(Wp(r,0,0,!1),t===eI&&(go(r.head),r.lookahead===0&&(r.strstart=0,r.block_start=0,r.insert=0))),zt(e),e.avail_out===0))return r.last_flush=-1,at}return t!==Ht?at:r.wrap<=0?ww:(r.wrap===2?(Ee(r,e.adler&255),Ee(r,e.adler>>8&255),Ee(r,e.adler>>16&255),Ee(r,e.adler>>24&255),Ee(r,e.total_in&255),Ee(r,e.total_in>>8&255),Ee(r,e.total_in>>16&255),Ee(r,e.total_in>>24&255)):(Js(r,e.adler>>>16),Js(r,e.adler&65535)),zt(e),r.wrap>0&&(r.wrap=-r.wrap),r.pending!==0?at:ww)},"deflate$2"),II=i(e=>{if(fi(e))return _r;let t=e.state.status;return e.state=null,t===Mo?Oo(e,tI):at},"deflateEnd"),FI=i((e,t)=>{let r=t.length;if(fi(e))return _r;let o=e.state,n=o.wrap;if(n===2||n===1&&o.status!==Qn||o.lookahead)return _r;if(n===1&&(e.adler=ui(e.adler,t,r,0)),o.wrap=0,r>=o.w_size){n===0&&(go(o.head),o.strstart=0,o.block_start=0,o.insert=0);let d=new Uint8Array(o.w_size);d.set(t.subarray(r-o.w_size,r),0),t=d,r=o.w_size}let a=e.avail_in,c=e.next_in,p=e.input;for(e.avail_in=r,e.next_in=0,e.input=t,qn(o);o.lookahead>=he;){let d=o.strstart,m=o.lookahead-(he-1);do o.ins_h=So(o,o.ins_h,o.window[d+he-1]),o.prev[d&o.w_mask]=o.head[o.ins_h],o.head[o.ins_h]=d,d++;while(--m);o.strstart=d,o.lookahead=he-1,qn(o)}return o.strstart+=o.lookahead,o.block_start=o.strstart,o.insert=o.lookahead,o.lookahead=0,o.match_length=o.prev_length=he-1,o.match_available=0,e.next_in=c,e.input=p,e.avail_in=a,o.wrap=n,at},"deflateSetDictionary"),vI=CI,PI=gS,RI=fS,DI=mS,NI=kI,BI=_I,LI=II,UI=FI,MI="pako deflate (from Nodeca project)",oi={deflateInit:vI,deflateInit2:PI,deflateReset:RI,deflateResetKeep:DI,deflateSetHeader:NI,deflate:BI,deflateEnd:LI,deflateSetDictionary:UI,deflateInfo:MI},OI=i((e,t)=>Object.prototype.hasOwnProperty.call(e,t),"_has"),QI=i(function(e){let t=Array.prototype.slice.call(arguments,1);for(;t.length;){let r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(let o in r)OI(r,o)&&(e[o]=r[o])}}return e},"assign"),qI=i(e=>{let t=0;for(let o=0,n=e.length;o<n;o++)t+=e[o].length;let r=new Uint8Array(t);for(let o=0,n=0,a=e.length;o<a;o++){let c=e[o];r.set(c,n),n+=c.length}return r},"flattenChunks"),Kc={assign:QI,flattenChunks:qI},hS=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{hS=!1}var li=new Uint8Array(256);for(let e=0;e<256;e++)li[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;li[254]=li[254]=1;var zI=i(e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,o,n,a,c=e.length,p=0;for(n=0;n<c;n++)r=e.charCodeAt(n),(r&64512)===55296&&n+1<c&&(o=e.charCodeAt(n+1),(o&64512)===56320&&(r=65536+(r-55296<<10)+(o-56320),n++)),p+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(p),a=0,n=0;a<p;n++)r=e.charCodeAt(n),(r&64512)===55296&&n+1<c&&(o=e.charCodeAt(n+1),(o&64512)===56320&&(r=65536+(r-55296<<10)+(o-56320),n++)),r<128?t[a++]=r:r<2048?(t[a++]=192|r>>>6,t[a++]=128|r&63):r<65536?(t[a++]=224|r>>>12,t[a++]=128|r>>>6&63,t[a++]=128|r&63):(t[a++]=240|r>>>18,t[a++]=128|r>>>12&63,t[a++]=128|r>>>6&63,t[a++]=128|r&63);return t},"string2buf"),GI=i((e,t)=>{if(t<65534&&e.subarray&&hS)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let o=0;o<t;o++)r+=String.fromCharCode(e[o]);return r},"buf2binstring"),KI=i((e,t)=>{let r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let o,n,a=new Array(r*2);for(n=0,o=0;o<r;){let c=e[o++];if(c<128){a[n++]=c;continue}let p=li[c];if(p>4){a[n++]=65533,o+=p-1;continue}for(c&=p===2?31:p===3?15:7;p>1&&o<r;)c=c<<6|e[o++]&63,p--;if(p>1){a[n++]=65533;continue}c<65536?a[n++]=c:(c-=65536,a[n++]=55296|c>>10&1023,a[n++]=56320|c&1023)}return GI(a,n)},"buf2string"),jI=i((e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+li[e[r]]>t?r:t},"utf8border"),pi={string2buf:zI,buf2string:KI,utf8border:jI};function VI(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}i(VI,"ZStream");var yS=VI,wS=Object.prototype.toString,{Z_NO_FLUSH:$I,Z_SYNC_FLUSH:HI,Z_FULL_FLUSH:WI,Z_FINISH:ZI,Z_OK:qc,Z_STREAM_END:YI,Z_DEFAULT_COMPRESSION:XI,Z_DEFAULT_STRATEGY:JI,Z_DEFLATED:eF}=Go;function gi(e){this.options=Kc.assign({level:XI,method:eF,chunkSize:16384,windowBits:15,memLevel:8,strategy:JI},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new yS,this.strm.avail_out=0;let r=oi.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==qc)throw new Error(Qo[r]);if(t.header&&oi.deflateSetHeader(this.strm,t.header),t.dictionary){let o;if(typeof t.dictionary=="string"?o=pi.string2buf(t.dictionary):wS.call(t.dictionary)==="[object ArrayBuffer]"?o=new Uint8Array(t.dictionary):o=t.dictionary,r=oi.deflateSetDictionary(this.strm,o),r!==qc)throw new Error(Qo[r]);this._dict_set=!0}}i(gi,"Deflate$1");gi.prototype.push=function(e,t){let r=this.strm,o=this.options.chunkSize,n,a;if(this.ended)return!1;for(t===~~t?a=t:a=t===!0?ZI:$I,typeof e=="string"?r.input=pi.string2buf(e):wS.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){if(r.avail_out===0&&(r.output=new Uint8Array(o),r.next_out=0,r.avail_out=o),(a===HI||a===WI)&&r.avail_out<=6){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(n=oi.deflate(r,a),n===YI)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),n=oi.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===qc;if(r.avail_out===0){this.onData(r.output);continue}if(a>0&&r.next_out>0){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(r.avail_in===0)break}return!0};gi.prototype.onData=function(e){this.chunks.push(e)};gi.prototype.onEnd=function(e){e===qc&&(this.result=Kc.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function ad(e,t){let r=new gi(t);if(r.push(e,!0),r.err)throw r.msg||Qo[r.err];return r.result}i(ad,"deflate$1");function tF(e,t){return t=t||{},t.raw=!0,ad(e,t)}i(tF,"deflateRaw$1");function rF(e,t){return t=t||{},t.gzip=!0,ad(e,t)}i(rF,"gzip$1");var oF=gi,nF=ad,sF=tF,iF=rF,aF=Go,cF={Deflate:oF,deflate:nF,deflateRaw:sF,gzip:iF,constants:aF},Bc=16209,uF=16191,lF=i(function(t,r){let o,n,a,c,p,d,m,f,h,y,w,S,T,b,x,E,C,I,B,Q,N,Z,q,k,F=t.state;o=t.next_in,q=t.input,n=o+(t.avail_in-5),a=t.next_out,k=t.output,c=a-(r-t.avail_out),p=a+(t.avail_out-257),d=F.dmax,m=F.wsize,f=F.whave,h=F.wnext,y=F.window,w=F.hold,S=F.bits,T=F.lencode,b=F.distcode,x=(1<<F.lenbits)-1,E=(1<<F.distbits)-1;e:do{S<15&&(w+=q[o++]<<S,S+=8,w+=q[o++]<<S,S+=8),C=T[w&x];t:for(;;){if(I=C>>>24,w>>>=I,S-=I,I=C>>>16&255,I===0)k[a++]=C&65535;else if(I&16){B=C&65535,I&=15,I&&(S<I&&(w+=q[o++]<<S,S+=8),B+=w&(1<<I)-1,w>>>=I,S-=I),S<15&&(w+=q[o++]<<S,S+=8,w+=q[o++]<<S,S+=8),C=b[w&E];r:for(;;){if(I=C>>>24,w>>>=I,S-=I,I=C>>>16&255,I&16){if(Q=C&65535,I&=15,S<I&&(w+=q[o++]<<S,S+=8,S<I&&(w+=q[o++]<<S,S+=8)),Q+=w&(1<<I)-1,Q>d){t.msg="invalid distance too far back",F.mode=Bc;break e}if(w>>>=I,S-=I,I=a-c,Q>I){if(I=Q-I,I>f&&F.sane){t.msg="invalid distance too far back",F.mode=Bc;break e}if(N=0,Z=y,h===0){if(N+=m-I,I<B){B-=I;do k[a++]=y[N++];while(--I);N=a-Q,Z=k}}else if(h<I){if(N+=m+h-I,I-=h,I<B){B-=I;do k[a++]=y[N++];while(--I);if(N=0,h<B){I=h,B-=I;do k[a++]=y[N++];while(--I);N=a-Q,Z=k}}}else if(N+=h-I,I<B){B-=I;do k[a++]=y[N++];while(--I);N=a-Q,Z=k}for(;B>2;)k[a++]=Z[N++],k[a++]=Z[N++],k[a++]=Z[N++],B-=3;B&&(k[a++]=Z[N++],B>1&&(k[a++]=Z[N++]))}else{N=a-Q;do k[a++]=k[N++],k[a++]=k[N++],k[a++]=k[N++],B-=3;while(B>2);B&&(k[a++]=k[N++],B>1&&(k[a++]=k[N++]))}}else if(I&64){t.msg="invalid distance code",F.mode=Bc;break e}else{C=b[(C&65535)+(w&(1<<I)-1)];continue r}break}}else if(I&64)if(I&32){F.mode=uF;break e}else{t.msg="invalid literal/length code",F.mode=Bc;break e}else{C=T[(C&65535)+(w&(1<<I)-1)];continue t}break}}while(o<n&&a<p);B=S>>3,o-=B,S-=B<<3,w&=(1<<S)-1,t.next_in=o,t.next_out=a,t.avail_in=o<n?5+(n-o):5-(o-n),t.avail_out=a<p?257+(p-a):257-(a-p),F.hold=w,F.bits=S},"inflate_fast"),Mn=15,bw=852,Tw=592,xw=0,Op=1,Aw=2,pF=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),dF=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),mF=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),fF=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),gF=i((e,t,r,o,n,a,c,p)=>{let d=p.bits,m=0,f=0,h=0,y=0,w=0,S=0,T=0,b=0,x=0,E=0,C,I,B,Q,N,Z=null,q,k=new Uint16Array(Mn+1),F=new Uint16Array(Mn+1),G=null,$,X,H;for(m=0;m<=Mn;m++)k[m]=0;for(f=0;f<o;f++)k[t[r+f]]++;for(w=d,y=Mn;y>=1&&k[y]===0;y--);if(w>y&&(w=y),y===0)return n[a++]=1<<24|64<<16|0,n[a++]=1<<24|64<<16|0,p.bits=1,0;for(h=1;h<y&&k[h]===0;h++);for(w<h&&(w=h),b=1,m=1;m<=Mn;m++)if(b<<=1,b-=k[m],b<0)return-1;if(b>0&&(e===xw||y!==1))return-1;for(F[1]=0,m=1;m<Mn;m++)F[m+1]=F[m]+k[m];for(f=0;f<o;f++)t[r+f]!==0&&(c[F[t[r+f]]++]=f);if(e===xw?(Z=G=c,q=20):e===Op?(Z=pF,G=dF,q=257):(Z=mF,G=fF,q=0),E=0,f=0,m=h,N=a,S=w,T=0,B=-1,x=1<<w,Q=x-1,e===Op&&x>bw||e===Aw&&x>Tw)return 1;for(;;){$=m-T,c[f]+1<q?(X=0,H=c[f]):c[f]>=q?(X=G[c[f]-q],H=Z[c[f]-q]):(X=96,H=0),C=1<<m-T,I=1<<S,h=I;do I-=C,n[N+(E>>T)+I]=$<<24|X<<16|H|0;while(I!==0);for(C=1<<m-1;E&C;)C>>=1;if(C!==0?(E&=C-1,E+=C):E=0,f++,--k[m]===0){if(m===y)break;m=t[r+c[f]]}if(m>w&&(E&Q)!==B){for(T===0&&(T=w),N+=h,S=m-T,b=1<<S;S+T<y&&(b-=k[S+T],!(b<=0));)S++,b<<=1;if(x+=1<<S,e===Op&&x>bw||e===Aw&&x>Tw)return 1;B=E&Q,n[B]=w<<24|S<<16|N-a|0}}return E!==0&&(n[N+E]=m-T<<24|64<<16|0),p.bits=w,0},"inflate_table"),ni=gF,hF=0,SS=1,bS=2,{Z_FINISH:Ew,Z_BLOCK:yF,Z_TREES:Lc,Z_OK:zo,Z_STREAM_END:wF,Z_NEED_DICT:SF,Z_STREAM_ERROR:Wt,Z_DATA_ERROR:TS,Z_MEM_ERROR:xS,Z_BUF_ERROR:bF,Z_DEFLATED:kw}=Go,jc=16180,Cw=16181,_w=16182,Iw=16183,Fw=16184,vw=16185,Pw=16186,Rw=16187,Dw=16188,Nw=16189,zc=16190,jr=16191,Qp=16192,Bw=16193,qp=16194,Lw=16195,Uw=16196,Mw=16197,Ow=16198,Uc=16199,Mc=16200,Qw=16201,qw=16202,zw=16203,Gw=16204,Kw=16205,zp=16206,jw=16207,Vw=16208,Le=16209,AS=16210,ES=16211,TF=852,xF=592,AF=15,EF=AF,$w=i(e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24),"zswap32");function kF(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}i(kF,"InflateState");var Ko=i(e=>{if(!e)return 1;let t=e.state;return!t||t.strm!==e||t.mode<jc||t.mode>ES?1:0},"inflateStateCheck"),kS=i(e=>{if(Ko(e))return Wt;let t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=jc,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(TF),t.distcode=t.distdyn=new Int32Array(xF),t.sane=1,t.back=-1,zo},"inflateResetKeep"),CS=i(e=>{if(Ko(e))return Wt;let t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,kS(e)},"inflateReset"),_S=i((e,t)=>{let r;if(Ko(e))return Wt;let o=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?Wt:(o.window!==null&&o.wbits!==t&&(o.window=null),o.wrap=r,o.wbits=t,CS(e))},"inflateReset2"),IS=i((e,t)=>{if(!e)return Wt;let r=new kF;e.state=r,r.strm=e,r.window=null,r.mode=jc;let o=_S(e,t);return o!==zo&&(e.state=null),o},"inflateInit2"),CF=i(e=>IS(e,EF),"inflateInit"),Hw=!0,Gp,Kp,_F=i(e=>{if(Hw){Gp=new Int32Array(512),Kp=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(ni(SS,e.lens,0,288,Gp,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;ni(bS,e.lens,0,32,Kp,0,e.work,{bits:5}),Hw=!1}e.lencode=Gp,e.lenbits=9,e.distcode=Kp,e.distbits=5},"fixedtables"),FS=i((e,t,r,o)=>{let n,a=e.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),o>=a.wsize?(a.window.set(t.subarray(r-a.wsize,r),0),a.wnext=0,a.whave=a.wsize):(n=a.wsize-a.wnext,n>o&&(n=o),a.window.set(t.subarray(r-o,r-o+n),a.wnext),o-=n,o?(a.window.set(t.subarray(r-o,r),0),a.wnext=o,a.whave=a.wsize):(a.wnext+=n,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=n))),0},"updatewindow"),IF=i((e,t)=>{let r,o,n,a,c,p,d,m,f,h,y,w,S,T,b=0,x,E,C,I,B,Q,N,Z,q=new Uint8Array(4),k,F,G=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Ko(e)||!e.output||!e.input&&e.avail_in!==0)return Wt;r=e.state,r.mode===jr&&(r.mode=Qp),c=e.next_out,n=e.output,d=e.avail_out,a=e.next_in,o=e.input,p=e.avail_in,m=r.hold,f=r.bits,h=p,y=d,Z=zo;e:for(;;)switch(r.mode){case jc:if(r.wrap===0){r.mode=Qp;break}for(;f<16;){if(p===0)break e;p--,m+=o[a++]<<f,f+=8}if(r.wrap&2&&m===35615){r.wbits===0&&(r.wbits=15),r.check=0,q[0]=m&255,q[1]=m>>>8&255,r.check=st(r.check,q,2,0),m=0,f=0,r.mode=Cw;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((m&255)<<8)+(m>>8))%31){e.msg="incorrect header check",r.mode=Le;break}if((m&15)!==kw){e.msg="unknown compression method",r.mode=Le;break}if(m>>>=4,f-=4,N=(m&15)+8,r.wbits===0&&(r.wbits=N),N>15||N>r.wbits){e.msg="invalid window size",r.mode=Le;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=m&512?Nw:jr,m=0,f=0;break;case Cw:for(;f<16;){if(p===0)break e;p--,m+=o[a++]<<f,f+=8}if(r.flags=m,(r.flags&255)!==kw){e.msg="unknown compression method",r.mode=Le;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=Le;break}r.head&&(r.head.text=m>>8&1),r.flags&512&&r.wrap&4&&(q[0]=m&255,q[1]=m>>>8&255,r.check=st(r.check,q,2,0)),m=0,f=0,r.mode=_w;case _w:for(;f<32;){if(p===0)break e;p--,m+=o[a++]<<f,f+=8}r.head&&(r.head.time=m),r.flags&512&&r.wrap&4&&(q[0]=m&255,q[1]=m>>>8&255,q[2]=m>>>16&255,q[3]=m>>>24&255,r.check=st(r.check,q,4,0)),m=0,f=0,r.mode=Iw;case Iw:for(;f<16;){if(p===0)break e;p--,m+=o[a++]<<f,f+=8}r.head&&(r.head.xflags=m&255,r.head.os=m>>8),r.flags&512&&r.wrap&4&&(q[0]=m&255,q[1]=m>>>8&255,r.check=st(r.check,q,2,0)),m=0,f=0,r.mode=Fw;case Fw:if(r.flags&1024){for(;f<16;){if(p===0)break e;p--,m+=o[a++]<<f,f+=8}r.length=m,r.head&&(r.head.extra_len=m),r.flags&512&&r.wrap&4&&(q[0]=m&255,q[1]=m>>>8&255,r.check=st(r.check,q,2,0)),m=0,f=0}else r.head&&(r.head.extra=null);r.mode=vw;case vw:if(r.flags&1024&&(w=r.length,w>p&&(w=p),w&&(r.head&&(N=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(o.subarray(a,a+w),N)),r.flags&512&&r.wrap&4&&(r.check=st(r.check,o,w,a)),p-=w,a+=w,r.length-=w),r.length))break e;r.length=0,r.mode=Pw;case Pw:if(r.flags&2048){if(p===0)break e;w=0;do N=o[a+w++],r.head&&N&&r.length<65536&&(r.head.name+=String.fromCharCode(N));while(N&&w<p);if(r.flags&512&&r.wrap&4&&(r.check=st(r.check,o,w,a)),p-=w,a+=w,N)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=Rw;case Rw:if(r.flags&4096){if(p===0)break e;w=0;do N=o[a+w++],r.head&&N&&r.length<65536&&(r.head.comment+=String.fromCharCode(N));while(N&&w<p);if(r.flags&512&&r.wrap&4&&(r.check=st(r.check,o,w,a)),p-=w,a+=w,N)break e}else r.head&&(r.head.comment=null);r.mode=Dw;case Dw:if(r.flags&512){for(;f<16;){if(p===0)break e;p--,m+=o[a++]<<f,f+=8}if(r.wrap&4&&m!==(r.check&65535)){e.msg="header crc mismatch",r.mode=Le;break}m=0,f=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=jr;break;case Nw:for(;f<32;){if(p===0)break e;p--,m+=o[a++]<<f,f+=8}e.adler=r.check=$w(m),m=0,f=0,r.mode=zc;case zc:if(r.havedict===0)return e.next_out=c,e.avail_out=d,e.next_in=a,e.avail_in=p,r.hold=m,r.bits=f,SF;e.adler=r.check=1,r.mode=jr;case jr:if(t===yF||t===Lc)break e;case Qp:if(r.last){m>>>=f&7,f-=f&7,r.mode=zp;break}for(;f<3;){if(p===0)break e;p--,m+=o[a++]<<f,f+=8}switch(r.last=m&1,m>>>=1,f-=1,m&3){case 0:r.mode=Bw;break;case 1:if(_F(r),r.mode=Uc,t===Lc){m>>>=2,f-=2;break e}break;case 2:r.mode=Uw;break;case 3:e.msg="invalid block type",r.mode=Le}m>>>=2,f-=2;break;case Bw:for(m>>>=f&7,f-=f&7;f<32;){if(p===0)break e;p--,m+=o[a++]<<f,f+=8}if((m&65535)!==(m>>>16^65535)){e.msg="invalid stored block lengths",r.mode=Le;break}if(r.length=m&65535,m=0,f=0,r.mode=qp,t===Lc)break e;case qp:r.mode=Lw;case Lw:if(w=r.length,w){if(w>p&&(w=p),w>d&&(w=d),w===0)break e;n.set(o.subarray(a,a+w),c),p-=w,a+=w,d-=w,c+=w,r.length-=w;break}r.mode=jr;break;case Uw:for(;f<14;){if(p===0)break e;p--,m+=o[a++]<<f,f+=8}if(r.nlen=(m&31)+257,m>>>=5,f-=5,r.ndist=(m&31)+1,m>>>=5,f-=5,r.ncode=(m&15)+4,m>>>=4,f-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=Le;break}r.have=0,r.mode=Mw;case Mw:for(;r.have<r.ncode;){for(;f<3;){if(p===0)break e;p--,m+=o[a++]<<f,f+=8}r.lens[G[r.have++]]=m&7,m>>>=3,f-=3}for(;r.have<19;)r.lens[G[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,k={bits:r.lenbits},Z=ni(hF,r.lens,0,19,r.lencode,0,r.work,k),r.lenbits=k.bits,Z){e.msg="invalid code lengths set",r.mode=Le;break}r.have=0,r.mode=Ow;case Ow:for(;r.have<r.nlen+r.ndist;){for(;b=r.lencode[m&(1<<r.lenbits)-1],x=b>>>24,E=b>>>16&255,C=b&65535,!(x<=f);){if(p===0)break e;p--,m+=o[a++]<<f,f+=8}if(C<16)m>>>=x,f-=x,r.lens[r.have++]=C;else{if(C===16){for(F=x+2;f<F;){if(p===0)break e;p--,m+=o[a++]<<f,f+=8}if(m>>>=x,f-=x,r.have===0){e.msg="invalid bit length repeat",r.mode=Le;break}N=r.lens[r.have-1],w=3+(m&3),m>>>=2,f-=2}else if(C===17){for(F=x+3;f<F;){if(p===0)break e;p--,m+=o[a++]<<f,f+=8}m>>>=x,f-=x,N=0,w=3+(m&7),m>>>=3,f-=3}else{for(F=x+7;f<F;){if(p===0)break e;p--,m+=o[a++]<<f,f+=8}m>>>=x,f-=x,N=0,w=11+(m&127),m>>>=7,f-=7}if(r.have+w>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=Le;break}for(;w--;)r.lens[r.have++]=N}}if(r.mode===Le)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=Le;break}if(r.lenbits=9,k={bits:r.lenbits},Z=ni(SS,r.lens,0,r.nlen,r.lencode,0,r.work,k),r.lenbits=k.bits,Z){e.msg="invalid literal/lengths set",r.mode=Le;break}if(r.distbits=6,r.distcode=r.distdyn,k={bits:r.distbits},Z=ni(bS,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,k),r.distbits=k.bits,Z){e.msg="invalid distances set",r.mode=Le;break}if(r.mode=Uc,t===Lc)break e;case Uc:r.mode=Mc;case Mc:if(p>=6&&d>=258){e.next_out=c,e.avail_out=d,e.next_in=a,e.avail_in=p,r.hold=m,r.bits=f,lF(e,y),c=e.next_out,n=e.output,d=e.avail_out,a=e.next_in,o=e.input,p=e.avail_in,m=r.hold,f=r.bits,r.mode===jr&&(r.back=-1);break}for(r.back=0;b=r.lencode[m&(1<<r.lenbits)-1],x=b>>>24,E=b>>>16&255,C=b&65535,!(x<=f);){if(p===0)break e;p--,m+=o[a++]<<f,f+=8}if(E&&!(E&240)){for(I=x,B=E,Q=C;b=r.lencode[Q+((m&(1<<I+B)-1)>>I)],x=b>>>24,E=b>>>16&255,C=b&65535,!(I+x<=f);){if(p===0)break e;p--,m+=o[a++]<<f,f+=8}m>>>=I,f-=I,r.back+=I}if(m>>>=x,f-=x,r.back+=x,r.length=C,E===0){r.mode=Kw;break}if(E&32){r.back=-1,r.mode=jr;break}if(E&64){e.msg="invalid literal/length code",r.mode=Le;break}r.extra=E&15,r.mode=Qw;case Qw:if(r.extra){for(F=r.extra;f<F;){if(p===0)break e;p--,m+=o[a++]<<f,f+=8}r.length+=m&(1<<r.extra)-1,m>>>=r.extra,f-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=qw;case qw:for(;b=r.distcode[m&(1<<r.distbits)-1],x=b>>>24,E=b>>>16&255,C=b&65535,!(x<=f);){if(p===0)break e;p--,m+=o[a++]<<f,f+=8}if(!(E&240)){for(I=x,B=E,Q=C;b=r.distcode[Q+((m&(1<<I+B)-1)>>I)],x=b>>>24,E=b>>>16&255,C=b&65535,!(I+x<=f);){if(p===0)break e;p--,m+=o[a++]<<f,f+=8}m>>>=I,f-=I,r.back+=I}if(m>>>=x,f-=x,r.back+=x,E&64){e.msg="invalid distance code",r.mode=Le;break}r.offset=C,r.extra=E&15,r.mode=zw;case zw:if(r.extra){for(F=r.extra;f<F;){if(p===0)break e;p--,m+=o[a++]<<f,f+=8}r.offset+=m&(1<<r.extra)-1,m>>>=r.extra,f-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=Le;break}r.mode=Gw;case Gw:if(d===0)break e;if(w=y-d,r.offset>w){if(w=r.offset-w,w>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=Le;break}w>r.wnext?(w-=r.wnext,S=r.wsize-w):S=r.wnext-w,w>r.length&&(w=r.length),T=r.window}else T=n,S=c-r.offset,w=r.length;w>d&&(w=d),d-=w,r.length-=w;do n[c++]=T[S++];while(--w);r.length===0&&(r.mode=Mc);break;case Kw:if(d===0)break e;n[c++]=r.length,d--,r.mode=Mc;break;case zp:if(r.wrap){for(;f<32;){if(p===0)break e;p--,m|=o[a++]<<f,f+=8}if(y-=d,e.total_out+=y,r.total+=y,r.wrap&4&&y&&(e.adler=r.check=r.flags?st(r.check,n,y,c-y):ui(r.check,n,y,c-y)),y=d,r.wrap&4&&(r.flags?m:$w(m))!==r.check){e.msg="incorrect data check",r.mode=Le;break}m=0,f=0}r.mode=jw;case jw:if(r.wrap&&r.flags){for(;f<32;){if(p===0)break e;p--,m+=o[a++]<<f,f+=8}if(r.wrap&4&&m!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=Le;break}m=0,f=0}r.mode=Vw;case Vw:Z=wF;break e;case Le:Z=TS;break e;case AS:return xS;case ES:default:return Wt}return e.next_out=c,e.avail_out=d,e.next_in=a,e.avail_in=p,r.hold=m,r.bits=f,(r.wsize||y!==e.avail_out&&r.mode<Le&&(r.mode<zp||t!==Ew))&&FS(e,e.output,e.next_out,y-e.avail_out),h-=e.avail_in,y-=e.avail_out,e.total_in+=h,e.total_out+=y,r.total+=y,r.wrap&4&&y&&(e.adler=r.check=r.flags?st(r.check,n,y,e.next_out-y):ui(r.check,n,y,e.next_out-y)),e.data_type=r.bits+(r.last?64:0)+(r.mode===jr?128:0)+(r.mode===Uc||r.mode===qp?256:0),(h===0&&y===0||t===Ew)&&Z===zo&&(Z=bF),Z},"inflate$2"),FF=i(e=>{if(Ko(e))return Wt;let t=e.state;return t.window&&(t.window=null),e.state=null,zo},"inflateEnd"),vF=i((e,t)=>{if(Ko(e))return Wt;let r=e.state;return r.wrap&2?(r.head=t,t.done=!1,zo):Wt},"inflateGetHeader"),PF=i((e,t)=>{let r=t.length,o,n,a;return Ko(e)||(o=e.state,o.wrap!==0&&o.mode!==zc)?Wt:o.mode===zc&&(n=1,n=ui(n,t,r,0),n!==o.check)?TS:(a=FS(e,t,r,r),a?(o.mode=AS,xS):(o.havedict=1,zo))},"inflateSetDictionary"),RF=CS,DF=_S,NF=kS,BF=CF,LF=IS,UF=IF,MF=FF,OF=vF,QF=PF,qF="pako inflate (from Nodeca project)",$r={inflateReset:RF,inflateReset2:DF,inflateResetKeep:NF,inflateInit:BF,inflateInit2:LF,inflate:UF,inflateEnd:MF,inflateGetHeader:OF,inflateSetDictionary:QF,inflateInfo:qF};function zF(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}i(zF,"GZheader");var GF=zF,vS=Object.prototype.toString,{Z_NO_FLUSH:KF,Z_FINISH:jF,Z_OK:di,Z_STREAM_END:jp,Z_NEED_DICT:Vp,Z_STREAM_ERROR:VF,Z_DATA_ERROR:Ww,Z_MEM_ERROR:$F}=Go;function hi(e){this.options=Kc.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});let t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new yS,this.strm.avail_out=0;let r=$r.inflateInit2(this.strm,t.windowBits);if(r!==di)throw new Error(Qo[r]);if(this.header=new GF,$r.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=pi.string2buf(t.dictionary):vS.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=$r.inflateSetDictionary(this.strm,t.dictionary),r!==di)))throw new Error(Qo[r])}i(hi,"Inflate$1");hi.prototype.push=function(e,t){let r=this.strm,o=this.options.chunkSize,n=this.options.dictionary,a,c,p;if(this.ended)return!1;for(t===~~t?c=t:c=t===!0?jF:KF,vS.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(o),r.next_out=0,r.avail_out=o),a=$r.inflate(r,c),a===Vp&&n&&(a=$r.inflateSetDictionary(r,n),a===di?a=$r.inflate(r,c):a===Ww&&(a=Vp));r.avail_in>0&&a===jp&&r.state.wrap>0&&e[r.next_in]!==0;)$r.inflateReset(r),a=$r.inflate(r,c);switch(a){case VF:case Ww:case Vp:case $F:return this.onEnd(a),this.ended=!0,!1}if(p=r.avail_out,r.next_out&&(r.avail_out===0||a===jp))if(this.options.to==="string"){let d=pi.utf8border(r.output,r.next_out),m=r.next_out-d,f=pi.buf2string(r.output,d);r.next_out=m,r.avail_out=o-m,m&&r.output.set(r.output.subarray(d,d+m),0),this.onData(f)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(a===di&&p===0)){if(a===jp)return a=$r.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};hi.prototype.onData=function(e){this.chunks.push(e)};hi.prototype.onEnd=function(e){e===di&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Kc.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function cd(e,t){let r=new hi(t);if(r.push(e),r.err)throw r.msg||Qo[r.err];return r.result}i(cd,"inflate$1");function HF(e,t){return t=t||{},t.raw=!0,cd(e,t)}i(HF,"inflateRaw$1");var WF=hi,ZF=cd,YF=HF,XF=cd,JF=Go,ev={Inflate:WF,inflate:ZF,inflateRaw:YF,ungzip:XF,constants:JF},{Deflate:tv,deflate:rv,deflateRaw:ov,gzip:nv}=cF,{Inflate:sv,inflate:iv,inflateRaw:av,ungzip:cv}=ev,uv=tv,lv=rv,pv=ov,dv=nv,mv=sv,fv=iv,gv=av,hv=cv,yv=Go,ud={Deflate:uv,deflate:lv,deflateRaw:pv,gzip:dv,Inflate:mv,inflate:fv,inflateRaw:gv,ungzip:hv,constants:yv};u();l();var Vc=class{static{i(this,"StreamedQuoteQueue")}maxSize=5;items=[];enqueue(t,r,o){let n=this.processQuoteResponse(t,r,o?.join(","));this.items.push(n),this.items.length>this.maxSize&&this.items.shift()}getItems(){return[...this.items]}size(){return this.items.length}clear(){this.items=[]}processQuoteResponse(t,r,o){return{quotes:t.quotes.map(a=>({amountIn:a.sellAmount,amountOut:a.buyAmount,tokenIn:M(t.sellToken),tokenOut:M(t.buyToken),provider:a.baseProvider.name})),timestamp:Date.now(),selectedProvider:r,alerts:o}}};var wv="Sq+",ld=class{static{i(this,"StreamedQuoteLogger")}queue=new Vc;addQuoteResponse(t,r,o){this.queue.enqueue(t,r,o)}reset(){this.queue.clear()}getQuotes(){return this.queue.getItems()}logState(t){let r=this.getStateData(t);R.addBreadcrumb(U.Generic,`${wv}${r}`,Y.Info)}processQuoteProcessorState(t){switch(t.type){case"starting":this.reset();break;case"quoteProcessed":this.addQuoteResponse(t.response,t.input.preferredProvider,[...t.quoteDetails.alerts,...t.quoteDetails.warnings].map(r=>r.toString()));break;default:break}}getStateData(t){let r=this.queue.getItems(),o=this.compactData(r,t),n=ud.gzip(JSON.stringify(o));return Buffer.from(n).toString("base64")}compactData(t,r){return t.length===0?null:{items:t.map(o=>({q:o.quotes.map(n=>({i:n.amountIn,o:n.amountOut,p:n.provider,ti:n.tokenIn,to:n.tokenOut})),t:o.timestamp,sp:o.selectedProvider,a:o.alerts})),th:r}}expandData(t){return t.items.map(r=>({quotes:r.q.map(o=>({amountIn:o.i,amountOut:o.o,tokenIn:o.ti,tokenOut:o.to,provider:o.p})),timestamp:r.t,selectedProvider:r.sp,alerts:r.a}))}decode(t){try{let r=Buffer.from(t,"base64"),o=ud.inflate(r,{to:"string"}),n=JSON.parse(o);return n?{items:this.expandData(n),txnHash:n.th}:{items:[]}}catch(r){return console.error("Failed to decode compressed data:",r),{items:[]}}}},bo=new ld;u();l();u();l();var W;(function(e){e.AccountFrozen="AccountFrozen",e.NoCurrentQuoteError="Trying to execute swap with no current quote",e.NoQuoteResponseError="Trying to execute swap with no quote response",e.NoGasEstimation="No gas estimation available",e.NoSwapTransactions="No swap transactions available",e.InsufficientFunds="INSUFFICIENT_FUNDS",e.InsufficientGas="INSUFFICIENT_GAS",e.SlippageExceeded="slippageToleranceExceeded",e.SimulationTimeout="SIMULATION_TIMEOUT",e.NotValidScanResultsError="Scan results are not valid",e.StaleQuote="STALE_QUOTE",e.NotEnoughSol="NotEnoughSol",e.TransactionConfirmationFailed="Transaction confirmation failed",e.SimulationUnknownError="SimulationUnknownError",e.UnknownError="UnknownError",e.MissingArgument="MissingArgument",e.EmptyRoute="EmptyRoute",e.InvalidCalculation="InvalidCalculation",e.MissingPlatformFeeAccount="MissingPlatformFeeAccount",e.InvalidSlippage="InvalidSlippage",e.NotEnoughPercent="NotEnoughPercent",e.InvalidInputIndex="InvalidInputIndex",e.InvalidOutputIndex="InvalidOutputIndex",e.NotEnoughAccountKeys="NotEnoughAccountKeys",e.NonZeroMinimumOutAmountNotSupported="NonZeroMinimumOutAmountNotSupported",e.InvalidRoutePlan="InvalidRoutePlan",e.InvalidReferralAuthority="InvalidReferralAuthority",e.LedgerTokenAccountDoesNotMatch="LedgerTokenAccountDoesNotMatch",e.InvalidTokenLedger="InvalidTokenLedger",e.IncorrectTokenProgramID="IncorrectTokenProgramID",e.TokenProgramNotProvided="TokenProgramNotProvided",e.SwapNotSupported="SwapNotSupported",e.ExactOutAmountNotMatched="ExactOutAmountNotMatched",e.SourceAndDstinationMintCannotBeTheSame="SourceAndDstinationMintCannotBeTheSame",e.LedgerConnectionError="LedgerConnectionError",e.LedgerRejectAction="LedgerRejectAction",e.LedgerUnknownSignError="LedgerUnknownSignError",e.LedgerUnknownError="LedgerUnknownError"})(W||(W={}));var Xe=class extends Error{static{i(this,"SwapperError")}code;detailMessage;constructor(t,r){super(t),this.code=t,this.detailMessage=r}};var Sv=W.SlippageExceeded,bv=W.InsufficientFunds,Tv=Vf,xv="insufficient lamports",Av="lower balance than rent-exempt minimum",Ev=jf,kv="Transaction confirmation failed",Cv=["Ledger App not open","Ledger not connected","Unable to connect to Ledger","Unable to connect to Ledger device","Need permission to connect to Ledger"],_v="Ledger user rejected action",Iv="Ledger Sign Error";function Fv(e){try{return Number(e.split('"Custom":')[1].split("}")[0])}catch{return null}}i(Fv,"parseProgramErrorCode");function vv(e){switch(Fv(e.message)){case 301:return W.SlippageExceeded;case 6e3:return W.EmptyRoute;case 6001:return W.SlippageExceeded;case 6002:return W.InvalidCalculation;case 6003:return W.MissingPlatformFeeAccount;case 6004:return W.InvalidSlippage;case 6005:return W.NotEnoughPercent;case 6006:return W.InvalidInputIndex;case 6007:return W.InvalidOutputIndex;case 6008:return W.NotEnoughAccountKeys;case 6009:return W.NonZeroMinimumOutAmountNotSupported;case 6010:return W.InvalidRoutePlan;case 6011:return W.InvalidReferralAuthority;case 6012:return W.LedgerTokenAccountDoesNotMatch;case 6013:return W.InvalidTokenLedger;case 6014:return W.IncorrectTokenProgramID;case 6015:return W.TokenProgramNotProvided;case 6016:return W.SwapNotSupported;case 6017:return W.ExactOutAmountNotMatched;case 6018:return W.SourceAndDstinationMintCannotBeTheSame;default:return null}}i(vv,"parseProgramError");function Pv(e){return Cv.some(r=>e.message.includes(r))?W.LedgerConnectionError:e.message.includes(_v)?W.LedgerRejectAction:e.message.includes(Iv)?W.LedgerUnknownSignError:e.message.toLowerCase().includes("ledger")?W.LedgerUnknownError:null}i(Pv,"parseLedgerError");function $c(e){if(e===void 0)return new Xe(W.UnknownError,"No error provided");if(e instanceof Xe)return e;let t=Rv(e);if(t.message.includes(bv))return new Xe(W.InsufficientFunds);if(Dv(t.message))return new Xe(W.SlippageExceeded);if(t.message===W.NotValidScanResultsError)return new Xe(W.NotValidScanResultsError);if([Tv,xv,Ev,Av].some(d=>t.message.includes(d)))return new Xe(W.NotEnoughSol);let a=vv(t);if(a!==null)return new Xe(a);if(t.message.includes(kv))return new Xe(W.TransactionConfirmationFailed);let p=Pv(t);return p!==null?new Xe(p):new Xe(W.UnknownError,t.message)}i($c,"parseSwapError");function Rv(e){return typeof e=="string"?new Error(e):typeof e=="object"&&"logs"in e&&e.logs?.length?new Error(e.logs.join(`
`)):e}i(Rv,"normalizeError");function Dv(e){return e.includes(Sv)}i(Dv,"errorMessageFailsFromSlippage");u();l();u();l();var PS=3;function Hc(){try{let e=Vt.getMultivariateAssignment("swapper-high-slippage-threshold"),t=Number(e);return!e||isNaN(t)?PS:t}catch{return PS}}i(Hc,"getHighSlippageThreshold");var RS=i(({currentQuote:e,quoteResponse:t,gasEstimation:r,swapTransactions:o,scanResults:n,isSwapSimulationDisabled:a,slippageTolerance:c})=>{if(!e)throw new Xe(W.NoCurrentQuoteError);if(!t)throw new Xe(W.NoQuoteResponseError);if(A.isEVMNetworkID(t.sellToken.chainId)&&(!r||r?.length===0||r?.length<(o?.transactions.length??1)))throw new Xe(W.NoGasEstimation);if(!o)throw new Xe(W.NoSwapTransactions);if(n.state!=="valid"&&(R.addBreadcrumb(U.Swapper,"swapSimulationNotValid",Y.Info,un({scanResults:n.state})),!a)){let d=[W.NotValidScanResultsError,W.AccountFrozen,W.InsufficientFunds,W.InsufficientGas,W.SlippageExceeded,W.SimulationTimeout,W.MissingArgument,W.StaleQuote,W.SimulationUnknownError];if(Bv(n.state)&&d.includes(n.state.code)){if(Nv(n.state,c))return;throw n.state}else throw new Xe(W.NotValidScanResultsError)}},"validateSwap");function Nv(e,t){return e.code===W.SlippageExceeded&&t&&t>=Hc()}i(Nv,"shouldSuppressError");function Bv(e){return e instanceof Xe}i(Bv,"isSwapperError");var Lv={swap:{solana:"executeSolanaSwap",evm:"executeEvmSwap",sui:"executeSuiSwap",bitcoin:"executeBitcoinSwap"},bridge:{solana:"executeSolanaBridge",evm:"executeEvmBridge",sui:"executeSuiBridge",bitcoin:"executeBitcoinBridge"}},pd=i((e,t)=>Lv[e?"bridge":"swap"][t??"solana"],"getExecuteSwapSpanName"),SH=i(async({isBridge:e,addressType:t,isSwapSimulationDisabled:r,sender:o,currentQuote:n,quoteResponse:a,gasEstimation:c,swapTransactions:p,scanResults:d,pendingActivityRows:m,connection:f,logSwapFailureNoSignature:h,logTransactionSubmitted:y,onTransactionReceiptReceived:w,onTransactionSubmissionError:S,resetToInitialState:T,slippageTolerance:b,swapFungibles:x})=>{await R.startSpan(pd(e,p?.type),async()=>{T();let E;try{RS({currentQuote:n,quoteResponse:a,gasEstimation:c,swapTransactions:p,scanResults:d,isSwapSimulationDisabled:r,slippageTolerance:b});let C=await x({type:t,callerAddress:o,swapTransactions:p,pendingSwapActivityRows:m.pendingSwapActivityRows,pendingApprovalActivityRows:m.pendingApprovalActivityRows,gasEstimation:c,connection:f});if(w(C),C.error)throw C.id||h(),E=C.id,C.error;y(C),bo.logState(C.id)}catch(C){let I=$c(C);S(I,E)}})},"executeSwap");u();l();var ct;(function(e){e.SetPair="setPair",e.QuoteRequestStarted="quoteRequestStarted",e.QuoteResponseReceived="quoteResponseReceived",e.QuoteResponseStreamed="quoteResponseStreamed",e.QuoteRequestError="quoteRequestError",e.UserSelectedQuote="userSelectedQuote"})(ct||(ct={}));u();l();u();l();var Te;(function(e){e.SlippageExceeded="SLIPPAGE_EXCEEDED",e.InsufficientFunds="INSUFFICIENT_FUNDS",e.InsufficientGas="INSUFFICIENT_GAS",e.AccountFrozen="ACCOUNT_FROZEN",e.SimulationTimeout="SIMULATION_TIMEOUT",e.StaleQuote="STALE_QUOTE",e.UnknownError="UNKNOWN_ERROR",e.SimulationFailed="SIMULATION_FAILED"})(Te||(Te={}));var jn=class e extends Error{static{i(this,"SimulationError")}scannedTransactionResult;type;detailMessage;constructor(t,r,o){super(t),this.scannedTransactionResult=r,this.type=o,r&&(this.detailMessage=r.simulationError?.humanReadableError??(r.warnings.length>0?r.warnings[0].message:void 0)),this.type=o}static fromError(t){return t instanceof e?t:new e(t.message)}static fromScannedTransactionResult(t,r){return i(n=>Object.values(Te).includes(n),"isSimulationErrorType")(t)?new e(t,r,t):new e(t,r)}};u();l();var Vn=class e extends Error{static{i(this,"SubmissionError")}type;constructor(t,r){super(t),this.type=r}static fromError(t){return new e(t.message)}static fromType(t){return new e(t,t)}};var DS="https://phantom.com",Wc=class{static{i(this,"EventfulSwapCommand")}swapCommand;send;executingQuote;takerAddress;networkId;quote;executionId;constructor(t,r,o){this.swapCommand=t,this.send=r,this.executingQuote=o,this.takerAddress=t.takerAddress,this.networkId=t.networkId,this.quote=t.quote,this.executionId=t.executionId}createTransaction(){return this.send({type:V.ExecuteSwapStarted,executionId:this.executionId,executingQuote:this.executingQuote}),this.swapCommand.createTransaction()}async fetchSimulation(t){let{transactions:r,deviceId:o,isSimulationKilled:n}=t,a=Sr(v.language)??"en";if(A.isSuiNetworkID(this.networkId))return{type:"transaction",expectedChanges:[],warnings:[],advancedDetails:void 0,error:void 0,simulationError:void 0,block:void 0};if(A.isBitcoinNetworkID(this.networkId))return{type:"transaction",expectedChanges:[],warnings:[],advancedDetails:void 0,error:void 0,simulationError:void 0,block:void 0};let c=await Nn({transactions:r,locale:a,url:DS,deviceId:o,takerAddress:this.takerAddress,networkId:this.networkId,slippageType:this.executingQuote.slippageType,quote:this.quote,quoteResponse:this.executingQuote.response,isSimulationKilled:n});return c.status==="success"?c.result:null}async simulate(t,r,o,n){try{this.send({type:V.SimulationRequestStarted,executionId:this.executionId,executingQuote:this.executingQuote,networkId:this.networkId});let a=await this.fetchSimulation({transactions:t,deviceId:o,isSimulationKilled:n});if(!a)return this.send({type:V.SimulationSkipped,executionId:this.executionId,networkId:this.networkId}),null;switch(a.error){case void 0:break;case Te.SimulationFailed:break;case Te.SlippageExceeded:if(this.executingQuote.response.slippageTolerance>=Hc())break;default:throw jn.fromScannedTransactionResult(a.error,a)}return this.send({type:V.SimulationPassed,scannedTransactionResult:a,executionId:this.executionId,networkId:this.networkId}),a}catch(a){throw this.send({type:V.SimulationFailed,error:jn.fromError(a),executionId:this.executionId,networkId:this.networkId,url:DS}),a}}async swap(t,r,o,n,a){this.send({type:V.TransactionSubmissionStarted,executionId:this.executionId});try{let c=await this.swapCommand.swap(t,r,o,n,a);if(!c.id)throw Vn.fromType("noSignature");return this.send({type:V.TransactionSubmissionSuccess,txReceipt:c,executionId:this.executionId}),c}catch(c){let p=c instanceof Vn?c:Vn.fromError(c);throw this.send({type:V.TransactionSubmissionFailed,error:p,executionId:this.executionId}),p}}async waitForConfirmation(t){this.send({type:V.TransactionConfirmationStarted,executionId:this.executionId,txReceipt:t});try{let r=await this.swapCommand.waitForConfirmation(t);return this.send({type:V.TransactionConfirmed,executionId:this.executionId,txReceipt:t}),r}catch(r){throw this.send({type:V.TransactionConfirmationFailed,error:r,txReceipt:t,executionId:this.executionId}),r}}};u();l();var Zc=class extends Error{static{i(this,"ExecuteSwapIllegalTransitionError")}constructor(t,r){let n=(Array.isArray(r)?r:[r]).join(", ");super(`Can't transition to ${n} from ${t.type}`)}},Yc=class{static{i(this,"ExecuteSwapStateMachine")}state=new Map;listeners=new Set;send(t){t.type===V.ExecuteSwapStarted&&this.state.set(t.executionId,{type:be.Idle,executingQuote:t.executingQuote});let r=this.state.get(t.executionId);if(!r)throw new Error(`No previous state found for execution id: ${t.executionId}`);let o=r;try{return o=this.detectNextState(r,t),o.type===be.TransactionConfirmed?this.state.delete(t.executionId):this.state.set(t.executionId,o),o}catch{return r}finally{this.notifyListeners(t,r,o,this.state)}}notifyListeners(t,r,o,n){this.listeners.forEach(a=>{try{a.onStateChange(t,r,o,n)}catch(c){console.error("Error notifying ExecuteSwapStateListener:",c)}})}getState(){return this.state}addListener(t){this.listeners.add(t)}removeListener(t){this.listeners.delete(t)}detectNextState(t,r){switch(r.type){case V.ExecuteSwapStarted:return Fr(t,be.Idle),{type:be.Started,executingQuote:r.executingQuote};case V.SimulationRequestStarted:return Fr(t,be.Started),{type:be.Simulating,executingQuote:t.executingQuote};case V.SimulationPassed:return Fr(t,be.Simulating),{type:be.Simulated,scannedTransactionResult:r.scannedTransactionResult,executingQuote:t.executingQuote};case V.SimulationFailed:return Fr(t,be.Simulating),{type:be.SimulationFailed,error:r.error,executingQuote:t.executingQuote};case V.SimulationSkipped:return Fr(t,be.Simulating),{type:be.SimulationSkipped,executingQuote:t.executingQuote};case V.TransactionSubmissionStarted:return Uv(t,[be.Simulated,be.SimulationSkipped]),{type:be.SubmittingTransaction,executingQuote:t.executingQuote,scannedTransactionResult:t.type===be.Simulated?t.scannedTransactionResult:void 0};case V.TransactionSubmissionFailed:return Fr(t,be.SubmittingTransaction),{type:be.TransactionSubmissionFailed,error:r.error,executingQuote:t.executingQuote,scannedTransactionResult:t.scannedTransactionResult};case V.TransactionSubmissionSuccess:return Fr(t,be.SubmittingTransaction),{type:be.TransactionSubmitted,txReceipt:r.txReceipt,executingQuote:t.executingQuote,scannedTransactionResult:t.scannedTransactionResult};case V.TransactionConfirmationStarted:return Fr(t,be.TransactionSubmitted),{type:be.ConfirmingTransaction,txReceipt:t.txReceipt,scannedTransactionResult:t.scannedTransactionResult,executingQuote:t.executingQuote};case V.TransactionConfirmationFailed:return Fr(t,be.TransactionSubmitted),{type:be.TransactionNotConfirmed,txReceipt:t.txReceipt,scannedTransactionResult:t.scannedTransactionResult,error:r.error,executingQuote:t.executingQuote};case V.TransactionConfirmed:return Fr(t,be.ConfirmingTransaction),{type:be.TransactionConfirmed,txReceipt:t.txReceipt,scannedTransactionResult:t.scannedTransactionResult,executingQuote:t.executingQuote}}}};function Fr(e,t){if(e.type!==t)throw new Zc(e,t)}i(Fr,"checkState");function Uv(e,t){if(!t.includes(e.type))throw new Zc(e,t)}i(Uv,"checkStateAny");u();l();var Ue;(function(e){e.Idle="idle",e.Pair="pair",e.FetchingQuote="fetchingQuote",e.QuoteError="quoteError",e.Quote="quote",e.ExecutingSwap="executingSwap",e.SwapConfirmed="swapConfirmed"})(Ue||(Ue={}));function NS(e){return e.type===Ue.Quote}i(NS,"isExecutableSwapState");u();l();u();l();var Mv={"Could not find any routes":"noRoute"},Xc=class e extends Error{static{i(this,"QuoteError")}type;constructor(t,r){super(r??t),this.type=t}static fromMessage(t){let r=t?Mv[t]??"undefinedError":"undefinedError";return new e(r,t)}};var jo=class extends Error{static{i(this,"SwapperIllegalTransitionError")}constructor(t,r){super(`Can't transition to ${r} from ${t.type}`)}},Jc=class{static{i(this,"SwapperStateMachine")}state;listeners=new Set;constructor(t){this.state=t??{type:Ue.Idle}}send(t){let r=this.state;try{return r=this.detectNextState(this.state,t),this.state=r,r}catch{return this.state}finally{this.notifyListeners(t,this.state,r)}}getState(){return this.state}addListener(t){this.listeners.add(t)}removeListener(t){this.listeners.delete(t)}notifyListeners(t,r,o){try{this.listeners.forEach(n=>n.onStateChange(t,r,o))}catch{}}detectNextState(t,r){switch(r.type){case ct.SetPair:return{type:Ue.Pair,buy:r.buy,sell:r.sell,amount:r.amount};case ct.QuoteRequestStarted:switch(t.type){case Ue.Pair:case Ue.Quote:case Ue.QuoteError:return{type:Ue.FetchingQuote,buy:t.buy,sell:t.sell,amount:r.amount,slippageType:r.slippageType};default:throw new jo(t,r.type)}case ct.QuoteRequestError:if(t.type!==Ue.FetchingQuote)throw new jo(t,r.type);return{type:Ue.QuoteError,buy:t.buy,sell:t.sell,amount:t.amount,error:r.error,slippageType:t.slippageType};case ct.QuoteResponseReceived:if(t.type!==Ue.FetchingQuote)throw new jo(t,r.type);let o=r.response.quotes[0];return o?{type:Ue.Quote,response:r.response,buy:t.buy,sell:t.sell,quote:o,amount:t.amount,slippageType:t.slippageType}:{type:Ue.QuoteError,buy:t.buy,sell:t.sell,amount:t.amount,error:new Xc("noRoute"),slippageType:t.slippageType};case ct.QuoteResponseStreamed:switch(t.type){case Ue.Pair:case Ue.FetchingQuote:case Ue.Quote:case Ue.QuoteError:return{type:Ue.Quote,response:r.response,buy:t.buy,sell:t.sell,quote:r.quote,amount:{amount:r.quoteInput.amount,perspective:r.quoteInput.exactOut?"buy":"sell"},slippageType:r.quoteInput.autoSlippage?ce.Auto:ce.Fixed,input:r.quoteInput};default:throw new jo(t,r.type)}case ct.UserSelectedQuote:if(t.type!==Ue.Quote)throw new jo(t,r.type);return{type:Ue.Quote,quote:r.quote,buy:t.buy,sell:t.sell,response:t.response,amount:t.amount,slippageType:t.slippageType}}}};u();l();u();l();var BS=s.object({buyToken:s.custom(),sellToken:s.custom(),buyTokenPrice:s.custom().optional(),sellTokenPrice:s.custom().optional(),maxSellAmount:s.string().optional(),isPrediction:s.boolean().optional()}),yi=class e extends Error{static{i(this,"SwapInitializationError")}type;constructor(t,r){super(r??t.name),this.type=t}static fromError(t){return new e({name:"unknown"},t.message)}};function dd(e,t){if(e.type!==t.type)return!1;switch(e.type){case"buy":return t.type!=="buy"?!1:e.buyCaip19===t.buyCaip19&&e.sellCaip19===t.sellCaip19&&e.takerCaip19===t.takerCaip19&&e.takerDestinationCaip19===t.takerDestinationCaip19&&e.options===t.options&&e.buyFungibleKey===t.buyFungibleKey;case"sell":return t.type!=="sell"?!1:e.sellCaip19===t.sellCaip19&&e.buyCaip19===t.buyCaip19&&e.takerCaip19===t.takerCaip19&&e.takerDestinationCaip19===t.takerDestinationCaip19&&e.options===t.options&&e.sellFungibleKey===t.sellFungibleKey;case"swap":return t.type!=="swap"?!1:e.network===t.network&&e.sellCaip19===t.sellCaip19&&e.buyCaip19===t.buyCaip19&&e.takerCaip19===t.takerCaip19&&e.takerDestinationCaip19===t.takerDestinationCaip19&&e.options===t.options;case"prediction":{if(t.type!=="prediction"||e.mode.direction!==t.mode.direction||e.outcomeType!==t.outcomeType||e.network!==t.network||e.takerCaip19!==t.takerCaip19||e.takerDestinationCaip19!==t.takerDestinationCaip19||e.options!==t.options)return!1;if(e.mode.direction==="buy"){if(t.mode.direction!=="buy"||e.mode.sellCaip19!==t.mode.sellCaip19)return!1}else if(t.mode.direction!=="sell"||e.mode.sellMintAddress!==t.mode.sellMintAddress)return!1;return e.mintAccounts===t.mintAccounts}default:{let r=e;return!1}}}i(dd,"isSwapModeEqual");var $n=class{static{i(this,"BackendSwapInitializer")}async initialize(t,r,o,n){let a=r.reduce((d,m)=>(d[m.networkID]=m.address,d),{}),c=await K.api().headers({"Content-Type":"application/json"}).timeout(z({seconds:20})).post("/swap/v2/initialize",{...t,addresses:a,cashAddresses:sr?o:void 0,...n?{settings:n}:{}});if(c.status!==200)throw new je({key:"SwapInitializationFailed"});let p=BS.safeParse(c.data);if(!p.success)throw new je({key:"SwapInitializationFailed"});return{...p.data,takerCaip19:this.takerCaip19ForToken({token:p.data.sellToken,addresses:r}),takerDestinationCaip19:this.takerCaip19ForToken({token:p.data.buyToken,addresses:r})}}takerCaip19ForToken({token:t,addresses:r}){if(t.data.walletAddress&&fa(t))return M({chainId:t.data.chain.id,resourceType:J.address,address:t.data.walletAddress});let o=this.findChainAddress({chain:t.data.chain,addresses:r});return M({chainId:o.networkID,resourceType:J.address,address:o.address})}findChainAddress({chain:t,addresses:r}){let{id:o}=t,n=r.find(c=>c.networkID===o);if(!n)throw new Error(`No address found for chain ${o}`);let a={...n};return gr(a)&&(a.address=a.address.toLowerCase()),a}};u();l();var Hn=class{static{i(this,"BitcoinSwapInitializer")}proxyInitializer;constructor(t){this.proxyInitializer=t}async initialize(t,r,o,n){let a=this.getBitcoinAddressTypeForKey(t);if(!a)return this.proxyInitializer.initialize(t,r,o,n);let{key:c,addressType:p,direction:d}=a,m=Ov(r,y=>{if(!(pf(y)&&y.addressType!==p))return y}),f=r.find(y=>y.addressType===p);if(!f)return this.proxyInitializer.initialize(t,r,o,n);switch(d){case"buy":t.takerDestinationCaip19=M({chainId:f.networkID,resourceType:J.address,address:f.address});break;case"sell":t.takerCaip19=M({chainId:f.networkID,resourceType:J.address,address:f.address});break}let h=await this.proxyInitializer.initialize(t,m,o,n);switch(d){case"buy":h.buyToken.data.key=c;break;case"sell":h.sellToken.data.key=c;break}switch(d){case"buy":h.takerCaip19=this.takerCaip19ForToken({token:h.sellToken,addresses:m});break;case"sell":h.takerDestinationCaip19=this.takerCaip19ForToken({token:h.buyToken,addresses:m});break}return h}keyToAddressType={"BitcoinNative-bip122_p2wpkh":ye.BitcoinNativeSegwit,"BitcoinNative-bip122_p2tr":ye.BitcoinTaproot,BitcoinNative:ye.BitcoinTaproot};getBitcoinAddressTypeForKey(t){if(!(t.type!=="buy"&&t.type!=="sell"&&t.type!=="swap")){if(t.sellFungibleKey){let r=this.keyToAddressType[t.sellFungibleKey];if(r)return{key:t.sellFungibleKey,addressType:r,direction:"sell"}}if(t.buyFungibleKey){let r=this.keyToAddressType[t.buyFungibleKey];if(r)return{key:t.buyFungibleKey,addressType:r,direction:"buy"}}}}takerCaip19ForToken({token:t,addresses:r}){if(t.data.walletAddress)return M({chainId:t.data.chain.id,resourceType:J.address,address:t.data.walletAddress});let o=this.findChainAddress({chain:t.data.chain,addresses:r});return M({chainId:o.networkID,resourceType:J.address,address:o.address})}findChainAddress({chain:t,addresses:r}){let{id:o}=t,n=r.find(c=>c.networkID===o);if(!n)throw new Error(`No address found for chain ${o}`);let a={...n};return gr(a)&&(a.address=a.address.toLowerCase()),a}};function Ov(e,t){return e.reduce((r,o)=>{let n=t(o);return n!=null&&r.push(n),r},[])}i(Ov,"compactMap");u();l();function LS(e){if(e.type!=="pair")return;let{mode:t,buyToken:r,sellToken:o}=e;if(t.type!=="swap")throw new Error("Can't switch swap mode for: "+t.type);let n=M(te(e.buyToken)),a=M(te(e.sellToken)),c=e.takerDestinationCaip19,p=e.takerCaip19,d=r.data.key,m=o.data.key;return{type:"swap",network:n?et(n).chainId:A.solana.mainnetID,sellCaip19:n,buyCaip19:a,takerCaip19:c,takerDestinationCaip19:p,sellFungibleKey:d,buyFungibleKey:m}}i(LS,"switchSwapMode");u();l();u();l();u();l();u();l();u();l();u();l();var md={id:A.solana.mainnetID,imageUrl:A.solana.iconUrl,name:A.solana.name,symbol:A.solana.tokenSymbol},US={type:oe.SolanaNative,data:{amount:"0",balance:new L(0),chain:md,decimals:9,key:"SolanaNative",logoUri:"https://cdn.jsdelivr.net/gh/solana-labs/token-list@main/assets/mainnet/So11111111111111111111111111111111111111112/logo.png",name:"Solana",symbol:"SOL",tokenAddress:void 0,walletAddress:"",spamStatus:ae.Verified}},MS={type:oe.SPL,data:{amount:"0",balance:new L(0),chain:md,decimals:6,key:"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",logoUri:"https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v/logo.png",mintAddress:"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",name:"USD Coin",splTokenAccountPubkey:"EAF7dH8Jy43Xgp68PhyybKhfKxk46NFRkWN4PMCLqMfS",symbol:"USDC",tokenAddress:"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",walletAddress:"",programId:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA",spamStatus:ae.Verified}},$4={type:oe.SPL,data:{amount:"0",balance:new L(0),chain:md,decimals:6,key:"cash-account",logoUri:"https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v/logo.png",mintAddress:"CASHx9KJUStyftLFWGvEVf59SGeG9sh5FfcnZMVPCASH",name:"Cash",splTokenAccountPubkey:"8mK7wXFmkUYZnXmKWyKvP3jN9vQxT4R2pLsD6aGcHqYz",symbol:"CASH",tokenAddress:"CASHx9KJUStyftLFWGvEVf59SGeG9sh5FfcnZMVPCASH",walletAddress:"9vKHN2wXQPzJ4mR5sYtL3bUfD6eWcX7aGpMqS8hV4nTz",programId:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA",spamStatus:ae.Verified}},OS={type:oe.SuiNative,data:{chain:{id:A.sui.mainnetID,name:A.sui.name,symbol:A.sui.tokenSymbol,imageUrl:A.sui.iconUrl},walletAddress:"",decimals:18,amount:"0",logoUri:"https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/sui/info/logo.png",name:"Sui",symbol:"SUI",balance:new L(0),key:"SuiNative",usd:85.14215868842653,price:1858.01,usd_24h_change:.0009391170983548136,tokenAddress:void 0,spamStatus:ae.Verified}},QS={type:oe.SuiCoin,data:{chain:{id:A.sui.mainnetID,name:A.sui.name,symbol:A.sui.tokenSymbol,imageUrl:A.sui.iconUrl},walletAddress:"",contractAddress:"0xdba34672e30cb065b1f93e3ab55318768fd6fef66c15942c9f7cb846e2f900e7::usdc::USDC",decimals:6,amount:"0",logoUri:"https://assets.coingecko.com/coins/images/6319/large/USD_Coin_icon.png?1547042389",name:"USD Coin",symbol:"USDC",balance:new L(0),key:"0xdba34672e30cb065b1f93e3ab55318768fd6fef66c15942c9f7cb846e2f900e7::usdc::USDC",tokenAddress:"0xdba34672e30cb065b1f93e3ab55318768fd6fef66c15942c9f7cb846e2f900e7::usdc::USDC",usd:1.8807026139560001,price:.999793,usd_24h_change:-.0005475429199477411,spamStatus:ae.Verified}},qS={type:oe.PolygonNative,data:{chain:{id:A.polygon.mainnetID,name:A.polygon.name,symbol:A.polygon.tokenSymbol,imageUrl:A.polygon.iconUrl},walletAddress:"",decimals:18,amount:"72172806352057410682",logoUri:"https://wallet-asset.matic.network/img/tokens/matic.svg",name:"Polygon",symbol:A.polygon.tokenSymbol,balance:new L(0),key:"PolygonNative",usd:79.02922295550286,price:1.095,usd_24h_change:-.19903579005681138,tokenAddress:void 0,spamStatus:ae.Verified}},zS={type:oe.BaseNative,data:{chain:{id:A.base.mainnetID,name:A.base.name,symbol:A.base.tokenSymbol,imageUrl:A.base.iconUrl},walletAddress:"",decimals:18,amount:"72172806352057410682",logoUri:"https://cdn.jsdelivr.net/gh/trustwallet/assets@master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",name:"Base",symbol:A.base.tokenSymbol,balance:new L(0),key:"BaseNative",usd:79.02922295550286,price:1.095,usd_24h_change:-.19903579005681138,tokenAddress:void 0,spamStatus:ae.Verified}},GS={type:oe.ArbitrumNative,data:{chain:{id:A.arbitrum.mainnetID,name:A.arbitrum.name,symbol:A.arbitrum.tokenSymbol,imageUrl:A.arbitrum.iconUrl},walletAddress:"",decimals:18,amount:"72172806352057410682",logoUri:"https://cdn.jsdelivr.net/gh/trustwallet/assets@master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",name:"Ethereum",symbol:"ETH",balance:new L(0),key:"ArbitrumNative",usd:79.02922295550286,price:1.095,usd_24h_change:-.19903579005681138,tokenAddress:void 0,spamStatus:ae.Verified}},KS={type:oe.MonadNative,data:{chain:{id:A.monad.mainnetID,name:A.monad.name,symbol:A.monad.tokenSymbol,imageUrl:A.monad.iconUrl},walletAddress:"",decimals:18,amount:"0",logoUri:"https://static.phantom.app/assets/monad.png",name:"Monad",symbol:A.monad.tokenSymbol,balance:new L(0),key:"MonadNative",usd:0,price:0,usd_24h_change:0,tokenAddress:void 0,spamStatus:ae.Verified}},jS={type:oe.ERC20,data:{amount:"0",balance:new L(0),decimals:6,key:"0x3c499c542cef5e3811e1192ce70d8cc03d5c3359",logoUri:"https://wallet-asset.matic.network/img/tokens/usdc.svg",name:"USD Coin",symbol:"USDC",tokenAddress:"0x3c499c542cef5e3811e1192ce70d8cc03d5c3359",walletAddress:"",chain:{id:A.polygon.mainnetID,imageUrl:A.polygon.iconUrl,name:A.polygon.name,symbol:A.polygon.tokenSymbol},contractAddress:"0x3c499c542cef5e3811e1192ce70d8cc03d5c3359",spamStatus:ae.Verified}},VS={type:oe.ERC20,data:{amount:"0",balance:new L(0),decimals:6,key:"0x833589fcd6edb6e08f4c7c32d4f71b54bda02913",logoUri:"https://wallet-asset.matic.network/img/tokens/usdc.svg",name:"USD Coin",symbol:"USDC",tokenAddress:"0x833589fcd6edb6e08f4c7c32d4f71b54bda02913",walletAddress:"",chain:{id:A.base.mainnetID,imageUrl:A.base.iconUrl,name:A.base.name,symbol:A.base.tokenSymbol},contractAddress:"0x833589fcd6edb6e08f4c7c32d4f71b54bda02913",spamStatus:ae.Verified}},$S={type:oe.ERC20,data:{amount:"0",balance:new L(0),decimals:6,key:"0xaf88d065e77c8cC2239327C5EDb3A432268e5831",logoUri:"https://wallet-asset.matic.network/img/tokens/usdc.svg",name:"USD Coin",symbol:"USDC",tokenAddress:"0xaf88d065e77c8cC2239327C5EDb3A432268e5831",walletAddress:"",chain:{id:A.arbitrum.mainnetID,imageUrl:A.arbitrum.iconUrl,name:A.arbitrum.name,symbol:A.arbitrum.tokenSymbol},contractAddress:"0xaf88d065e77c8cC2239327C5EDb3A432268e5831",spamStatus:ae.Verified}},HS={type:oe.ERC20,data:{amount:"0",balance:new L(0),decimals:6,key:"0x0000000000000000000000000000000000000000",logoUri:"https://wallet-asset.matic.network/img/tokens/usdc.svg",name:"USD Coin",symbol:"USDC",tokenAddress:"0x0000000000000000000000000000000000000000",walletAddress:"",chain:{id:A.monad.mainnetID,imageUrl:A.monad.iconUrl,name:A.monad.name,symbol:A.monad.tokenSymbol},contractAddress:"0x0000000000000000000000000000000000000000",spamStatus:ae.Verified}},WS={type:oe.HyperevmNative,data:{chain:{id:A.hyperevm.mainnetID,name:A.hyperevm.name,symbol:A.hyperevm.tokenSymbol,imageUrl:A.hyperevm.iconUrl},walletAddress:"",decimals:18,amount:"0",logoUri:"",name:"Ethereum",symbol:"ETH",balance:new L(0),key:"HyperevmNative",usd:79.02922295550286,price:1.095,usd_24h_change:-.19903579005681138,tokenAddress:void 0,spamStatus:ae.Verified}},ZS={type:oe.ERC20,data:{amount:"0",balance:new L(0),decimals:6,key:"0xb88339cb7199b77e23db6e890353e22632ba630f",logoUri:"https://wallet-asset.matic.network/img/tokens/usdc.svg",name:"USD Coin",symbol:"USDC",tokenAddress:"0xb88339cb7199b77e23db6e890353e22632ba630f",walletAddress:"",chain:{id:A.hyperevm.mainnetID,imageUrl:A.hyperevm.iconUrl,name:A.hyperevm.name,symbol:A.hyperevm.tokenSymbol},contractAddress:"0xb88339cb7199b77e23db6e890353e22632ba630f",spamStatus:ae.Verified}},YS={type:oe.EthereumNative,data:{chain:{id:A.ethereum.mainnetID,name:A.ethereum.name,symbol:A.ethereum.tokenSymbol,imageUrl:A.ethereum.iconUrl},walletAddress:"",decimals:18,amount:"45824381294194610",logoUri:"https://cdn.jsdelivr.net/gh/trustwallet/assets@master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",name:"Ethereum",symbol:"ETH",balance:new L(0),key:"EthereumNative",usd:85.14215868842653,price:1858.01,usd_24h_change:.0009391170983548136,tokenAddress:void 0,spamStatus:ae.Verified}},XS={type:oe.ERC20,data:{chain:{id:A.ethereum.mainnetID,name:A.ethereum.name,symbol:A.ethereum.tokenSymbol,imageUrl:A.ethereum.iconUrl},walletAddress:"",contractAddress:"0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",decimals:6,amount:"1881092",logoUri:"https://assets.coingecko.com/coins/images/6319/large/USD_Coin_icon.png?1547042389",name:"USD Coin",symbol:"USDC",balance:new L(0),key:"0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",tokenAddress:"0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",usd:1.8807026139560001,price:.999793,usd_24h_change:-.0005475429199477411,spamStatus:ae.Verified}};var H4="https://help.phantom.com/hc/en-us/articles/5985106844435",W4="https://help.phantom.com/hc/en-us/articles/29763090277139";var To={amount:new L(0),amountUsd:null,pct:0};u();l();var Zt={};var JS={...Zt,bridgeMinimumUsdAmounts:0,swapDefaultFee:new L(15e-5*10**18),bridgeDefaultFee:new L(.025*10**18),averageNetworkFee:new L(15e-5*10**18),nativeFungible:GS,usdcFungible:$S};u();l();var eb={...Zt,bridgeMinimumUsdAmounts:0,swapDefaultFee:new L(15e-5*10**18),bridgeDefaultFee:new L(.025*10**18),averageNetworkFee:new L(15e-5*10**18),nativeFungible:zS,usdcFungible:VS};u();l();var tb={bridgeMinimumUsdAmounts:10,swapDefaultFee:new L(1e4),bridgeDefaultFee:new L(1e4),averageNetworkFee:new L(1e4),nativeFungible:{type:oe.BitcoinNative,data:{chain:{id:A.bitcoin.mainnetID,name:A.bitcoin.name,symbol:A.bitcoin.tokenSymbol,imageUrl:A.bitcoin.iconUrl},walletAddress:"",decimals:18,amount:"45824381294194610",logoUri:"https://cdn.jsdelivr.net/gh/trustwallet/assets@master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",name:"Bitcoin",symbol:"BTC",balance:new L(0),key:"BitcoinNative",usd:85.14215868842653,price:1858.01,usd_24h_change:.0009391170983548136,tokenAddress:void 0,spamStatus:ae.Verified}},usdcFungible:{type:oe.BitcoinNative,data:{chain:{id:A.bitcoin.mainnetID,name:A.bitcoin.name,symbol:A.bitcoin.tokenSymbol,imageUrl:A.bitcoin.iconUrl},walletAddress:"",decimals:18,amount:"45824381294194610",logoUri:"https://cdn.jsdelivr.net/gh/trustwallet/assets@master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",name:"Bitcoin",symbol:"BTC",balance:new L(0),key:"BitcoinNative",usd:85.14215868842653,price:1858.01,usd_24h_change:.0009391170983548136,tokenAddress:void 0,spamStatus:ae.Verified}}};u();l();var rb={...Zt,bridgeMinimumUsdAmounts:20,swapDefaultFee:new L(2.5*10**16),bridgeDefaultFee:new L(3.75*10**16),averageNetworkFee:new L(0),nativeFungible:YS,usdcFungible:XS};u();l();var ob={...Zt,bridgeMinimumUsdAmounts:0,swapDefaultFee:new L(15e-5*10**18),bridgeDefaultFee:new L(.025*10**18),averageNetworkFee:new L(15e-5*10**18),nativeFungible:WS,usdcFungible:ZS};u();l();var nb={...Zt,bridgeMinimumUsdAmounts:0,swapDefaultFee:new L(.015*10**18),bridgeDefaultFee:new L(.025*10**18),averageNetworkFee:new L(.0021*10**18),nativeFungible:KS,usdcFungible:HS,requiredFeatureFlag:"enable-monad-swapper"};u();l();var sb={...Zt,bridgeMinimumUsdAmounts:2,swapDefaultFee:new L(6*10**16),bridgeDefaultFee:new L(6*10**16),averageNetworkFee:new L(.0015*10**18),nativeFungible:qS,usdcFungible:jS};u();l();var ib={bridgeMinimumUsdAmounts:1,swapDefaultFee:new L(3*10**6),bridgeDefaultFee:new L(30*10**6),averageNetworkFee:new L(15e3),nativeFungible:US,usdcFungible:MS};u();l();var ab={bridgeMinimumUsdAmounts:1,swapDefaultFee:new L(50*10**6),bridgeDefaultFee:new L(50*10**6),averageNetworkFee:new L(50*10**6),nativeFungible:OS,usdcFungible:QS};var p7=[ne.Solana,ne.Ethereum,ne.Polygon,ne.Monad,ne.Base,ne.Sui,ne.Arbitrum,ne.Hyperevm,ne.Bitcoin],Qv=new cn({[ne.Solana]:ib,[ne.Ethereum]:rb,[ne.Polygon]:sb,[ne.Monad]:nb,[ne.Base]:eb,[ne.Sui]:ab,[ne.Arbitrum]:JS,[ne.Hyperevm]:ob,[ne.Bitcoin]:tb}),Yt=an(Qv);var wi=i((e,t)=>{let r=[];if(qv(e)&&r.push({type:"permanentDelegate",level:"warn",titleKey:"swapAssetWarningPermanentDelegate",shortTitleKey:"swapAssetWarningPermanentDelegateShort",modalTitleKey:"swapAssetWarningPermanentDelegateModalTitle"}),(e.data.spamStatus===ae.NotVerified||e.data.spamStatus===ae.Spam||e.data.spamStatus===ae.PossibleSpam)&&r.push({type:"unverified",level:"info",titleKey:"swapAssetWarningUnverified",shortTitleKey:"swapAssetWarningUnverifiedShort",modalTitleKey:"swapAssetWarningUnverifiedModalTitle"}),!xt(e.type)&&t&&zv(t)){let o=Yt.get(e.data.chain.id).nativeFungible;r.push({type:"lowBalance",level:"info",titleKey:"swapAssetWarningLowTokenBalance",shortTitleKey:"swapAssetWarningLowTokenBalanceShort",modalTitleKey:"swapAssetWarningLowTokenBalanceModalTitle",options:{token:o.data.symbol??"",network:o.data.chain.name}})}return r},"detectAssetWarnings");function qv(e){let t=e.data;return t?.mintExtensions?t.mintExtensions.some(r=>r.extension===ma.permanentDelegate):!1}i(qv,"hasPermanentDelegateExtension");function zv(e){let t=Yt.get(e.data.chain.id);return new _(e.data.amount?e.data.amount:0).lt(t.swapDefaultFee)}i(zv,"isLowNativeTokenBalance");u();l();var Gv=3,cb=new _(2039280),Kv=new _(356190);function eu(e,t){if(!xt(e.type))return new _(e.data.balance);let{balance:r,decimals:o}=e.data,n=r?new _(r).multipliedBy(10**o):new _(0),a=jv(e,t);return(n.gt(a)?n.minus(a):n).dividedBy(10**o)}i(eu,"getMaxSellAmountWithDefaults");function jv(e,t){let r=e.data.chain.id;if(A.isSolanaNetworkID(r))return Vv(e,t);if(A.isEVMNetworkID(r))return $v(e,t);if(A.isSuiNetworkID(r))return Hv(e,t);throw new Error("Chain not supported by swapper")}i(jv,"calculateFees");function Vv(e,t){let{defaultSwapFee:r,networkFeeBuffer:o}=fd(e,t),n=r.plus(o),a=cb,c=!t||new _(t.data.balance).isZero()?cb:new _(0);return n.plus(a).plus(c)}i(Vv,"calculateSolanaFees");function $v(e,t){let{networkFeeBuffer:r}=fd(e,t),o=Wv(e.data.chain.id),n=new _(o.maxFeePerGas),a=new _(o.maxPriorityFeePerGas);return Kv.multipliedBy(n.plus(a)).plus(r)}i($v,"calculateEVMFees");function Hv(e,t){let{defaultSwapFee:r,networkFeeBuffer:o}=fd(e,t);return r.plus(o)}i(Hv,"calculateSuiFees");function fd(e,t){let r=$t(e.data.chain.id,t?.data.chain.id),o=Yt.get(e.data.chain.id),n=r?o.bridgeDefaultFee:o.swapDefaultFee,a=o.averageNetworkFee.multipliedBy(Gv);return{defaultSwapFee:n,networkFeeBuffer:a}}i(fd,"getCommonFeeComponents");function Wv(e){if(A.isEthereumNetworkID(e))return{maxFeePerGas:new _("5000000000"),maxPriorityFeePerGas:new _("79000000")};if(A.isPolygonNetworkID(e))return{maxFeePerGas:new _("30000000000"),maxPriorityFeePerGas:new _("30000000000")};if(A.isBaseNetworkID(e))return{maxFeePerGas:new _("25000000"),maxPriorityFeePerGas:new _("1100000")};if(A.isArbitrumNetworkID(e))return{maxFeePerGas:new _("29000000"),maxPriorityFeePerGas:new _("0")};throw new Error("Chain not supported by swapper")}i(Wv,"getEVMDefaultTransactionUnitCost");var tu=class{static{i(this,"TokenStateMachine")}state={type:"idle"};eventListeners=[];send(t){let r=this.state,o=r;try{return o=this.detectNextState(t),this.state=o,o}catch{return r}finally{this.eventListeners.forEach(n=>n.onStateChange(t,r,o))}}detectNextState(t){switch(t.type){case"initializeStarted":return{type:"initializing",mode:t.mode};case"initializeCompleted":if(this.state.type==="initializing"||this.state.type==="refreshing"){let r=new _(t.result.maxSellAmount??t.result.sellToken.data.balance);return{type:"pair",mode:this.state.mode,sellToken:t.result.sellToken,buyToken:t.result.buyToken,sellTokenPrice:t.result.sellTokenPrice,buyTokenPrice:t.result.buyTokenPrice,warnings:wi(t.result.buyToken),maxSellAmount:r,takerCaip19:t.result.takerCaip19,takerDestinationCaip19:t.result.takerDestinationCaip19,isPrediction:t.result.isPrediction??!1,predictionsQuoteInput:t.result.predictionsQuoteInput}}throw new Error("Invalid state");case"initializeFailed":if(this.state.type!=="initializing")throw new Error("Invalid state");return{type:"error",error:t.error};case"switchTokens":{if(this.state.type!=="pair")throw new Error("Invalid state");let r=this.state.buyToken,o=this.state.sellToken,n=this.state.buyTokenPrice,a=this.state.sellTokenPrice;return{type:"pair",mode:t.mode,sellToken:r,buyToken:o,sellTokenPrice:n,buyTokenPrice:a,maxSellAmount:eu(r,o),warnings:wi(o),takerCaip19:this.state.takerDestinationCaip19,takerDestinationCaip19:this.state.takerCaip19,isPrediction:this.state.isPrediction}}case"changeToken":{if(this.state.type!=="pair")throw new Error("Invalid state");let r=t.perspective==="sell"?t.token:this.state.sellToken,o=t.perspective==="buy"?t.token:this.state.buyToken;return{type:"pair",mode:t.mode,sellToken:r,buyToken:o,sellTokenPrice:t.sellTokenPrice??this.state.buyTokenPrice,buyTokenPrice:t.buyTokenPrice??this.state.sellTokenPrice,maxSellAmount:eu(r,o),warnings:wi(t.perspective==="buy"?t.token:this.state.buyToken),takerCaip19:this.state.takerCaip19,takerDestinationCaip19:this.state.takerDestinationCaip19,isPrediction:this.state.isPrediction}}case"updateBalances":{if(this.state.type!=="pair")throw new Error("Invalid state");if(M(te(this.state.sellToken))!==t.sellTokenCaip19)throw new Error("Invalid state");let r={...this.state.sellToken,data:{...this.state.sellToken.data,balance:t.sellTokenBalance}},o=this.state.buyToken;return{type:"pair",mode:this.state.mode,sellToken:r,buyToken:o,sellTokenPrice:this.state.sellTokenPrice,buyTokenPrice:this.state.buyTokenPrice,warnings:wi(o),maxSellAmount:eu(r,o),takerCaip19:this.state.takerCaip19,takerDestinationCaip19:this.state.takerDestinationCaip19,isPrediction:this.state.isPrediction}}case"refreshing":if(this.state.type!=="pair")throw new Error("Invalid state");return{type:"refreshing",mode:this.state.mode,sellToken:this.state.sellToken,buyToken:this.state.buyToken,sellTokenPrice:this.state.sellTokenPrice,buyTokenPrice:this.state.buyTokenPrice,maxSellAmount:this.state.maxSellAmount,warnings:this.state.warnings,takerCaip19:this.state.takerCaip19,takerDestinationCaip19:this.state.takerDestinationCaip19,isPrediction:this.state.isPrediction}}}getState(){return this.state}subscribe(t){this.eventListeners.push(t)}unsubscribe(t){this.eventListeners=this.eventListeners.filter(r=>r!==t)}};var ru=class{static{i(this,"Swapper")}apiClient;swapCommandFactory;quoteProcessor;stateMachine=new Jc;executeSwapStateMachine=new Yc;account;cashAccount;config={slippageType:ce.Auto,slippageTolerance:1.3,isSimulationKilled:!1};swapInitializer=new Hn(new $n);tokenStateMachine=new tu;accountChangeListeners=[];constructor(t,r,o,n){this.apiClient=t,this.swapCommandFactory=r,this.quoteProcessor=o,this.quoteProcessor.subscribe(this.quoteProcessorListener),this.tokenStateMachine.subscribe(this.tokenStateListener),n&&(this.account=n)}tokenStateListener={onStateChange:i((t,r,o)=>{o.type==="pair"&&(this.setPair(o.buyToken,o.sellToken,{amount:"0",perspective:"sell"}),t.type==="changeToken"&&this.refreshQuoteProcessor())},"onStateChange")};refreshPair({swapMode:t,cashAddresses:r,settings:o}){this.initializeSwap({swapMode:t,cashAddresses:r,settings:o,refresh:!0})}initializeSwap({swapMode:t,cashAddresses:r,settings:o,refresh:n=!1}){let a=this.checkAccount();this.getTokenState().type==="pair"&&n?this.tokenStateMachine.send({type:"refreshing"}):this.tokenStateMachine.send({type:"initializeStarted",mode:t}),this.swapInitializer.initialize(t,a.addresses,r,o).then(p=>{this.tokenStateMachine.send({type:"initializeCompleted",result:p})}).catch(p=>{R.captureError(p,U.Swapper),p instanceof yi?this.tokenStateMachine.send({type:"initializeFailed",error:p}):this.tokenStateMachine.send({type:"initializeFailed",error:yi.fromError(p)})})}updateBalances({sellTokenBalance:t,sellTokenCaip19:r}){this.getTokenState().type==="pair"&&this.tokenStateMachine.send({type:"updateBalances",sellTokenBalance:t,sellTokenCaip19:r})}getTokenState(){return this.tokenStateMachine.getState()}subscribeToken(t){return this.tokenStateMachine.subscribe(t),()=>this.unsubscribeToken(t)}unsubscribeToken(t){this.tokenStateMachine.unsubscribe(t)}quoteProcessorListener={onStateChange:i((t,r)=>{(r.type==="firstQuoteReceived"||r.type==="quoteProcessed")&&this.send({type:ct.QuoteResponseStreamed,response:r.response,quoteInput:r.input,quote:r.quote})},"onStateChange")};isValidAmount(t){try{let r=new _(t);return r.isFinite()?!r.isNegative():!1}catch{return!1}}setAmount(t,r){let o=this.getTokenState();if(!At(o)){console.error(`Can't set amount from tokenState ${o.type}`);return}let{amount:n}=t;if(n===""&&(n="0"),!this.isValidAmount(n))return;this.quoteProcessor.stop();let a=this.checkAccount(),c={...this.config,...r,isSimulationKilled:r?.isSimulationKilled??this.config.isSimulationKilled??!1};if(n==="0"||n===""){this.send({type:ct.SetPair,buy:o.buyToken,sell:o.sellToken,amount:t});return}let{buyToken:p,sellToken:d,takerCaip19:m,takerDestinationCaip19:f,isPrediction:h,predictionsQuoteInput:y}=o,w=Ve(p)||Ve(d);try{let S={amount:new _(t.amount).shiftedBy(t.perspective==="buy"?p.data.decimals:d.data.decimals).toString(),amountUsd:_(t.amount).times(t.perspective==="buy"?p.data.price??0:d.data.price??0).toString(),buy:p,sell:d,taker:m,takerDestination:f,slippageTolerance:c.slippageTolerance,autoSlippage:c.slippageType===ce.Auto,exactOut:t.perspective==="buy",priorityFee:c.priorityFee,tipAmount:c.tipAmount,preferredProvider:c.preferredProvider,isLedger:a.type==="ledger",phantomCashAccount:w,isSimulationKilled:c.isSimulationKilled,isPrediction:h??!1,predictions:y};this.quoteProcessor.start(S,a)}catch(S){console.error("Error when streaming quotes",S)}}setPair(t,r,o){this.send({type:ct.SetPair,buy:t,sell:r,amount:o})}switchTokens(){let t=this.getTokenState();if(t.type!=="pair")return;let r=LS(t);r&&this.tokenStateMachine.send({type:"switchTokens",mode:r})}setAccount(t){this.account=t,this.accountChangeListeners.forEach(r=>r.onAccountChange(t))}setCashAccount(t){this.cashAccount=t}getAccount(){return this.account}getInitializer(){return this.swapInitializer}setInitializer(t){this.swapInitializer=t}async fetchQuotes({amount:t,amountUsd:r,buy:o,sell:n,slippageTolerance:a,autoSlippageEnabled:c,priorityFee:p,tipAmount:d,signal:m,phantomCashAccount:f}){let h=te(n),y=te(o),w=t.perspective==="buy",S=new _(t.amount).shiftedBy(t.perspective==="buy"?o.data.decimals:n.data.decimals).toString();this.send({type:ct.QuoteRequestStarted,amount:t,slippageType:c?ce.Auto:ce.Fixed});let T=this.checkChainAddress(n.data),b={chainId:T.networkID,resourceType:J.address,address:T.address},x;if($t(n.data.chain.id,o.data.chain.id)){let E=this.checkChainAddress(o.data);x={chainId:E.networkID,resourceType:J.address,address:E.address}}try{let E=await this.apiClient.getQuotes({sell:h,buy:y,amount:S,amountUsd:r,taker:b,takerDestination:x,slippageTolerance:a??0,autoSlippageEnabled:c,exactOutEnabled:w,priorityFee:p,tipAmount:d,signal:m,phantomCashAccount:f});return this.send({type:ct.QuoteResponseReceived,response:E}),E}catch(E){throw this.send({type:ct.QuoteRequestError,error:E}),E}}async swap(t){let{signer:r,storage:o,locale:n,deviceId:a,connection:c,authRepository:p,isSimulationKilled:d,gasEstimation:m,preprocessor:f}=t,h=this.getState();if(!NS(h))throw new Error(`Can't swap from ${h.type}`);this.quoteProcessor.stop();let y=this.checkAccount(),w={account:y,buy:h.buy,sell:h.sell,amount:h.amount,quote:h.quote,response:h.response,slippageType:h.slippageType,quoteInput:h.input},S=this.getAddressFromCaip19({caip19:h.response.taker}),T=this.swapCommandFactory.create(w,S,h.sell.data.chain.id,c,p,this.cashAccount,m),b=new Wc(T,E=>this.executeSwapStateMachine.send(E),w),x=await b.createTransaction();await R.startSpan(pd(se(h.quote),x.type),async()=>{let E=await b.simulate(x,n,a,d),C=i(async()=>{let I=await b.swap(y.identifier,x,E,r,o);await b.waitForConfirmation(I)},"performSwap");f?await f(C):await C()})}changeToken(t,r,o){let n=this.getTokenState();if(n.type!=="pair")return;let a=r==="buy"?t:n.buyToken,c=r==="sell"?t:n.sellToken,p=te(c),d=te(a),m;n.mode.type==="swap"?m={...n.mode,network:c.data.chain.id,sellCaip19:M(p),buyCaip19:M(d),takerCaip19:r==="sell"?o:n.mode.takerCaip19,takerDestinationCaip19:r==="buy"?o:n.mode.takerDestinationCaip19,sellFungibleKey:r==="sell"?t.data.key:n.mode.sellFungibleKey,buyFungibleKey:r==="buy"?t.data.key:n.mode.buyFungibleKey}:n.mode.type==="buy"?m={...n.mode,buyCaip19:M(d),sellCaip19:M(p),takerCaip19:r==="buy"?o:n.mode.takerCaip19}:n.mode.type==="sell"&&(m={...n.mode,sellCaip19:M(p),buyCaip19:M(d),takerDestinationCaip19:r==="sell"?o:n.mode.takerDestinationCaip19}),ga({tokens:[d,p]}).then(f=>{let h=f[M(d)],y=f[M(p)];this.tokenStateMachine.send({type:"changeToken",mode:m,token:t,perspective:r,buyTokenPrice:h,sellTokenPrice:y})}).catch(f=>{R.captureError(f,U.Swapper),this.tokenStateMachine.send({type:"changeToken",mode:m,token:t,perspective:r})})}selectQuote(t){this.send({type:ct.UserSelectedQuote,quote:t})}setQuoteConfig(t){this.config={...this.config,...t},this.refreshQuoteProcessor()}refreshQuoteProcessor(){let t=this.getLastQuoteProcessorSwapAmount();t&&this.setAmount(t)}getLastQuoteProcessorSwapAmount(){let t=this.getQuoteProcessorState();switch(t.type){case"starting":case"firstQuoteReceived":case"quoteProcessed":case"error":let r=t.input;return{amount:new _(r.amount).shiftedBy(-1*(r.exactOut?r.buy.data.decimals:r.sell.data.decimals)).toString(),perspective:r.exactOut?"buy":"sell"};default:return}}getState(){return this.stateMachine.getState()}getExecuteState(){return this.executeSwapStateMachine.getState()}stopProcessingQuotes(){this.quoteProcessor.stop()}subscribeExecution(t){return this.executeSwapStateMachine.addListener(t),()=>this.unsubscribeExecution(t)}unsubscribeExecution(t){this.executeSwapStateMachine.removeListener(t)}getQuoteProcessorState(){return this.quoteProcessor.getState()}subscribeQuoteProcessor(t){return this.quoteProcessor.subscribe(t),()=>this.unsubscribeQuoteProcessor(t)}unsubscribeQuoteProcessor(t){this.quoteProcessor.unsubscribe(t)}stopQuoteProcessor(){this.quoteProcessor.stop()}subscribeAccountChange(t){return this.accountChangeListeners.push(t),()=>this.unsubscribeAccountChange(t)}unsubscribeAccountChange(t){this.accountChangeListeners=this.accountChangeListeners.filter(r=>r!==t)}setQuoteStreamer(t){this.quoteProcessor.setQuoteStreamer(t)}getSwapCommandFactory(){return this.swapCommandFactory}setSwapCommandFactory(t){this.swapCommandFactory=t}send(t){return this.stateMachine.send(t)}checkAccount(){if(!this.account)throw new Error("Must set a MultiChainAccount");return this.account}checkChainAddress({chain:t,walletAddress:r}){let{id:o}=t;if(r)return{networkID:o,address:r};let a=this.checkAccount().addresses.find(p=>p.networkID===o);if(!a)throw new Error(`No address found for chain ${o}`);let c={...a};return gr(c)&&(c.address=c.address.toLowerCase()),c}getAddressFromCaip19(t){let r;if("encodedCaip19"in t?r=et(t.encodedCaip19):r=t.caip19,r.resourceType===J.address)return r.address;throw new Error(`CAIP19 ${r} is not an address`)}};u();l();var ou=P(O());var ub=(0,ou.createContext)(null),lb=ub.Provider;function Wn(){let e=(0,ou.useContext)(ub);if(!e)throw new Error("useBridgeStatusManager must be used within a BridgeStatusManagerProvider");return e}i(Wn,"useBridgeStatusManager");u();l();var pb=P(O());u();l();u();l();var Si=class{static{i(this,"WarmSwapAnalytics")}analytics;constructor(t){this.analytics=t}warmingStarted(t){this.analytics.capture("swapperWarmingStarted",{data:{mode:t.type,caip19:this.getCaip19(t)}})}warmingCompleted(t,r){this.analytics.capture("swapperWarmingCompleted",{data:{mode:t.type,caip19:this.getCaip19(t),durationMs:r}})}warmingFailed(t){this.analytics.capture("swapperWarmingFailed",{data:{mode:t.type,caip19:this.getCaip19(t)}})}cacheHit(t){this.analytics.capture("swapperWarmCacheHit",{data:{mode:t.type,caip19:this.getCaip19(t)}})}cacheMiss(t){this.analytics.capture("swapperWarmCacheMiss",{data:{mode:t.type,caip19:this.getCaip19(t)}})}warmingAwaited(t){this.analytics.capture("swapperWarmingAwaited",{data:{mode:t.type,caip19:this.getCaip19(t)}})}getCaip19(t){switch(t.type){case"buy":return t.buyCaip19;case"sell":return t.sellCaip19;default:return}}};var nu=class{static{i(this,"WarmSwapInitializer")}proxyInitializer;multiChainAccount;cashAddresses;cache;analytics;constructor(t,r,o){this.proxyInitializer=t,this.cache=new gd(r),this.analytics=o?new Si(o):void 0}async initialize(t,r,o,n){let a=this.cache.get(t);if(!a)return this.analytics?.cacheMiss(t),this.proxyInitializer.initialize(t,r,o,n);switch(a.type){case"idle":return this.analytics?.cacheMiss(t),this.proxyInitializer.initialize(t,r,o,n);case"warming":return this.analytics?.warmingAwaited(t),a.promise.catch(()=>this.proxyInitializer.initialize(t,r,o,n)).finally(()=>{this.cache.delete(t)});case"warmed":return this.analytics?.cacheHit(t),this.cache.delete(t),a.initializationResult}}warmInitialization(t){if(!this.multiChainAccount)return;let r=this.cache.peek(t);if(r&&r.type==="warmed"&&dd(r.swapMode,t))return;this.analytics?.warmingStarted(t);let o=Date.now(),n=this.proxyInitializer.initialize(t,this.multiChainAccount.addresses,this.cashAddresses??{},{});this.cache.set(t,{type:"warming",swapMode:t,promise:n}),n.then(a=>{let c=Date.now()-o;this.analytics?.warmingCompleted(t,c),this.cache.set(t,{type:"warmed",swapMode:t,initializationResult:a})}).catch(()=>{this.analytics?.warmingFailed(t),this.cache.delete(t)})}setMultiChainAccount(t){this.cache.clear(),this.multiChainAccount=t}setCashAddresses(t){this.cache.clear(),this.cashAddresses=t}setAnalytics(t){this.analytics||(this.analytics=new Si(t))}},gd=class{static{i(this,"Cache")}capacity;entries=new Map;constructor(t){this.capacity=t}getKey(t){let r={type:t.type},o=i(n=>{if(n?.minimumOrderSize)return{minimumOrderSize:{base:n.minimumOrderSize.base?.toString(),quote:n.minimumOrderSize.quote?.toString()}}},"serializeOptions");switch(t.type){case"buy":return JSON.stringify({...r,buyCaip19:t.buyCaip19,sellCaip19:t.sellCaip19,takerCaip19:t.takerCaip19,takerDestinationCaip19:t.takerDestinationCaip19,options:o(t.options)});case"sell":return JSON.stringify({...r,sellCaip19:t.sellCaip19,buyCaip19:t.buyCaip19,takerCaip19:t.takerCaip19,takerDestinationCaip19:t.takerDestinationCaip19,options:o(t.options)});case"swap":return JSON.stringify({...r,network:t.network,sellCaip19:t.sellCaip19,buyCaip19:t.buyCaip19,takerCaip19:t.takerCaip19,takerDestinationCaip19:t.takerDestinationCaip19,options:o(t.options)});case"prediction":return JSON.stringify({...r,network:t.network,mode:t.mode,outcomeType:t.outcomeType,mintAccounts:t.mintAccounts,takerCaip19:t.takerCaip19,takerDestinationCaip19:t.takerDestinationCaip19,options:o(t.options)});default:let n=t;return JSON.stringify(r)}}get(t){return this.entries.get(this.getKey(t))}peek(t){return this.entries.get(this.getKey(t))}set(t,r){let o=this.getKey(t);if(this.entries.set(o,r),this.entries.size>this.capacity){let n=Array.from(this.entries.keys())[0];this.entries.delete(n)}}delete(t){this.entries.delete(this.getKey(t))}clear(){this.entries.clear()}};var Zv=2,su=new nu(new Hn(new $n),Zv);var db=(0,Xt.createContext)(null);function Yv({children:e,processorMode:t="noOp",quoteStreamer:r}){let{data:o}=Ie(),n=Tt(),a=(0,Xt.useMemo)(()=>sw(n),[n]);(0,Xt.useEffect)(()=>{a.initialize()},[a]);let c=(0,Xt.useMemo)(()=>mb(t,a),[t,a]);(0,Xt.useEffect)(()=>{o&&(c.setAccount(o),su.setMultiChainAccount(o))},[o,c]),(0,Xt.useEffect)(()=>{r&&c.setQuoteStreamer(r)},[r,c]);let p=Va();return(0,Xt.useEffect)(()=>{p&&su.setCashAddresses(p)},[p,c]),(0,hd.jsx)(lb,{value:a,children:(0,hd.jsx)(db.Provider,{value:c,children:e})})}i(Yv,"SwapperProvider");function ot(){let e=(0,Xt.useContext)(db);return e||mb("noOp")}i(ot,"useSwapper");function mb(e,t){let r=new ru(new Ha,new fc(t),new Dc(new yc(sr?new hc:new gc),e==="noOp"?new Fc:new Ic));return r.setInitializer(su),r}i(mb,"createSwapper");u();l();var fb=P(O());var Xv=i(e=>{let t=Tt(),r=Wn(),{t:o}=Fe(),n=(0,fb.useRef)(void 0),a=Kf.pendingTransactionById(e);return ie({queryKey:a,queryFn:i(async()=>{try{let d=(await Jf(t))[e],m=d?void 0:r.getPendingBridgeTransactionById(e,o),f=d??m;return f?(tf(f,n.current)||(n.current=f),n.current):void 0}catch(p){throw R.captureError(p,U.Transaction),p}},"queryFn"),refetchInterval:z({milliseconds:200}),staleTime:z({milliseconds:200}),gcTime:0,refetchOnMount:!0})},"usePendingTransactionByIdWithBridge");u();l();var Hr=P(O());u();l();var vr=i(e=>{let t=Math.floor(e/3600),r=Math.floor((e-t*3600)/60),o=e%60;if(t>0)return v.t("swapProviderEstimatedTimeHM",{hours:t,minutes:r});if(r>0){let n=o>0?r+1:r;return v.t("swapProviderEstimatedTimeM",{minutes:n})}return v.t("swapProviderEstimatedTimeS",{seconds:o})},"formatSecondsAsSwapTime");u();l();var iu=i(e=>e.steps.reduce((t,r)=>t.plus(new L(r.nonIncludedNonGasFees)),new L(0)),"getBridgeStepsFees"),Zn=i(e=>e.steps.flatMap(r=>r.feeCosts).reduce((r,o)=>r.plus(o.amountUSD??0),new L(0)),"getBridgeStepsFeesInUsd");u();l();var xo=i(e=>e&&se(e)?e.executionDuration:0,"getSwapExecutionDuration");var Jv=i(({selectProvider:e})=>{let{currencySymbol:t,fromUsd:r}=ht(),o=ot(),[n,a]=(0,Hr.useState)(!1),[c,p]=(0,Hr.useState)(o.getQuoteProcessorState());(0,Hr.useEffect)(()=>{let h=o.subscribeQuoteProcessor({onStateChange(y,w){p(w)}});return()=>h()},[o]);let[d,m]=(0,Hr.useState)(o.getTokenState());return(0,Hr.useEffect)(()=>{let h=o.subscribeToken({onStateChange(y,w,S){m(S)}});return()=>h()},[o]),{details:(0,Hr.useMemo)(()=>{if(c.type!=="quoteProcessed"&&c.type!=="firstQuoteReceived"||d.type!=="pair")return[];let h=c.quote,y=oP(h),w=h.baseProvider.name,S=rP({currentQuote:h,buyToken:d.buyToken,sellToken:d.sellToken,isFlipped:n,setIsFlipped:a});return se(h)?tP({quote:h,selectProvider:e,exchangeRate:S,currencySymbol:t,fromUsd:r}):eP({provider:w,sources:y,exchangeRate:S,selectProvider:e})},[c,d,e,t,r,n]),footnote:v.t("swapProviderPricingFootnote")}},"useSwapPricing"),eP=i(({provider:e,sources:t,exchangeRate:r,selectProvider:o})=>[{label:v.t("swapProviderPricingProvider"),value:e,icon:"chevron-right",onPress:o},{label:v.t("swapProviderPricingMarket"),value:t},{label:v.t("swapProviderPricingPrice"),value:r.rate,icon:"swap",onPress:r.flip}],"getStandardRows"),tP=i(({quote:e,selectProvider:t,exchangeRate:r,currencySymbol:o,fromUsd:n})=>{let a=e.baseProvider.name,c=Zn(e).toString(),p=vr(xo(e));return[{label:v.t("swapProviderPricingProvider"),value:a,icon:"chevron-right",onPress:t},{label:v.t("swapProviderPricingPrice"),value:r.rate,icon:"swap",onPress:r.flip},{label:v.t("swapProviderPricingFees"),value:`${o}${n(Number(c),2)} ${v.t("swapProvidersFee")}`},{label:v.t("swapProviderPricingTime"),value:p}]},"getBridgeRows");function rP({currentQuote:e,buyToken:t,sellToken:r,isFlipped:o,setIsFlipped:n}){let{exchangeRate:a,exchangeRateFlipped:c}=Pp(e,t,r);return{rate:o?c:a,flip:i(()=>n(!o),"flip")}}i(rP,"getExchangeRate");function oP(e){return De(Oe(e))}i(oP,"getSources");u();l();u();l();var Wr=P(O());function nP(e){let t=Wn(),{t:r}=Fe(),[o,n]=(0,Wr.useState)(0),[a,c]=(0,Wr.useState)(0),[p,d]=(0,Wr.useState)(0);return(0,Wr.useEffect)(()=>{let f={onBridgeStatusChange:i(h=>{n(y=>y+1),(h.type==="completed"||h.type==="failed")&&c(y=>y+1)},"onBridgeStatusChange")};return t.addListener(f),()=>{t.removeListener(f)}},[t]),(0,Wr.useEffect)(()=>{let f=setInterval(()=>{d(h=>h+1)},z({minutes:1}));return()=>clearInterval(f)},[]),{pendingBridgeTransactions:(0,Wr.useMemo)(()=>e.length?t.getPendingBridgeTransactions(r,{addresses:e}):[],[t,e,r,o,p,a])}}i(nP,"useBridgePendingActivities");u();l();var Zr=P(O());var sP={"BitcoinNative-bip122_p2wpkh":ye.BitcoinNativeSegwit,"BitcoinNative-bip122_p2tr":ye.BitcoinTaproot,BitcoinNative:ye.BitcoinTaproot};function gb(e){return sP[e]??null}i(gb,"normalizeBitcoinFungibleKey");function hb(e,t){let r=gb(e),o=gb(t);return r&&o?r===o:e===t}i(hb,"doBitcoinFungibleKeysMatch");function iP(e,t,r){let o=Wn(),{t:n}=Fe(),[a,c]=(0,Zr.useState)(0),[p,d]=(0,Zr.useState)(0);(0,Zr.useEffect)(()=>{let y={onBridgeStatusChange:i(w=>{c(S=>S+1),(w.type==="completed"||w.type==="failed")&&d(S=>S+1)},"onBridgeStatusChange")};return o.addListener(y),()=>{o.removeListener(y)}},[o]);let m=(0,Zr.useMemo)(()=>e.length?o.getPendingBridgeActivities(n,{addresses:e}):[],[o,e,n,a,p]),f=(0,Zr.useMemo)(()=>e.length?o.getPendingBridgeTransactions(n,{addresses:e}):[],[o,e,n,a,p]);return{pendingBridgeTransactions:(0,Zr.useMemo)(()=>{if(!f.length||!m.length)return[];let y=new Map(m.map(T=>[T.record.executionId,T.record])),w=A.isBitcoinNetworkID(r),S=t;return f.filter(T=>{let b=y.get(T.id);if(!b)return!1;let x=b.quote.sell,E=b.quote.buy;if(!x&&!E)return!1;if(x){let C=x.data.key;if(w&&hb(S,C))return!0;let I=te(x),B=Po(I)?.[0];if(B&&S===B)return!0}if(E){let C=E.data.key;if(w&&hb(S,C))return!0;let I=te(E),B=Po(I)?.[0];if(B&&S===B)return!0}return!1})},[f,m,t,r])}}i(iP,"useFungibleBridgePendingActivities");u();l();u();l();function Vo(e){return{chain:ne.Solana,type:"fungible",address:e.type===oe.SPL?e.data.mintAddress:void 0,symbol:e.data.symbol??""}}i(Vo,"getAnalyticsAsset");var au=class{static{i(this,"NextGenAnalytics")}analytics;additionalAnalyticsTags;constructor(t,r){this.analytics=t,this.additionalAnalyticsTags=r}captureEvent(t,r){let o={...r,data:{...r.data,...this.additionalAnalyticsTags}};this.analytics.capture(t,o)}swapperOpen(t,r,o){this.captureEvent("swapperOpen",{data:{uiContext:o??"swapperInterstitial",swapMode:t,comingFrom:r}})}swapperClose(t,r){this.captureEvent("swapperClose",{data:{uiContext:r??"swapperInterstitial",reason:t}})}swapperUpdateAsset(t,r){switch(t.type){case"sell":this.captureEvent("swapperUpdateToAsset",{data:Vo(r)});break;case"buy":this.captureEvent("swapperUpdateFromAsset",{data:Vo(r)});break}}swapperSwapDefaultQuoteSelected(t){this.captureEvent("swapperSwapDefaultQuoteSelected",{data:{quotePercentageValue:t}})}swapperDetailPanelClicked(){this.captureEvent("swapperDetailPanelClicked",{data:{uiContext:"swapperInterstitial"}})}swapperToggleQuoteCurrency(){this.captureEvent("swapperToggleQuoteCurrency",{data:{uiContext:"swapperInterstitial"}})}swapperQuotesResult(t,r,o){this.captureEvent("swapperQuotesResult",{data:{...bi(t,o),numQuotes:r.quotes.length,sellToken:M(te(t.sell)),buyToken:M(te(t.buy)),fromNetworkId:t.sell.data.chain.id,toNetworkId:t.buy.data.chain.id,isGasless:r.quotes.some(n=>"gaslessSwapFeeResult"in n&&n.gaslessSwapFeeResult?.success===!0)}})}swapperQuotesError({input:t,quoteError:r}){this.captureEvent("swapperQuotesError",{data:{...bi(t),error:r.name}})}};function bi(e,t){let r=t?aP(t):void 0;return{isSellTokenVerified:e.sell.data.spamStatus&&da({minimum:ae.Verified,spamStatus:e.sell.data.spamStatus}),sellTokenCaip19:M(te(e.sell)),sellTokenNetworkId:e.sell.data.chain.id,sellTokenSymbol:e.sell.data.symbol??void 0,sellTokenMarketCap:e.sell.data.marketCap,sellTokenAmount:e.amount,buyTokenCaip19:M(te(e.buy)),buyTokenNetworkId:e.buy.data.chain.id,buyTokenSymbol:e.buy.data.symbol??void 0,isAutoSlippageEnabled:e.autoSlippage,manualSlippagePercent:e.slippageTolerance,isExactOut:e.exactOut,isManualTipInput:e.tipAmount!==void 0,gaslessError:r?.error,gaslessAtaFeeUSD:r?.data?.ataFeeUSD,gaslessNetworkFeeUSD:r?.data?.networkFeeUSD,gaslessTotalAmountUSD:r?.data?.totalAmountUSD}}i(bi,"createSwapperAnalyticsFields");function yd(e){if(e.type==="quoteProcessed")return bi(e.input,e.quote)}i(yd,"createSwapperAnalyticsFieldsFromQuoteProcessorState");function aP(e){if(Pt(e))return e.gaslessSwapFeeResult}i(aP,"getGaslessSwapFeeResult");u();l();var cP=P(Be());var Ti=P(O());var uP=(0,Ti.createContext)(void 0);var yb=i(()=>{let e=(0,Ti.useContext)(uP);if(!e)throw new Error("useSwapToken must be used within a SwapTokenProvider");return e},"useSwapToken");u();l();function wb(e,t,r,o){let a=t.find(p=>p.percentage===1)?.amount;if(o==="sell"&&a&&new L(e).gt(a))return["insufficientBalance"];let c=r.type==="buy"?r.options?.minimumOrderSize?.quote:r.options?.minimumOrderSize?.base;return c!=null&&new L(e).lt(c)?["minimumBalance"]:[]}i(wb,"createQuoteInputErrors");u();l();var lP=[.25,.5,1],wd=class{static{i(this,"SellPercentage")}percentage;amount;fiatAmount;constructor(t,r,o){this.percentage=t,this.amount=r,this.fiatAmount=o}getAmountForDenomination(t){return t==="crypto"?this.amount:this.fiatAmount}};function Sb({maxSellAmount:e,sellTokenPrice:t,allowedPercentages:r=lP}){return r.map(o=>{let n=e.multipliedBy(o);return new wd(o,n,n.multipliedBy(t?.usd??0))})}i(Sb,"getSellPercentages");u();l();var bd=P(O());u();l();var Yn=i(()=>Dt({key:_e.PriorityFee,queryKey:we.priorityFee()}),"usePriorityFee"),BX=i(()=>Nt({key:_e.PriorityFee,queryKey:we.priorityFee()}),"useSetPriorityFee");u();l();var Xn=i(()=>Dt({key:_e.TipAmount,queryKey:we.tipAmount()}),"useTip"),zX=i(()=>Nt({key:_e.TipAmount,queryKey:we.tipAmount()}),"useSetTip");u();l();function Sd(e){return new _(e??0).multipliedBy(10**uf.tokenDecimals)}i(Sd,"getCustomFee");u();l();var pP=3,dP=new L(356190),mP=i(e=>Yt.get(e).averageNetworkFee.times(pP),"getNetworkFeeBuffer");function bb({sellFungible:e,totalFees:t,transactionSpeedsToUnitCost:r,minRequiredBalance:o,customPriorityFee:n,customTip:a,isBridge:c=!1}){let{decimals:p,amount:d,balance:m,chain:f}=e.data,h=d?new L(d):m?new L(m).multipliedBy(yn(p)):new L(0),y=xt(e.type),w=Ve(e),{source:S,destination:T}=o;if(w)return Sl(h.toString(),p);let x=fP({isNativeToken:y,network:f,totalFees:t,isBridge:c,transactionSpeedsToUnitCost:r,customPriorityFee:n,customTip:a}).plus(T),E=y?gP(h,x,S):h.toString();return Sl(E,p)}i(bb,"getMaxSellAmount");function fP({isNativeToken:e,network:t,totalFees:r,isBridge:o,transactionSpeedsToUnitCost:n,customPriorityFee:a,customTip:c}){if(!e)return r;let p=Yt.get(t.id),d=o?p.bridgeDefaultFee:p.swapDefaultFee,m=n?.[Tr.standard];return Xf(m)&&(d=dP.multipliedBy(m.maxFeePerGas.plus(m.maxPriorityFeePerGas))),A.isSolanaNetworkID(t.id)&&a&&(d=d.plus(a)),A.isSolanaNetworkID(t.id)&&c&&(d=d.plus(c)),d.plus(mP(t.id))}i(fP,"calculateFees");function gP(e,t,r){let o=r.plus(t);return e.gt(o)?e.minus(o).toString():e.toString()}i(gP,"calculateNativeTokenMaxSell");u();l();var xi=P(O());var Tb=i(e=>{let t=e?.data.chain.id,{data:r}=Ie(),o=(0,xi.useMemo)(()=>r?.addresses.find(a=>a.networkID===t),[r,t]),{data:n=0}=Ro(o);return(0,xi.useMemo)(()=>new _(n),[n])},"useSourceMinRequiredBalance"),xb=i((e,t)=>{let r=e?.data.chain.id,n=t?.data.chain.id??r,{data:a}=Ie(),c=(0,xi.useMemo)(()=>a?.addresses.find(d=>d.networkID===n),[a,n]),{data:p=0}=Ro(c);return(0,xi.useMemo)(()=>t?.data.amount||t?.data.balance&&new _(t.data.balance).gt(0)?new _(0):new _(p),[t?.data.amount,t?.data.balance,p])},"useDestinationMinRequiredBalance");function Ab(e){let t=e.type==="pair"?e.sellToken:null,r=e.type==="pair"?e.buyToken:null,o=Tb(t),n=xb(t,r),{data:a}=Ig({networkID:t?.data.chain.id}),{data:c}=Yn(),{data:p}=Xn(),d=(0,bd.useMemo)(()=>!t||!r?!1:$t(t.data.chain.id,r.data.chain.id),[t,r]);return(0,bd.useMemo)(()=>t?bb({sellFungible:t,totalFees:new _(0),transactionSpeedsToUnitCost:A.isEVMNetworkID(t.data.chain.id)?a:void 0,isBridge:d,minRequiredBalance:{source:o,destination:n},customPriorityFee:Sd(c??0),customTip:Sd(p??0)}):"0",[t,a,d,o,n,c,p])}i(Ab,"useGetMaxSellAmount");u();l();var Yr=Ye(e=>({preferredProvider:void 0,setPreferredProvider:i(t=>e({preferredProvider:t}),"setPreferredProvider")}));u();l();var Fb=P(O());u();l();var Eb=i(()=>Dt({key:_e.SlippageTolerance,queryKey:we.slippageTolerance()}),"useSlippageTolerance"),UJ=i(()=>Nt({key:_e.SlippageTolerance,queryKey:we.slippageTolerance()}),"useSetSlippageTolerance");u();l();var kb=P(O());var Jn;(function(e){e.Auto="auto",e.Fixed="fixed"})(Jn||(Jn={}));var hP={type:Jn.Auto},Cb=i(()=>{let{priorityFeeSetting:e,isFetched:t,save:r}=yP();return{isFetched:t,selectedSetting:e,setPriorityFeeSetting:r}},"usePriorityFeeSettings"),yP=i(()=>{let{data:e,isFetched:t}=Dt({key:_e.PriorityFeeSettings,queryKey:we.priorityFeeSettings()}),{mutateAsync:r}=Nt({key:_e.PriorityFeeSettings,queryKey:we.priorityFeeSettings()}),o=(0,kb.useCallback)(async n=>{await r(n)},[r]);return{isFetched:t,priorityFeeSetting:e??hP,save:o}},"usePriorityFeeSettingsStore");u();l();var _b=P(O());var es;(function(e){e.Auto="auto",e.Fixed="fixed"})(es||(es={}));var wP={type:es.Auto},Ib=i(()=>{let{tipSetting:e,isFetched:t,save:r}=SP();return{isFetched:t,selectedSetting:e,setTipSetting:r}},"useTipSettings"),SP=i(()=>{let{data:e,isFetched:t}=Dt({key:_e.TipSettings,queryKey:we.tipSettings()}),{mutateAsync:r}=Nt({key:_e.TipSettings,queryKey:we.tipSettings()}),o=(0,_b.useCallback)(async n=>{await r(n)},[r]);return{isFetched:t,tipSetting:e??wP,save:o}},"useTipSettingsStore");var vb=i(()=>{let{selectedSetting:e}=fo(),{data:t}=Eb(),{data:r}=Yn(),{selectedSetting:o}=Cb(),{data:n}=Xn(),{selectedSetting:a}=Ib(),c=Yr(d=>d.preferredProvider),p=ln("kill-swapper-simulation")??!1;return(0,Fb.useMemo)(()=>({slippageTolerance:t??void 0,priorityFee:o.type==="fixed"?r??void 0:void 0,tipAmount:a.type==="fixed"?n??void 0:void 0,slippageType:e.type,preferredProvider:c,isSimulationKilled:p}),[t,r,o.type,n,a.type,e,c,p])},"useQuoteConfig");u();l();var Pb=P(O());var Rb=i(()=>{let{data:e,isFetched:t}=Yn(),{data:r,isFetched:o}=Xn();return(0,Pb.useMemo)(()=>{if(!t||!o||!e&&!r)return;let n={};return e&&(n.priorityFee=new _(e)),r&&(n.tip=new _(r)),n},[t,o,e,r])},"useSwapModeSettings");u();l();var wt=P(O());var bP=i((e,t=[],r)=>{let o=ot(),n=Se(),a;try{a=yb().nextGenAnalytics}catch{}let c=(0,wt.useMemo)(()=>a||new au(n,r),[n,r,a]),p=ze("enable-be-swapper-max-amount"),[d,m]=(0,wt.useState)([]),[f,h]=(0,wt.useState)(o.getTokenState());(0,wt.useEffect)(()=>{let F=o.subscribeToken({onStateChange(G,$,X){h(X)}});return()=>F()},[o,h]);let[y,w]=(0,wt.useState)(o.getQuoteProcessorState());(0,wt.useEffect)(()=>{let F=o.subscribeQuoteProcessor({onStateChange:i((G,$)=>{$.type==="firstQuoteReceived"&&c.swapperQuotesResult($.input,$.response,$.quote),w($),bo.processQuoteProcessorState($)},"onStateChange")});return()=>{o.stopQuoteProcessor(),F()}},[o,c]);let S=(0,wt.useMemo)(()=>xP(f,y),[f,y]),T=vb();(0,wt.useEffect)(()=>{o.setQuoteConfig(T)},[T,o]);let b=Ab(f),x=(0,wt.useMemo)(()=>At(f)?Sb({sellTokenPrice:f.sellTokenPrice,allowedPercentages:t,maxSellAmount:p?f.maxSellAmount:new _(b)}):[],[f,t,p,b]),E=Yr(F=>F.setPreferredProvider);(0,wt.useEffect)(()=>{let F=o.subscribeToken({onStateChange(G,$,X){G.type==="initializeStarted"&&E(void 0)}});return()=>F()},[o,E]);let C=(0,wt.useCallback)(({amount:F,denomination:G,perspective:$,tokenStateOverride:X})=>{try{let H=TP(X??f,F,G,$),ve=wb(H,x,e,$);m(ve),E(void 0),o.setAmount({amount:H,perspective:$},{...T,preferredProvider:void 0})}catch(H){R.captureError(H,U.Swapper)}},[f,x,e,E,o,T]),{connection:I}=Tn(),B=Tt(),Q=dn(),N=Yi(),Z=v.language,q=ln("kill-swapper-simulation")??!1,k=(0,wt.useCallback)(async F=>{F.forEach($=>o.subscribeExecution($));let G=await n.getDeviceId();await o.swap({signer:Q,storage:B,locale:Z,deviceId:G,connection:I,authRepository:N,isSimulationKilled:q}),F.forEach($=>o.unsubscribeExecution($))},[o,n,Q,B,Z,I,N,q]);return{setAmount:C,swap:k,tokenState:f,quoteProcessorState:y,quotedAmounts:S,inputErrors:d,sellPercentages:x}},"useSwapperQuotes");function TP(e,t,r,o){if(!At(e))throw new Error("Token state is not a pair");let{sellTokenPrice:n,sellToken:a,buyToken:c,buyTokenPrice:p}=e;switch(r){case"fiat":switch(o){case"buy":if(!p?.usd)throw new Error("Token price not found");return new _(t).dividedBy(p.usd).decimalPlaces(c.data.decimals).toString();case"sell":if(!n?.usd)throw new Error("Token price not found");return new _(t).dividedBy(n.usd).decimalPlaces(a.data.decimals).toString()}break;case"crypto":switch(o){case"buy":return new _(t).decimalPlaces(c.data.decimals).toString();case"sell":return new _(t).decimalPlaces(a.data.decimals).toString()}break}}i(TP,"parseAmount");function xP(e,t){if(!At(e)||t.type!=="firstQuoteReceived"&&t.type!=="quoteProcessed")return;let r=t.quote,{sellToken:o,buyToken:n,sellTokenPrice:a,buyTokenPrice:c}=e;return{buyAmount:new _(r.buyAmount).shiftedBy(-n.data.decimals),buyAmountUsd:c?.usd?new _(r.buyAmount).shiftedBy(-n.data.decimals).multipliedBy(c.usd):void 0,sellAmount:new _(r.sellAmount).shiftedBy(-o.data.decimals),sellAmountUsd:a?.usd?new _(r.sellAmount).shiftedBy(-o.data.decimals).multipliedBy(a.usd):void 0}}i(xP,"parseQuoteAmounts");u();l();function Db(e){switch(e.type){case Te.SlippageExceeded:return v.t("swapTxConfirmationSwapFailedSlippageLimit");case Te.InsufficientFunds:return v.t("swapTxConfirmationSwapFailedInsufficientBalance");case Te.InsufficientGas:return v.t("swapTxConfirmationSwapFailedInsufficientGas");case Te.AccountFrozen:return v.t("swapTxConfirmationSwapFailedAcountFrozen");case Te.SimulationTimeout:return v.t("swapTxConfirmationSwapFailedSimulationTimeout");case Te.StaleQuote:return v.t("swapTxConfirmationSwapFailedStaleQuote");case Te.UnknownError:return v.t("swapTxConfirmationSwapFailedSimulationUnknownError");default:return v.t("swapTxConfirmationSwapFailedTryAgain")}}i(Db,"getSimulationErrorMessage");u();l();var bT=P(Be());var Xr=P(O());u();l();var Td=class{static{i(this,"FullBalanceDisplayStrategy")}format(t,r){return`${cr(t)} ${r}`}},xd=class{static{i(this,"CompactBalanceDisplayStrategy")}format(t,r){return`${bn(t,{compact:!0})} ${r}`}},Ad=class{static{i(this,"CompactNoSymbolBalanceDisplayStrategy")}format(t){return bn(t,{compact:!0})}};function Ed(e){switch(e){case"full":return new Td;case"compact":return new xd;case"compactNoSymbol":return new Ad}}i(Ed,"createBalanceDisplayStrategy");u();l();var cu=class{static{i(this,"DefaultGetSwapQuotesStrategy")}async fetch(t){return await $a(t)}stopFetching(){}getFetchInterval(t){return t}};u();l();u();l();var ts=class{static{i(this,"QuoteLoggerExecuteSwapStateListener")}streamedQuoteLogger;constructor(t){this.streamedQuoteLogger=t}onStateChange(t,r,o){o.type===be.TransactionSubmitted&&this.streamedQuoteLogger.logState(o.txReceipt.id)}};u();l();u();l();u();l();var uu=i((e,t,r)=>{if(r)return ke(e,t).times(_(r)).toNumber()},"getAssetVolumeUsd"),Nb=i((e,t)=>t&&e?t>e?t:e:t??e,"getTotalUsdVolume");function Bb({buyAssetUsdValue:e,buyToken:t,sellAssetUsdValue:r,sellToken:o,buyAmount:n,sellAmount:a,phantomFeeUiAmount:c,priceImpact:p,provider:d,baseProvider:m,slippageTolerance:f,slippageType:h,sellSwapFilter:y,isRetry:w,analyticsContext:S}){if(t&&o){let T=uu(n,t.data.decimals,e),b=uu(a,o.data.decimals,r),x=Nb(T,b);return{networkId:o.data.chain.id,chainId:A.getChainID(o.data.chain.id),toNetworkId:t.data.chain.id,toChainId:A.getChainID(t.data.chain.id),isBridge:o.data.chain.id!==t.data.chain.id,marketName:`${o.data.symbol}/${t.data.symbol}`,tradeDirection:"sell",swapSource:d,baseProvider:m,priceImpact:p,fromAssetSymbol:o.data.symbol??"",fromAssetAddress:o.data.tokenAddress,fromAssetAmount:ke(a,o.data.decimals),fromAssetUsdPrice:r,fromAssetUsdVolume:b,toAssetSymbol:t.data.symbol??"",toAssetAddress:t.data.tokenAddress,toAssetAmount:ke(n,t.data.decimals),toAssetUsdPrice:e,toAssetUsdVolume:T,totalUsdVolume:x,feeUsd:c,slippageTolerance:f,slippageType:h,sellSwapFilter:y,isRetry:w,analyticsContext:S}}return null}i(Bb,"legacyAnalyticsPayload");function lu({buyAssetUsdValue:e,buyToken:t,sellAssetUsdValue:r,sellToken:o,quote:n,slippageTolerance:a,slippageType:c,sellSwapFilter:p,isRetry:d,analyticsContext:m,baseProvider:f}){if(t&&o){let{buyAmount:h,sellAmount:y}=n,w="priceImpact"in n?n.priceImpact:0,S="sources"in n?De(n.sources):"",T=("fees"in n?n.fees.find(C=>C.type==="phantom")?.amount.toString():"")??"",b=uu(h,t.data.decimals,e),x=uu(y,o.data.decimals,r),E=Nb(b,x);return{chainId:o.data.chain.id??t.data.chain.id,swap:{marketName:`${o.data.symbol}/${t.data.symbol}`,tradeDirection:"sell",swapSource:S,priceImpact:w,fromAssetSymbol:o.data.symbol??"",fromAssetAddress:o.data.tokenAddress??"",fromAssetAmount:ke(y,o.data.decimals),fromAssetUsdPrice:r??0,fromAssetUsdVolume:x??0,toAssetSymbol:t.data.symbol??"",toAssetAddress:t.data.tokenAddress??"",toAssetAmount:ke(h,t.data.decimals),toAssetUsdPrice:e,toAssetUsdVolume:b,totalUsdVolume:E??0,feeUsd:Number(T),slippageTolerance:a,slippageType:c,sellSwapFilter:p,isRetry:d,analyticsContext:m,baseProvider:f}}}return null}i(lu,"analyticsPayload");function Lb({buyAssetUsdValue:e,buyToken:t,sellAssetUsdValue:r,sellToken:o,buyAmount:n,sellAmount:a,phantomFeeUiAmount:c,priceImpact:p,provider:d,baseProvider:m,slippageTolerance:f,transactionId:h,slippageType:y,sellSwapFilter:w,isRetry:S,analyticsContext:T}){let b=Bb({buyAssetUsdValue:e,buyToken:t,sellAssetUsdValue:r,sellToken:o,buyAmount:n,sellAmount:a,phantomFeeUiAmount:c,priceImpact:p,provider:d,baseProvider:m,slippageTolerance:f,slippageType:y,sellSwapFilter:w,isRetry:S,analyticsContext:T});return b?{data:{...b,id:h}}:{}}i(Lb,"getAnalyticsPayload");u();l();var Ub=i(({txReceipt:e,networkID:t,amountType:r,swapAnalytics:o,walletAddress:n})=>{let a=Rs(t);R.addBreadcrumb(U.Swapper,"submittedTransaction",Y.Info,{...a,txReceipt:e.id,method:a.chainType===ye.Solana?"signAndSendTransaction":a.chainType===ye.EVM?"eth_sendRawTransaction":a.chainType===ye.Sui?"signAndExecuteTransaction":"UNKNOWN"}),a.chainType===ye.Solana?o.submittedTransaction(e.id,{...a,method:"signAndSendTransaction",swapType:r==="sell"?"exactIn":"exactOut",walletAddress:n}):a.chainType===ye.EVM?o.submittedTransaction(e.id,{...a,method:"eth_sendRawTransaction",swapType:r==="sell"?"exactIn":"exactOut",walletAddress:n}):a.chainType===ye.Sui&&o.submittedTransaction(e.id,{...a,method:"signAndExecuteTransaction",swapType:r==="sell"?"exactIn":"exactOut",walletAddress:n})},"logTransactionSubmitted");u();l();var Mb=P(O());var AP={calculate(e){let t=(e?.fees??[]).find(r=>r.type==="phantom");return{amount:new _(t?.amount??0),amountUsd:null,pct:t?.percentage??0}}},EP={calculate(e){let t=e.steps.flatMap(r=>r.feeCosts).find(r=>r.name==="phantom");return{amount:new _(t?.amount??0),amountUsd:null,pct:parseFloat(t?.percentage??"0")}}},Ob=i(()=>{let{currentQuote:e}=rt();return{phantomFee:(0,Mb.useMemo)(()=>kd(e),[e])}},"usePhantomFee");function kd(e){return Ar(e)?AP.calculate(e):se(e)?EP.calculate(e):To}i(kd,"calculatePhantomFee");u();l();var Qb=i(e=>e?se(e)?void 0:e.priceImpact:0,"getSwapPriceImpact");u();l();var qb=Ye(e=>({lastFailedSwap:void 0,setLastFailedSwap:i(t=>{e({lastFailedSwap:t})},"setLastFailedSwap")}));function zb(){return qb.getState().lastFailedSwap}i(zb,"getLastFailedSwap");function Cd(e){qb.getState().setLastFailedSwap(e)}i(Cd,"setLastFailedSwap");var rs=class{static{i(this,"AnalyticsExecuteSwapStateListener")}swapAnalytics;analytics;uiContext;additionalAnalyticsTags;constructor(t,r,o="swapperClassic",n){this.swapAnalytics=t,this.analytics=r,this.uiContext=o,this.additionalAnalyticsTags=n}captureEvent(t,r){let o={...r,data:{...r?.data,...this.additionalAnalyticsTags}};this.analytics.capture(t,o)}onStateChange(t,r,o,n){switch(t.type){case V.ExecuteSwapStarted:this.captureEvent("swapperSwap",{data:{...this.createAnalyticsPayload(o.executingQuote).data,uiContext:this.uiContext}});let a=lu({buyAssetUsdValue:o.executingQuote.buy.data.usd,buyToken:o.executingQuote.buy,sellAssetUsdValue:o.executingQuote.sell.data.usd,sellToken:o.executingQuote.sell,quote:o.executingQuote.quote,slippageTolerance:this.parseSlippageTolerance(o.executingQuote.slippageType,o.executingQuote.quote,o.executingQuote.response),slippageType:o.executingQuote.slippageType,sellSwapFilter:j.getState().swapFilter,isRetry:this.isRetry(o.executingQuote),analyticsContext:o.executingQuote.quote.analyticsContext,baseProvider:o.executingQuote.quote.baseProvider?.id??""});a&&(R.addBreadcrumb(U.Swapper,"approved",Y.Info,un(a.swap)),this.swapAnalytics.approved(a));break;case V.SimulationFailed:t.error.type!==Te.SlippageExceeded&&R.captureError(t.error,U.Swapper),this.captureEvent("swapperSwapFailure",{data:{...this.createAnalyticsPayload(o.executingQuote).data,error:kP(t.error)}});break;case V.TransactionSubmissionFailed:R.captureError(t.error,U.Swapper),t.error.type==="noSignature"&&this.captureEvent("swapperSwapFailureNoSignature"),this.captureEvent("swapperSwapFailure",{data:{...this.createAnalyticsPayload(o.executingQuote).data,error:t.error.message,uiContext:this.uiContext}});break;case V.TransactionSubmissionSuccess:Ub({txReceipt:t.txReceipt,networkID:t.txReceipt.networkID,amountType:o.executingQuote.amount.perspective==="buy"?"buy":"sell",swapAnalytics:this.swapAnalytics});break;case V.TransactionConfirmationFailed:let c=$c(t.error);R.captureError(t.error,U.Swapper),this.captureEvent("swapperSwapFailure",{data:{...this.createAnalyticsPayload(o.executingQuote).data,error:c.message,uiContext:this.uiContext}});let p=Rs(t.txReceipt.networkID),d={chainId:A.getChainID(t.txReceipt.networkID),networkId:t.txReceipt.networkID},m=t.txReceipt;switch(this.captureEvent("waitForTransactionConfirmationError",{data:{...d,errorMessage:c.message}}),p.chainType){case ye.EVM:case ye.Solana:case ye.Sui:R.addBreadcrumb(U.Swapper,"transactionStatus",Y.Error,{...p,txReceipt:m.id}),this.swapAnalytics.transactionStatus(m.id,{...p,status:{type:"error"}});break}break;case V.TransactionConfirmed:this.captureEvent("swapperSwapSuccess",{data:{...this.createAnalyticsPayload(o.executingQuote,t.txReceipt).data,uiContext:this.uiContext}});let f=Rs(t.txReceipt.networkID);switch(R.addBreadcrumb(U.Swapper,"transactionStatus",Y.Info,{...f,txReceipt:t.txReceipt.id}),f.chainType){case ye.EVM:case ye.Solana:case ye.Sui:this.swapAnalytics.transactionStatus(t.txReceipt.id,{...f,status:{type:"confirmed"}});break}break}this.isFailureEvent(t)?Cd(o.executingQuote):t.type===V.TransactionSubmissionSuccess&&Cd(void 0)}createAnalyticsPayload(t,r){let o=t.quote,n=j.getState(),a=Lb({buyToken:t.buy,sellToken:t.sell,buyAmount:o.buyAmount.toString(),sellAmount:o.sellAmount.toString(),phantomFeeUiAmount:kd(o).amountUsd?.toString()??"",priceImpact:Qb(o),provider:De(Oe(o)),buyAssetUsdValue:n.buyUsdValue,sellAssetUsdValue:n.sellUsdValue,slippageTolerance:this.parseSlippageTolerance(t.slippageType,o,t.response),transactionId:r?.id??"",slippageType:t.slippageType,sellSwapFilter:n.swapFilter,isRetry:this.isRetry(t),analyticsContext:t.quote.analyticsContext,baseProvider:t.quote.baseProvider?.id??""}),c=t.quoteInput;return c?{data:{...a.data,...bi(c,o)}}:a}parseSlippageTolerance(t,r,o){switch(t){case ce.Fixed:return o.slippageTolerance;case ce.Auto:return Ar(r)?r.slippageTolerance:o.slippageTolerance}}isRetry(t){let r=zb();if(!r)return!1;let o=M(te(r.buy)),n=M(te(r.sell)),a=M(te(t.buy)),c=M(te(t.sell));return o===a&&n===c}isFailureEvent(t){switch(t.type){case V.SimulationFailed:case V.TransactionSubmissionFailed:case V.TransactionConfirmationFailed:return!0;default:return!1}}};function kP(e){switch(e.type){case Te.SlippageExceeded:return W.SlippageExceeded;case Te.InsufficientFunds:return W.InsufficientFunds;case Te.InsufficientGas:return W.InsufficientGas;case Te.AccountFrozen:return W.AccountFrozen;case Te.StaleQuote:return W.StaleQuote;case Te.SimulationTimeout:return W.SimulationTimeout;case Te.UnknownError:return W.SimulationUnknownError;case Te.SimulationFailed:return"SIMULATION_FAILED";default:return W.NotValidScanResultsError}}i(kP,"toSimulationErrorMessage");u();l();u();l();function Gb(e,t){let r=we.optimisticUpdates(),o=e.getQueryData(r)??[];e.setQueryData(r,[...o.filter(n=>n.id!==t.id),t])}i(Gb,"pushOptimisticUpdate");function Kb(e){return`${e.type}-${e.data.key}`}i(Kb,"getOptimisticUpdateKey");var os=class{static{i(this,"ConfirmationExecuteSwapStateListener")}queryClient;storage;authRepository;constructor(t,r,o){this.queryClient=t,this.storage=r,this.authRepository=o}onStateChange(t,r,o,n){let{sell:a,quote:c,account:p}=o.executingQuote;if(t.type===V.TransactionConfirmed){this.storage.set(_e.PriorityFee,null),this.storage.set(_e.PriorityFeeSettings,{type:Jn.Auto}),this.queryClient.setQueryData(we.priorityFee(),null),this.queryClient.setQueryData(we.priorityFeeSettings(),{type:Jn.Auto}),this.storage.set(_e.TipAmount,null),this.storage.set(_e.TipSettings,{type:es.Auto}),this.queryClient.setQueryData(we.tipAmount(),null),this.queryClient.setQueryData(we.tipSettings(),{type:es.Auto});let d=new L(a.data.amount),m=new L(c.sellAmount),f=d.minus(m).toString();Gb(this.queryClient,{id:Kb(a),amount:f}),this.queryClient.invalidateQueries({queryKey:bg.tokens(p.addresses)}),this.queryClient.invalidateQueries({queryKey:Rg.tokenBalance({wallets:p.addresses,encodedCaip19:M(te(a))})})}}};u();l();u();l();var pu=class{static{i(this,"SimulationAnalytics")}#e;constructor(t){this.#e=t}onScannedMessageByUser=i(t=>{this.#e.capture("simulation",{data:{simulation:{...t,type:"message",status:"success"}}})},"onScannedMessageByUser");onFailedScannedMessageByUser=i(t=>{this.#e.capture("simulation",{data:{simulation:{...t,type:"message",status:"error"}}})},"onFailedScannedMessageByUser");onScannedTransactionByUser=i(t=>{this.#e.capture("simulation",{data:{simulation:{...t,type:"transaction",status:"success"}}})},"onScannedTransactionByUser");onFailedScannedTransactionByUser=i(t=>{this.#e.capture("simulation",{data:{simulation:{...t,type:"transaction",status:"error"}}})},"onFailedScannedTransactionByUser");onSkippedTransactionByUser=i(t=>{this.#e.capture("simulation",{data:{simulation:{...t,type:"transaction",status:"skipped"}}})},"onSkippedTransactionByUser")};var jb="swap-validation",ns=class{static{i(this,"SimulationAnalyticsExecuteSwapStateListener")}simulationAnalytics;constructor(t){this.simulationAnalytics=new pu(t)}onStateChange(t,r,o){switch(t.type){case V.SimulationPassed:let n=t.scannedTransactionResult;this.simulationAnalytics.onScannedTransactionByUser({networkId:t.networkId,warnings:n.warnings.map(c=>c.severity),shouldBlock:!!n.block,errorCode:n.error??""});break;case V.SimulationFailed:let a=t.error.scannedTransactionResult;if(a){this.simulationAnalytics.onScannedTransactionByUser({networkId:t.networkId,warnings:a.warnings.map(c=>c.severity),shouldBlock:!!a.block,errorCode:a.error??""}),a?.error&&R.addBreadcrumb(jb,`Simulation error: ${JSON.stringify({error:a.error})}`,Y.Info);return}this.simulationAnalytics.onFailedScannedTransactionByUser({networkId:t.networkId,url:t.url}),R.addBreadcrumb("simulation",`networkID: ${t.networkId}, url: ${t.url}, type: transaction`,Y.Info);break;case V.SimulationSkipped:this.simulationAnalytics.onSkippedTransactionByUser({networkId:t.networkId}),R.addBreadcrumb(jb,`Simulation skipped for networkID: ${t.networkId}`,Y.Info);break}}};u();l();u();l();u();l();var ue;(function(e){e.Idle="idle",e.FetchingQuote="fetchingQuote",e.Quote="quote",e.SimulationRequestErrored="simulationRequestErrored",e.SimulationFailed="simulationFailed",e.Simulated="simulated",e.TransactionSubmissionFailed="transactionSubmissionFailed",e.TransactionNotConfirmed="transactionNotConfirmed"})(ue||(ue={}));var CP=10,_P=Ye(e=>({transitions:[],addTransition:i((t,r)=>e(o=>{let n=IP(r,t);return n?{transitions:[n,...o.transitions].slice(0,CP)}:o}),"addTransition")}));function mu(e,t){_P.getState().addTransition(e,t)}i(mu,"addSwapperTransition");function IP(e,t){switch(t.type){case ue.Idle:return;case ue.FetchingQuote:return;case ue.Quote:return{sell:Pr(t.response,t.sell,"sell"),buy:Pr(t.response,t.buy,"buy"),sellAmount:t.quote.sellAmount,buyAmount:t.quote.buyAmount,provider:Ai(t.quote),slippage:t.response.slippageTolerance,stateType:t.type,eventType:e.type,timestamp:Date.now()};case ue.SimulationRequestErrored:return{sell:Pr(t.response,t.sell,"sell"),buy:Pr(t.response,t.buy,"buy"),sellAmount:t.quote.sellAmount,buyAmount:t.quote.buyAmount,provider:Ai(t.quote),slippage:t.response.slippageTolerance,stateType:t.type,eventType:e.type,error:t.error,quoteTransactionData:du(t.quote),timestamp:Date.now()};case ue.Simulated:return;case ue.SimulationFailed:return{sell:Pr(t.response,t.sell,"sell"),buy:Pr(t.response,t.buy,"buy"),sellAmount:t.quote.sellAmount,buyAmount:t.quote.buyAmount,provider:Ai(t.quote),slippage:t.response.slippageTolerance,simulationError:t.simulationError,stateType:t.type,eventType:e.type,simulationWarning:t.scannedTransactionResult?.warnings,quoteTransactionData:du(t.quote),simulationHumanReadableError:t.scannedTransactionResult?.simulationError?.humanReadableError,simulationRequestId:t.scannedTransactionResult?.advancedDetails?.requestId,timestamp:Date.now()};case ue.TransactionSubmissionFailed:return{sell:Pr(t.response,t.sell,"sell"),buy:Pr(t.response,t.buy,"buy"),sellAmount:t.quote.sellAmount,buyAmount:t.quote.buyAmount,provider:Ai(t.quote),slippage:t.response.slippageTolerance,error:t.error,stateType:t.type,eventType:e.type,quoteTransactionData:du(t.quote),timestamp:Date.now()};case ue.TransactionNotConfirmed:return{sell:Pr(t.response,t.sell,"sell"),buy:Pr(t.response,t.buy,"buy"),sellAmount:t.quote.sellAmount,buyAmount:t.quote.buyAmount,provider:Ai(t.quote),slippage:t.response.slippageTolerance,stateType:t.type,eventType:e.type,quoteTransactionData:du(t.quote),timestamp:Date.now(),error:t.error};default:return}}i(IP,"toSparseTransition");var Ai=i(e=>{let t=Oe(e);return De(t)},"parseProvider"),Pr=i((e,t,r)=>{switch(r){case"sell":return{caip19:e.sellToken,symbol:t.data.symbol??void 0};case"buy":return{caip19:e.buyToken,symbol:t.data.symbol??void 0}}},"parseTokens"),du=i(e=>{if(!se(e))return e.transactionData},"parseQuoteTransactionData");u();l();var St;(function(e){e.QuoteRequestStarted="quoteRequestStarted",e.QuoteResponseReceived="quoteResponseReceived",e.QuoteSelected="quoteSelected",e.SimulationResponseReceived="simulationResponseReceived",e.SimulationRequestError="simulationRequestError",e.TransactionSubmissionFailed="transactionSubmissionFailed",e.TransactionConfirmationFailed="transactionConfirmationFailed"})(St||(St={}));var ss=class{static{i(this,"TransitionsExecuteSwapStateListener")}onStateChange(t,r,o,n){let a=this.toLegacyTransition(t,o);a&&mu(a.nextState,a.event)}toLegacyTransition(t,r){let{buy:o,sell:n,quote:a,response:c}=r.executingQuote;switch(t.type){case V.SimulationFailed:return{event:{type:St.SimulationRequestError,error:t.error},nextState:{type:ue.SimulationFailed,buy:o,sell:n,response:c,quote:a,scannedTransactionResult:t.error.scannedTransactionResult,simulationError:t.error.message}};case V.TransactionSubmissionFailed:return{event:{type:St.TransactionSubmissionFailed,error:t.error},nextState:{type:ue.TransactionSubmissionFailed,buy:o,sell:n,response:c,quote:a,error:t.error}};case V.TransactionConfirmationFailed:return{event:{type:St.TransactionConfirmationFailed,error:t.error,txReceipt:t.txReceipt},nextState:{type:ue.TransactionNotConfirmed,buy:o,sell:n,response:c,quote:a,error:t.error,txReceipt:t.txReceipt}};default:return}}};u();l();u();l();u();l();u();l();u();l();var Vb=i(e=>{let t,r=new Set,o=i((f,h)=>{let y=typeof f=="function"?f(t):f;if(!Object.is(y,t)){let w=t;t=h??(typeof y!="object"||y===null)?y:Object.assign({},t,y),r.forEach(S=>S(t,w))}},"setState"),n=i(()=>t,"getState"),d={setState:o,getState:n,getInitialState:i(()=>m,"getInitialState"),subscribe:i(f=>(r.add(f),()=>r.delete(f)),"subscribe"),destroy:i(()=>{(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()},"destroy")},m=t=e(o,n,d);return d},"createStoreImpl"),$b=i(e=>e?Vb(e):Vb,"createStore");var sT=P(O(),1),iT=P(rT(),1);var{useDebugValue:VP}=sT.default,{useSyncExternalStoreWithSelector:$P}=iT.default,oT=!1,HP=i(e=>e,"identity");function WP(e,t=HP,r){(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&r&&!oT&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),oT=!0);let o=$P(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return VP(o),o}i(WP,"useStore");var nT=i(e=>{(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");let t=typeof e=="function"?$b(e):e,r=i((o,n)=>WP(t,o,n),"useBoundStore");return Object.assign(r,t),r},"createImpl"),ZP=i(e=>e?nT(e):nT,"create"),aT=i(e=>((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&console.warn("[DEPRECATED] Default export is deprecated. Instead use `import { create } from 'zustand'`."),ZP(e)),"react");u();l();var Ao;(function(e){e.Failed="Failed",e.Progress="Progress",e.Success="Success",e.Default="Default"})(Ao||(Ao={}));var YP=3e3,Jt=aT(e=>({toast:void 0,toastId:void 0,visible:!1,currentTimer:null,hideToast(t){e(r=>t&&r.toastId!==t?r:(r.currentTimer&&clearTimeout(r.currentTimer),{visible:!1,currentTimer:null}))},removeToast(){e(t=>(t.currentTimer&&clearTimeout(t.currentTimer),{toast:void 0,toastId:void 0,visible:!1,currentTimer:null}))},success(t){e(r=>{r.currentTimer&&clearTimeout(r.currentTimer);let o=setTimeout(()=>{e({visible:!1,currentTimer:null})},YP);return{toast:{type:Ao.Success,...t},toastId:t.id??Ze(),visible:!0,currentTimer:o}})},failed(t){e(r=>(r.currentTimer&&clearTimeout(r.currentTimer),{toast:{type:Ao.Failed,...t},toastId:t.id??Ze(),visible:!0,currentTimer:null}))},progress(t){e(r=>(r.currentTimer&&clearTimeout(r.currentTimer),{toast:{type:Ao.Progress,...t},toastId:t.id??Ze(),visible:!0,currentTimer:null}))},message(t){e(r=>(r.currentTimer&&clearTimeout(r.currentTimer),{toast:{type:Ao.Default,...t},toastId:t.id??Ze(),visible:!0,currentTimer:null}))}}));u();l();var Ei=i(e=>{let t=xo(e);return vr(t)},"getEstimatedTime");u();l();function cT(e,t,r,o){let n=Ve(e),a=n?e:t,c=n?t:e,p=n?r.sellAmount:r.buyAmount,d=ke(p,a.data.decimals),m=ra(d,!0),f=c.data.symbol,h="";return o?h=n?"swapTokenConfirmationBuyToast":"swapTokenConfirmationSellToast":h=n?"swapSwappingCashBuyToast":"swapSwappingCashSellToast",v.t(h,{amount:m,symbol:f})}i(cT,"cashSwapToastMessage");u();l();u();l();function uT({sell:e,buy:t,onBuyFungiblePress:r}){let o=`${v.t("swapTxConfirmationSwapFailed")} ${e.data.symbol} \u2192 ${t.data.symbol}`,n=A.getChainDefinition(e.data.chain.id).tokenSymbol,a=v.t("buyAssetInterpolated",{tokenSymbol:n});return{title:o,message:v.t("swapTabInsufficientFunds"),onPress:r,buttonText:a}}i(uT,"getInsufficientFundsToastProps");function lT(e,t,r,o,n,a){let{sell:c,buy:p}=t,d=XP(e,c,p,n,o,r,a);return d||{title:`${v.t("swapTxConfirmationSwapFailed")} ${c.data.symbol} \u2192 ${p.data.symbol}`,message:Db(e),onPress:i(()=>{Jt.getState().hideToast(),o()},"onPress"),buttonText:v.t("commandRetry")}}i(lT,"createSimulationErrorToast");function XP(e,t,r,o,n,a,c){if(!(e.type&&!c.includes(e.type)))switch(e.type){case Te.InsufficientFunds:return uT({sell:t,buy:r,onBuyFungiblePress:i(()=>{Jt.getState().hideToast(),a()},"onBuyFungiblePress")});case Te.SlippageExceeded:return o.selectedSetting.type===ce.Auto?void 0:{title:v.t("swapEnableAutoSlippageTitleToast",{sellSymbol:t.data.symbol,buySymbol:r.data.symbol}),buttonText:v.t("swapEnableAutoSlippageButtonToast"),message:"",onPress:i(()=>{o.setSlippageSetting({type:ce.Auto}),n(),Jt.getState().hideToast()},"onPress")}}}i(XP,"createCustomSimulationErrorToast");u();l();u();l();var JP=["Ledger App not open","Ledger not connected","Unable to connect to Ledger","Unable to connect to Ledger device","Need permission to connect to Ledger"],eR="Ledger user rejected action",tR="Ledger Sign Error";function pT(e){return JP.some(r=>e.message.includes(r))?v.t("swapTxConfirmationSwapFailedLedgerConnectionError"):e.message.includes(eR)?v.t("swapTxConfirmationSwapFailedLedgerReject"):e.message.includes(tR)?v.t("swapTxConfirmationSwapFailedLedgerSignError"):e.message.toLowerCase().includes("ledger")?v.t("swapTxConfirmationSwapFailedLedgerError"):null}i(pT,"parseLedgerError");function dT({sellSymbol:e,buySymbol:t,error:r,onPress:o}){let n=v.t("unknownToken"),a=`${v.t("swapTxConfirmationSwapFailed")} ${e??n} \u2192 ${t??n}`,c=v.t("commandRetry"),p=v.t("swapTxConfirmationSwapFailedUnknownError"),d=pT(r);return d&&(p=d),{title:a,message:p,onPress:o,buttonText:c}}i(dT,"createSwapFailedToast");var as=class{static{i(this,"ToastExecuteSwapStateListener")}showFungibleDetails;showBuyFungibleScreen;slippageSettings;supportedCustomSimulationToastErrorTypes;retryAndNavigateToSwapper;toastMessageParser;constructor(t,r,o,n,a,c=oR){this.showFungibleDetails=t,this.showBuyFungibleScreen=r,this.slippageSettings=o,this.supportedCustomSimulationToastErrorTypes=n,this.retryAndNavigateToSwapper=a,this.toastMessageParser=c}onStateChange(t,r,o,n){let{sell:a,buy:c,quote:p}=o.executingQuote;switch(t.type){case V.ExecuteSwapStarted:let d;if(se(p)){if(A.isBitcoinNetworkID(a.data.chain.id)){mT(v.t("swapBitcoinSellBridgeProgressToast",{estimatedTime:Ei(p)}),()=>{this.showFungibleDetails(c)});return}A.isBitcoinNetworkID(c.data.chain.id)?d=v.t("swapBitcoinBuyingToast"):d=v.t("swapInitiatingBridgeToast",{sellSymbol:a.data.symbol,sellChain:a.data.chain.name,buySymbol:c.data.symbol,buyChain:c.data.chain.name})}else Ve(a)||Ve(c)?d=cT(a,c,p,!1):d=v.t("swapSwappingToast",{sellSymbol:a.data.symbol,buySymbol:c.data.symbol});rR(d);break;case V.TransactionConfirmed:mT(this.toastMessageParser.parseTransactionConfirmed(a,c,p),()=>this.showFungibleDetails(c));break;case V.SimulationFailed:fT(lT(t.error,o.executingQuote,this.showBuyFungibleScreen,()=>this.handleRetryPress(o.executingQuote),this.slippageSettings,this.supportedCustomSimulationToastErrorTypes));break;case V.TransactionSubmissionFailed:case V.TransactionConfirmationFailed:fT(dT({sellSymbol:a.data.symbol,buySymbol:c.data.symbol,error:t.error,onPress:i(()=>this.handleRetryPress(o.executingQuote),"onPress")}));break}}handleRetryPress(t){Jt.getState().hideToast(),this.retryAndNavigateToSwapper(t)}};function rR(e){Jt.getState().progress({message:e,onPress:i(()=>{Jt.getState().hideToast()},"onPress")})}i(rR,"progress");function mT(e,t){Jt.getState().success({id:"swap-success",message:e,onPress:i(()=>{Jt.getState().hideToast(),t()},"onPress")})}i(mT,"success");function fT(e){Jt.getState().failed(e)}i(fT,"failed");var oR={parseTransactionConfirmed(e,t,r){return se(r)?A.isBitcoinNetworkID(e.data.chain.id)?v.t("swapBitcoinSellBridgeProgressToast",{estimatedTime:Ei(r)}):A.isBitcoinNetworkID(t.data.chain.id)?v.t("swapBitcoinBuyBridgeProgressToast",{estimatedTime:Ei(r)}):v.t("swapBridgeInitiatedToast",{sellSymbol:e.data.symbol,sellChain:e.data.chain.name,buySymbol:t.data.symbol,buyChain:t.data.chain.name,estimatedTime:Ei(r)}):v.t("swapSwappedToast",{sellSymbol:e.data.symbol,buySymbol:t.data.symbol})}};var gu=class{static{i(this,"ToastsSwapReviewInterceptor")}intercept(t){let{swapper:r,connection:o,storage:n,vaultProxy:a,locale:c,analytics:p,resetSwapper:d,queryClient:m,showFungibleDetails:f,showBuyFungibleScreen:h,swapAnalytics:y,gasEstimation:w,slippageSettings:S,supportedCustomSimulationToastErrorTypes:T,navigateToSwapper:b,storePairs:x,isMobile:E,enableExtSwapCommands:C,authRepository:I,isSimulationKilled:B}=t;if(r.getAccount()?.type===Ef.Ledger||!E&&!C)return"continue";let N=r.getState();if(N.type!==Ue.Quote)return"continue";let{quote:Z,sell:q,buy:k}=N;return this.isSupportedQuote(Z)&&(async()=>{x(q,k);let F=await p.getDeviceId(),G=new as(f,h,S,T,dt=>{b(dt)}),$=new os(m,n,I),X=new rs(y,p),H=new ns(p),ve=new ss,He=new ts(bo);try{r.subscribeExecution($),r.subscribeExecution(H),r.subscribeExecution(X),r.subscribeExecution(G),r.subscribeExecution(ve),r.subscribeExecution(He),await r.swap({signer:a,storage:n,locale:c,deviceId:F,connection:o,authRepository:I,isSimulationKilled:B,gasEstimation:w}),d()}catch{}finally{r.unsubscribeExecution($),r.unsubscribeExecution(H),r.unsubscribeExecution(X),r.unsubscribeExecution(G),r.unsubscribeExecution(ve),r.unsubscribeExecution(He)}})(),"continue"}isSupportedQuote(t){return Pt(t)||lr(t)||qr(t)||se(t)}};u();l();var hu=class{static{i(this,"StreamGetSwapQuotesStrategy")}swapper;queryClient;constructor(t,r){this.swapper=t,this.queryClient=r}queryKey;quoteProcessorListener={onStateChange:i((t,r)=>{if(!this.queryKey){console.error("queryKey is not set");return}r.type==="quoteProcessed"&&this.queryClient.setQueryData(this.queryKey,r.response)},"onStateChange")};async fetch(t,r){return this.queryKey=r,this.swapper.unsubscribeQuoteProcessor(this.quoteProcessorListener),new Promise((o,n)=>{let a=nR(t.amount,t.sell,t.buy),c={onStateChange:i((p,d)=>{switch(d.type){case"firstQuoteReceived":o(d.response),this.swapper.unsubscribeQuoteProcessor(c);break;case"error":n(d.error),this.swapper.unsubscribeQuoteProcessor(c),this.swapper.unsubscribeQuoteProcessor(this.quoteProcessorListener);break}},"onStateChange")};this.swapper.subscribeQuoteProcessor(this.quoteProcessorListener),this.swapper.subscribeQuoteProcessor(c),this.swapper.setPair(gT(t.buy),gT(t.sell),a),this.swapper.setAmount(a,{slippageTolerance:t.slippageTolerance,slippageType:t.enableAutoSlippage?ce.Auto:ce.Fixed,priorityFee:t.priorityFee,tipAmount:t.tipAmount,preferredProvider:t.preferredProvider})})}stopFetching(){this.swapper.getQuoteProcessorState().type!=="idle"&&(this.swapper.stopProcessingQuotes(),this.swapper.unsubscribeQuoteProcessor(this.quoteProcessorListener))}getFetchInterval(t){return!1}};function nR(e,t,r){let o=e.type==="sell"?t:r;return{amount:new _(e.value).shiftedBy(-o.data.decimals).toString(),perspective:e.type}}i(nR,"normalizeAmount");function gT(e){return{...e,data:{...e.data,walletAddress:""}}}i(gT,"removeWalletAddress");u();l();u();l();var yu;(function(e){e.AutoSlippageOptIn="autoSlippageOptIn"})(yu||(yu={}));var wu=class{static{i(this,"AutoSlippageOptInInterceptor")}intercept({hasViewedAutoSlippageOptIn:t,selectedSetting:r,setHasViewedAutoSlippageOptIn:o,showOverlay:n}){return!t&&r!==ce.Auto?(n(yu.AutoSlippageOptIn),o(!0),"interrupt"):"continue"}};u();l();var Rd=P(O());u();l();var yT=P(O());u();l();var sR=s.object({swapper:s.number(),review:s.number().nullish().default(null)}),Su={swapper:In.Short,review:null},hT=i(()=>{let e=Vt.getMultivariateAssignment("swapper-poll-interval-json");if(!e)return Su;try{let t=JSON.parse(e);return sR.parse(t)}catch{return Su}},"getQuotePollIntervalConfig");var Ci=i(()=>{let e=ki(n=>n.intervalMs),t=ki(n=>n.state),r=ki(n=>n.setState),o=(0,yT.useCallback)(n=>{r("resumed",n??wT())},[r]);return{state:t,pause:i(()=>r("paused"),"pause"),resume:o,intervalMs:e}},"useQuotePoller"),_i=i(e=>{ki.getState().setState("resumed",e??wT())},"resumePoller"),Pd=i(()=>{ki.getState().setState("paused")},"pausePoller"),wT=i(()=>hT().swapper,"getDefaultInterval"),ki=Ye(e=>({state:"resumed",intervalMs:Su.swapper,setState(t,r){e(r?{state:t,intervalMs:r}:{state:t})}}));var ST=i(()=>{let e=(0,Rd.useCallback)(()=>{_i()},[]),t=(0,Rd.useCallback)(()=>{Pd()},[]);return{onSwapTabEnter:e,onSwapTabExit:t}},"useSwapTabSwitchActions");var TT=(0,Xr.createContext)(void 0),Pie=i(({children:e})=>{let t=[ce.Auto,ce.Fixed],r=[Te.SlippageExceeded],o=(0,Xr.useMemo)(()=>[new wu,new gu],[]),n=!0,a=ot(),c=qe(),p=(0,Xr.useMemo)(()=>Fo?new hu(a,c):new cu,[a,c]),{onSwapTabEnter:d,onSwapTabExit:m}=ST(),f=Zi("trade-hub-variant"),h=ze("enable-replace-classic-ngs"),y=(0,Xr.useMemo)(()=>{if(h||f==="remove-buy-sell")return"remove-buy-sell";if(f==="swapper-modal")return"swapper-modal";if(f==="trade-menu")return"trade-menu"},[f,h]),w=(0,Xr.useMemo)(()=>sr?Ed("full"):Ed("compactNoSymbol"),[]);return(0,bT.jsx)(TT.Provider,{value:{slippageSettingTypes:t,reviewInterceptors:o,showStickyCTAButton:n,getSwapQuotesStrategy:p,supportedCustomSimulationToastErrorTypes:r,onSwapTabEnter:d,onSwapTabExit:m,balanceDisplayStrategy:w,tradeHubVariant:y},children:e})},"SwapTabProvider"),xT=i(()=>{let e=(0,Xr.useContext)(TT);if(!e)throw new Error("useSwapTab must be used within a SwapTabProvider");return e},"useSwapTab");u();l();var $o=P(O());u();l();u();l();var iR=s.enum(["pumpFun","moonshot"]),aR=s.object({type:iR,programId:s.string(),name:s.string(),iconUrl:s.string()}),cR=s.object({programs:s.array(aR)}),AT=i(e=>{try{return cR.parse(e)}catch{return}},"parseUgcPrograms");var uR={type:"pumpFun",programId:"6EF8rrecthR5Dkzon8Nwu78hRvfCKubJ14M5uBEwF6P",name:"Pump.fun",iconUrl:"https://dhc7eusqrdwa0.cloudfront.net/assets/pumpfun.svg"},Dd=[],Jr=i(()=>{try{let e=Vt.getMultivariateAssignment("enabled-ugc-programs");if(!e)return Vt.isFeatureEnabled("enabled-ugc-programs")?[uR]:Dd;let t=JSON.parse(e);return AT(t)?.programs??Dd}catch{return Dd}},"getSupportedUgcPrograms");var lR=s.object({programId:s.string(),complete:s.boolean(),progress:s.string()}),pR=s.object({bondingCurves:s.record(s.string(),lR)}),er;(function(e){e.Loading="Loading",e.BondingCurve="BondingCurve",e.BondingCurveRefreshing="BondingCurveRefreshing",e.NoBondingCurve="NoBondingCurve",e.Graduated="Graduated",e.Error="Error"})(er||(er={}));function dR(e){let t=ET(e),o=qe().getQueryData(t.queryKey),{data:n,isFetching:a,isError:c}=ie({...t,initialData:o,staleTime:0}),p=(0,$o.useMemo)(()=>Jr(),[]);return(0,$o.useMemo)(()=>{let d=o===n;if(a&&!d)return{type:er.Loading};if(c)return{type:er.Error};let m=pR.safeParse(n);if(!m.success)return{type:er.Error};let f=m.data.bondingCurves[e];if(!f)return{type:er.NoBondingCurve};let h=p.find(w=>w.programId===f.programId);if(!h)return{type:er.NoBondingCurve};let y=gR(f.progress);return y?f.complete?{type:er.Graduated,ugcProgram:h}:{type:d&&a?er.BondingCurveRefreshing:er.BondingCurve,progressPercentage:y,ugcProgram:h}:{type:er.Error}},[o,e,n,c,a,p])}i(dR,"useBondingCurveProgress");var mR=i(e=>{let t=qe(),r=ET(e);return(0,$o.useCallback)(async()=>{await t.refetchQueries({queryKey:r.queryKey,type:"active"})},[t,r.queryKey])},"useUgcEnabledAwareBondingCurveRefetch"),ET=i(e=>{let t=(0,$o.useMemo)(()=>Jr(),[]),r=(0,$o.useMemo)(()=>t.map(n=>n.programId),[t]);return{queryKey:["bonding-curve",e,r],queryFn:i(()=>fR(e,r),"queryFn")}},"useQueryOptions"),fR=i(async(e,t)=>{let r=encodeURIComponent(e),o=encodeURIComponent(t.join(","));return(await K.api().get(`/ugc/v1/bonding-curve/${r}/${o}`)).data},"queryFn"),gR=i(e=>{let t=Number(e);if(!isNaN(t))return Math.round(t*100)},"parseProgressPercentage");u();l();var hR="https://help.phantom.com/hc/en-us/articles/33745013398675";u();l();u();l();var IT=P(O());u();l();var yR="swap",wR=i(e=>new Gf(e,yR),"createSwapAnalytics"),bu=Rf(Se,e=>wR(e));u();l();function kT(e,t,r){if(!r)return;if(t===ce.Fixed)return r.slippageTolerance;let o=r.quotes[e];if(o)return se(o)?r.slippageTolerance:Ar(o)?o.slippageTolerance:r.slippageTolerance}i(kT,"parseSlippage");u();l();var Tu=P(O());var _T=i(()=>{let{data:e,isFetching:t}=Dt({key:_e.LastSubmittedPairs,queryKey:we.lastSubmittedPairs()}),r=(0,Tu.useMemo)(()=>e??null,[e]),{mutateAsync:o}=Nt({key:_e.LastSubmittedPairs,queryKey:we.lastSubmittedPairs()}),n=(0,Tu.useCallback)(async(a,c)=>{await o({sellFungible:CT(a),buyFungible:CT(c)})},[o]);return{pairs:r,isLoading:t,storePairs:n}},"useLastSubmittedPairs");function CT(e){return{...e,data:{...e.data,walletAddress:""}}}i(CT,"removeWalletAddress");var SR=i(({goToConfirmation:e})=>{let t=j(T=>T.sellUsdValue),r=j(T=>T.buyUsdValue),{currentQuote:o,quoteResponse:n,selectedProviderIndex:a,selectedBaseProvider:c}=rt(),p=j(T=>T.sellFungible),d=j(T=>T.buyFungible),m=j(T=>T.swapFilter),{selectedSetting:f}=fo(),{storePairs:h}=_T(),y=Se(),w=bu(),{pause:S}=Ci();return(0,IT.useCallback)(()=>{if(!o||!p||!d)return;let T=kT(a,f.type,n);y.capture("swapperSwap");let b=lu({buyToken:d,sellToken:p,sellAssetUsdValue:t,buyAssetUsdValue:r,quote:o,slippageTolerance:T,slippageType:f.type,sellSwapFilter:m,baseProvider:c});b&&(R.addBreadcrumb(U.Swapper,"approved",Y.Info,un(b.swap)),w.approved(b)),S(),e(),A.compareNetworkID(p.data.chain.id,d.data.chain.id)===0&&h(p,d)},[o,p,d,a,f.type,n,y,t,r,S,e,w,h,m,c])},"useOnSwap");u();l();var vT=P(O());u();l();var Nd=P(O());u();l();var bR=s.object({blocked:s.array(s.nativeEnum(ne))}),FT=i(()=>{let e=Zi("blocked-swapper-chains"),t=bR.safeParse(e);return t.success?t.data.blocked:[]},"useBlockedSwapperChains");u();l();function Eo(){return Yt.supportedChains.filter(e=>{let t=Yt.get(e);return t.requiredFeatureFlag?bf(t.requiredFeatureFlag):!0})}i(Eo,"useSwapperChains");var Ho=i(()=>{let{data:e}=Ie(),t=Eo(),r=FT(),o=(0,Nd.useMemo)(()=>t.filter(n=>!r.includes(n)).map(n=>A.getMainnetNetworkID(n)),[t,r]);return(0,Nd.useMemo)(()=>TR(e,o),[e,o])},"useSupportedNetworkIDs"),TR=i((e,t)=>[...new Set((e?.addresses??[]).map(r=>r.networkID).filter(r=>t.includes(r)))],"getSupportedNetworkIDs");var Bd=i(()=>{let e=Ho(),t=ze("enable-bitcoin-swap");return(0,vT.useCallback)(r=>!t&&r&&A.isBitcoinNetworkID(r)?!1:!!r&&e.includes(r),[e,t])},"useIsSupportedNetworkId");u();l();var Eu=P(O());u();l();u();l();var xu=class{static{i(this,"SwapperTransitionsStateListener")}onStateChange(t,r,o){mu(o,t)}};u();l();var Au=class{static{i(this,"SwapperStateMachine")}listeners;constructor(t){this.listeners=t}transition(t,r){try{let o=this.detectNextState(t,r);return this.listeners.forEach(n=>n.onStateChange(r,t,o)),o}catch{return t}}detectNextState(t,r){switch(r.type){case St.QuoteRequestStarted:return{type:ue.FetchingQuote,buy:r.buy,sell:r.sell,amount:r.amount};case St.QuoteResponseReceived:switch(t.type){case ue.FetchingQuote:case ue.Quote:case ue.Simulated:case ue.SimulationRequestErrored:case ue.TransactionSubmissionFailed:case ue.TransactionNotConfirmed:let o=r.response.quotes[r.quoteIndex];if(!o)throw new Error("Quote index out of bounds");return{type:ue.Quote,response:r.response,buy:t.buy,sell:t.sell,quote:o};default:throw new Error("Can't transition from this state")}case St.QuoteSelected:switch(t.type){case ue.Quote:let o=t.response.quotes[r.quoteIndex];if(!o)throw new Error("Quote index out of bounds");return{type:ue.Quote,quote:o,buy:t.buy,sell:t.sell,response:t.response};default:throw new Error("Can only transition to QuoteChanged from Quote")}case St.SimulationResponseReceived:switch(t.type){case ue.Quote:return r.scannedTransactionResult.error?{type:ue.SimulationFailed,quote:t.quote,buy:t.buy,sell:t.sell,response:t.response,scannedTransactionResult:r.scannedTransactionResult,simulationError:r.scannedTransactionResult.error}:{type:ue.Simulated,quote:t.quote,buy:t.buy,sell:t.sell,response:t.response,scannedTransactionResult:r.scannedTransactionResult};default:throw new Error("Can only transition to Simulated from Simulating")}case St.SimulationRequestError:switch(t.type){case ue.Quote:return{type:ue.SimulationRequestErrored,buy:t.buy,sell:t.sell,quote:t.quote,response:t.response,error:r.error};default:throw new Error("Can only transition to SimulationRequestErrored from Simulating")}case St.TransactionSubmissionFailed:switch(t.type){case ue.Simulated:case ue.SimulationFailed:return{type:ue.TransactionSubmissionFailed,quote:t.quote,buy:t.buy,sell:t.sell,response:t.response,scannedTransactionResult:t.scannedTransactionResult,error:r.error};default:throw new Error("Can only transition to SwapSubmitFailed from SubmittingSwap")}case St.TransactionConfirmationFailed:switch(t.type){case ue.Simulated:return{type:ue.TransactionNotConfirmed,quote:t.quote,buy:t.buy,sell:t.sell,txReceipt:r.txReceipt,response:t.response,scannedTransactionResult:t.scannedTransactionResult,error:r.error};default:throw new Error("Can only transition to TransactionNotConfirmed from ConfirmingTransaction")}}}};var xR=new Au(new Set([new xu])),PT=Ye(e=>({state:{type:ue.Idle},transition:i(t=>{e(r=>{let o=r.state;return{state:xR.transition(o,t)}})},"transition")}));var RT=i(()=>{let e=PT(r=>r.state),t=PT(r=>r.transition);return{state:e,transition:t}},"useSwapperState");u();l();var AR=5*60,DT=i(e=>{if(se(e))return De(vn(e));let{sources:t}=e;return De(t)},"getProviderLabel"),NT=i(({quotes:e,buyTokenNetworkId:t,buyTokenDecimals:r,buyTokenSymbol:o})=>e.map(n=>{let{buyAmount:a}=n,c=ar.get(t).formDisplayPrecision;return{name:DT(n),amount:`${cr(ke(a,r),c)} ${o}`}}),"parseSwapProviders"),BT=i(({quotes:e,buyTokenNetworkId:t,buyTokenDecimals:r,buyTokenSymbol:o,networkIDForFees:n,networkFee:a,priceMap:c})=>e.filter(se).map(p=>{let{buyAmount:d,executionDuration:m,steps:f}=p,y=iu(p).plus(a),w=f.find(T=>!!T.tool.logoURI),S=ar.get(t).formDisplayPrecision;return{name:DT(p),feeUsd:n&&c?qt(n,y,c):null,amount:`${cr(ke(d,r),S)} ${o}`,time:{text:vr(m),isFast:m<=AR},logoURI:w?.tool.logoURI??""}}),"parseBridgeProviders");u();l();var ER={aggregate(e){return e.reduce((t,r)=>({...t,gasLimit:t.gasLimit.plus(r.gasLimit)}),{networkID:A.ethereum.mainnetID,gasLimit:new L(0),maxFeePerGas:e[0].maxFeePerGas,maxPriorityFeePerGas:e[0].maxPriorityFeePerGas})}},kR={aggregate(e){return e.reduce((t,r)=>({...t,value:t.value+r.value}),{networkID:A.solana.mainnetID,value:0})}},CR={aggregate(e){return e.reduce((t,r)=>({...t,gasBudget:t.gasBudget.plus(r.gasBudget)}),{networkID:A.sui.mainnetID,gasBudget:new L(0)})}},Ii=i(e=>{if(!(!e||e.length===0)){if(ia(e[0]))return ER.aggregate(e);if(Zf(e[0]))return kR.aggregate(e);if(Yf(e[0]))return CR.aggregate(e)}},"aggregateGasEstimation");function _R({selectQuote:e}){let{quoteResponse:t,isFetchingQuote:r,quotes:o,selectedProviderIndex:n}=rt(),a=j(C=>C.setSelectedProviderIndex),c=j(C=>C.gasEstimation.estimateWithBuffer),p=j(C=>C.sellFungible),d=j(C=>C.buyFungible),m=p?.data.chain.id,{data:f}=Ds(m,Ii(c)),y=Eo().map(C=>hr(C)),{data:w={}}=ao({query:{data:y}}),S=t?.type==="xchain",T=(0,Eu.useMemo)(()=>d?S?BT({quotes:o,buyTokenNetworkId:d.data.chain.id,buyTokenDecimals:d.data.decimals,buyTokenSymbol:d.data.symbol,networkIDForFees:m,networkFee:f?.gasEstimationAmount??new L(0),priceMap:w}):NT({quotes:o,buyTokenNetworkId:d.data.chain.id,buyTokenDecimals:d.data.decimals,buyTokenSymbol:d.data.symbol}):[],[d,S,o,m,f?.gasEstimationAmount,w]),b=Se(),{transition:x}=RT(),E=(0,Eu.useCallback)(C=>{let I=T[C];b.capture("swapperProviderSelected",{data:{provider:I.name}}),a(C),e(o,C),x({type:St.QuoteSelected,quoteIndex:C})},[a,T,b,x,o,e]);return{rows:T,selectedProviderIndex:n,isLoadingProviders:r,setSelectedProviderIndex:E}}i(_R,"useSwapProvidersProps");u();l();var _u=P(O());u();l();var UT=P(O());u();l();var LT=P(O());var ku=i(()=>{let e=qe();return{cancelQuotes:(0,LT.useCallback)(async()=>{await e.cancelQueries({queryKey:we.quotesScope()}),await _f(1)},[e])}},"useSwapCancelQuotes");u();l();function Wo(e,t){return e.data.key===t.data.key}i(Wo,"areFungiblesEqual");function Ld(){let e=Se(),t=j(n=>n.setBuyFungible),r=j(n=>n.buyFungible),{cancelQuotes:o}=ku();return(0,UT.useCallback)(async n=>{if(r&&Wo(n,r))return;await o();let a=Vo(n);e.capture("swapperUpdateToAsset",{data:a}),t(n)},[e,r,o,t])}i(Ld,"useSwapSetBuyAsset");u();l();var Que=i((e,t)=>{Cu.getState().setAsset(e,t)},"setUgcSelectedAsset"),Cu=Ye(e=>({asset:void 0,onConfirm:void 0,setAsset(t,r){e({asset:t,onConfirm:r})}}));var IR=i(({onClose:e})=>{let t=ot(),r=Ld(),o=Cu(p=>p.asset),n=Cu(p=>p.onConfirm),a=(0,_u.useMemo)(()=>Jr().find(d=>d.programId===o?.data?.ugcTokenMeta?.programId),[o]),c=(0,_u.useCallback)(async()=>{o&&(t.changeToken(o,"buy"),await r(o),n?.(),e())},[r,t,o,n,e]);return{asset:o,program:a,handleConfirmPress:c}},"useUGCTradeWarningProps");u();l();u();l();var FR=i(()=>{let e=qe(),t=j();return{clearQuotes:i(async()=>{t.resetQuote(),await e.invalidateQueries({queryKey:we.quotesScope()})},"clearQuotes")}},"useSwapClearQuotes");u();l();var fle=i(({accountIdentifier:e,networkID:t})=>{let r=Tt(),o=dn();return vo({mutationFn:i(async a=>{let{swapTransactions:c,type:p}=a;if(c.type==="evm"&&p===ye.EVM){let{gasEstimation:d,pendingApprovalActivityRows:m,pendingSwapActivityRows:f}=a,{signature:h,error:y}=await R.startSpan("Process EVM Swap Txns",()=>ic({transactions:c.transactions,transactionTypes:c.transactionTypes,networkID:t,gasEstimation:d,pendingSwapActivityRows:f,pendingApprovalActivityRows:m,accountIdentifier:e,accountSigner:o,storage:r}));return{networkID:t,chainType:p,id:h,error:y}}else if(c.type==="solana"&&p===ye.Solana){let{callerAddress:d,connection:m,pendingSwapActivityRows:f}=a;if(!m)throw new Error("missing connection");let{signature:h,error:y}=await R.startSpan("Process Solana Swap Txns",()=>cc({callerAddress:d,connection:m,networkID:t,transactions:c.transactions,pendingSwapActivityRows:f,accountIdentifier:e,accountSigner:o,storage:r}));return{networkID:t,chainType:p,id:h,error:y}}else if(c.type==="sui"&&p===ye.Sui){let{callerAddress:d,pendingSwapActivityRows:m}=a,{signature:f,error:h}=await R.startSpan("Process Sui Swap Txns",()=>dc({callerAddress:d,networkID:t,transactions:c.transactions,pendingSwapActivityRows:m,accountIdentifier:e,accountSigner:o,storage:r}));return{networkID:t,chainType:p,id:f,error:h}}throw new Error("unsupported")},"mutationFn")})},"useSwapFungibles");u();l();u();l();u();l();u();l();var Fi;(function(e){e.Fungible="fungible"})(Fi||(Fi={}));var vR=s.object({type:s.literal(Fi.Fungible),data:wg}),MT=s.object({results:s.array(s.any()).transform(e=>e.reduce((t,r)=>{let o=vR.safeParse(r);return o.success&&t.push(o.data),t},[])),prevCursor:s.string().nullish().default(null),nextCursor:s.string().nullish().default(null),hasMore:s.boolean()});async function OT(e){let{query:t,networkIds:r,searchContext:o,supportedNetworkIds:n,pageSize:a=50,cursor:c}=e,p=await K.api().noBearer().headers({"Content-Type":"application/json"}).get("/search/v1",{params:{query:t.trim(),chainIds:r.join(","),platform:Qt,pageSize:a.toString(),searchTypes:Fi.Fungible,searchContext:o,...c&&{cursor:c},...n&&{supportedNetworkIds:n.join(",")}}});if(!de(p))throw new je({key:"UnknownError"});let d=MT.safeParse(p.data);if(d.success)return d.data;throw new je({key:"UnknownError"})}i(OT,"getFungibleSearch");u();l();var QT=i(e=>{let t=e.data,r=wl(t)??void 0;return{type:t.type,data:{...t.data,tokenAddress:wl(t)??void 0,key:r}}},"searchResultToFungible");u();l();var PR="search",qT={searchResults:i((e,t,r,o,n)=>[PR,{query:e,networkIds:t,supportedNetworkIds:o,chainAddresses:r,cursor:n}],"searchResults")};u();l();var Iu;(function(e){e[e.Always=1/0]="Always",e[e.Short=z({minutes:5})]="Short",e[e.Medium=z({minutes:30})]="Medium",e[e.Long=z({hours:1})]="Long",e[e.Never=0]="Never"})(Iu||(Iu={}));var Fu;(function(e){e[e.Immediate=0]="Immediate",e[e.Short=z({minutes:5})]="Short",e[e.Medium=z({minutes:30})]="Medium",e[e.Long=z({hours:1})]="Long"})(Fu||(Fu={}));var RR=i(async e=>(await OT(e)).results.map(r=>QT(r)),"queryFn"),vi=i(({query:e,networkIds:t,enableQuery:r=!0,keepPreviousData:o=!1,searchContext:n,supportedNetworkIds:a,chainAddresses:c,pageSize:p})=>{let d=qT.searchResults(e,t,c,a);return ie({queryKey:d,gcTime:Iu.Short,staleTime:Fu.Short,enabled:r,placeholderData:o?ff:void 0,queryFn:i(()=>RR({query:e,networkIds:t,searchContext:n,supportedNetworkIds:a,pageSize:p}),"queryFn")})},"useFungibleSearch");u();l();var Ud=P(O());function DR({enablePrices:e,enableSorting:t}){let{fungibles:r,isLoadingTokens:o,tokensError:n,refetch:a}=xn({enablePrices:e,enableSorting:t}),c=Bd(),p=j(f=>f.sellFungible),d=r.filter(f=>c(f.data.chain.id)&&f.type!==oe.CompressedSPL),m=(0,Ud.useMemo)(()=>{if(p){let f=d.findIndex(y=>Wo(y,p)),h=d[f];h&&h.data.amount!==p.data.amount&&(d[f]=p)}return d.filter(f=>f.data.amount!=="0")},[d,p]);return(0,Ud.useMemo)(()=>({assets:m,isLoading:o,error:n,refetchTokens:a}),[m,o,n,a])}i(DR,"useSwapSellAssetList");u();l();var Kt=P(O());u();l();var NR=50,zT=i(({includeOwnedAssets:e,sellAsset:t,sellCaip19:r,ownedAssets:o,searchAssets:n})=>{if(!e||!t)return n;let a=i(y=>M(te(y)),"getEncodedCaip19"),c=a(t)??r,p=t.data.chain.id??(r&&et(r).chainId),d=o.filter(y=>a(y)!==c&&A.compareNetworkID(p,y.data.chain.id)===0&&y.type!==oe.CompressedSPL).slice(0,NR-1),m=d.map(y=>[a(y),y]),f=new Map(m),h=n.filter(y=>!f.has(a(y)));return[...d,...h]},"getDisplayedBuyAssets");function BR({enableQuery:e=!0,chainFilter:t,sellCaip19:r}={}){let o=(0,Kt.useMemo)(()=>r?et(r):void 0,[r]),{sellFungible:n,searchQuery:a,setSearchQuery:c,setNumSearchResults:p}=j(),d=na(a,150),{fungibles:m,isLoadingTokens:f,isRefetchingTokens:h,tokensError:y}=xn(),w=Ho(),[S,T]=(0,Kt.useState)(""),{data:b}=Ie(),x=(0,Kt.useMemo)(()=>b?.addresses??[],[b]),{data:E,isSuccess:C,isFetching:I,error:B}=vi({query:d,networkIds:t?[t]:[o?.chainId??n?.data.chain.id??A.solana.mainnetID],enableQuery:e,keepPreviousData:!0,searchContext:"swapper",supportedNetworkIds:w,chainAddresses:x}),Q=!C&&I,N=(0,Kt.useMemo)(()=>m.filter($=>$.type!==oe.CompressedSPL).map($=>[M(te($)),$]),[m]),Z=(0,Kt.useMemo)(()=>{let $=nf(N.map(([H])=>H).join("~")),X=Sf($);return of(X)},[N]),q=(0,Kt.useMemo)(()=>new Map(N),[Z]),k=(0,Kt.useMemo)(()=>{if(!E||E.length===0)return[];T(Ze());let $=E.reduce((X,H)=>{let ve="";if(xt(H.type)){if(n&&xt(n.type)&&H.data.chain.id===n.data.chain.id||o&&o.chainId===H.data.chain.id&&o.resourceType===J.nativeToken)return X;ve=M(hr(A.getChainID(H.data.chain.id)))}else{if(n&&H.data.tokenAddress===n.data.tokenAddress&&!t||o&&o.chainId===H.data.chain.id&&o.resourceType===J.address&&o.address===H.data.tokenAddress)return X;ve=M(te(H))}let He,dt=q.get(ve);return dt&&dt.data.balance?He=dt:He=H,He&&X.push(He),X},[]);return p($.length),$},[q,E,n,p,t,o]),F=Se();(0,Kt.useEffect)(()=>{C&&k.length===0&&F.capture("swapperNullSearchResult",{data:{searchQuery:d}})},[C,k,d,F]);let G=(0,Kt.useMemo)(()=>zT({includeOwnedAssets:!d,sellAsset:n,sellCaip19:r,ownedAssets:m,searchAssets:k}),[d,m,k,n,r]);return(0,Kt.useMemo)(()=>({assets:G,initialFilterKey:t??n?.data.chain.id??o?.chainId,isLoading:f||Q,isFetching:f||Q||h,error:y??B,searchRef:S,setSearchQuery:c,searchQuery:a}),[G,f,Q,h,y,B,n,S,c,o?.chainId,t,a])}i(BR,"useLiveSwapBuyAssetList");u();l();u();l();var Upe=i((e,t=9)=>{let r=(e.match(/\./g)||[]).length;return e.endsWith(".")&&r>1?e.substring(0,e.length-1):e.length===0||e.endsWith(".")||e.endsWith("0")?e:new _(e).decimalPlaces(t).toString()},"formatTokenAmountToMaxDecimals");var vu=P(O());u();l();var GT="https://help.phantom.com/hc/en-us/articles/27085326202515";var LR=[.3,.5,1],UR=LR.map(e=>`${e}%`),MR=[...UR,"custom"],OR=[.5,1,2],QR=OR.map(e=>`${e}%`),jpe=[...QR,"custom"],Vpe=MR.length-1,$pe=5,Hpe=2,KT=.1,jT=30,qR=2,Wpe=i((e,t)=>{if(!e)return;let r=parseFloat(e);if(isNaN(r))return{message:t("swapSettingsCustomInvalidValue"),severity:"critical"};if(r>jT)return{message:t("swapSlippageSettingsCustomMaxError",{maxSlippage:jT}),severity:"critical"};if(r>qR)return{message:t("swapSlippageSettingsHighSlippageWarning"),severity:"warning"};if(r<KT)return{message:t("swapSlippageSettingsCustomMinError",{minSlippage:KT}),severity:"critical"}},"getCustomSlippageError");u();l();var cs=P(O());var zR={input:{maxLength:10,maxDecimals:6},bounds:{min:1e-6,low:5e-6,high:1,max:5}},rde=i((e,t,r)=>{let o=parseFloat(e);if(isNaN(o))return{message:t("swapSettingsCustomInvalidValue"),severity:"critical"};if(o>r.max)return{message:t("swapPriorityFeeSettingsCustomMaxError",{maxPriorityFee:r.max}),severity:"critical"};if(o<r.min)return{message:t("swapPriorityFeeSettingsCustomMinError",{minPriorityFee:r.min}),severity:"critical"};if(o>r.high)return{message:t("swapPriorityFeeSettingsHighFeeWarning"),severity:"warning"};if(o<r.low)return{message:t("swapPriorityFeeSettingsLowFeeWarning"),severity:"warning"}},"validatePriorityFee"),ode=i(()=>{let[e,t]=(0,cs.useState)(zR.bounds);return(0,cs.useEffect)(()=>{i(async()=>{try{let o=await ca({accounts:[],transactionType:gn.Swap});t({min:o.min,low:o.low,high:o.high,max:o.max})}catch(o){R.captureError(o instanceof Error?o:new Error("Unable to fetch priority fee bounds."),U.Swapper)}},"fetchBounds")()},[]),e},"usePriorityFeeBounds");u();l();var us=P(O());var GR={input:{maxLength:10,maxDecimals:6},bounds:{min:1e-6,low:5e-6,high:1,max:5}},lde=i((e,t,r)=>{let o=parseFloat(e);if(isNaN(o))return{message:t("swapSettingsCustomInvalidValue"),severity:"critical"};if(o>r.max)return{message:t("swapTipSettingsCustomMaxError",{maxTip:r.max}),severity:"critical"};if(o<r.min)return{message:t("swapTipSettingsCustomMinError",{minTip:r.min}),severity:"critical"};if(o>r.high)return{message:t("swapTipSettingsHighFeeWarning"),severity:"warning"};if(o<r.low)return{message:t("swapTipSettingsLowFeeWarning"),severity:"warning"}},"validateTip"),pde=i(()=>{let[e,t]=(0,us.useState)(GR.bounds);return(0,us.useEffect)(()=>{i(async()=>{try{let o=await ca({accounts:[],transactionType:gn.Swap});t({min:o.min,low:o.low,high:o.high,max:o.max})}catch(o){R.captureError(o instanceof Error?o:new Error("Unable to fetch tip bounds."),U.Swapper)}},"fetchBounds")()},[]),e},"useTipBounds");u();l();var KR=[tt.lastSubmittedPairs,tt.slippageTolerance],Md=i(e=>{let t=String(e.queryKey[1]);return KR.includes(t)},"swapperShouldDehydrateQueryPredicate");u();l();var $T=P(O());u();l();function VT(){return[new Od,new qd,new Qd]}i(VT,"getBuyAmountEditableRules");var Od=class{static{i(this,"SwapAssetEditableRule")}isEditable({sellAsset:t}){return!!t&&A.isSolanaNetworkID(t.data.chain.id)}},Qd=class{static{i(this,"CryptoCurrencyDenominationEditableRule")}isEditable({currencyDenomination:t}){return t==="crypto"}},qd=class{static{i(this,"BridgeSwapAssetEditableRule")}isEditable({sellAsset:t,buyAsset:r}){return!$t(t?.data.chain.id,r?.data.chain.id)}};var HT=i(({sellAsset:e,buyAsset:t,currencyDenomination:r})=>{let o=ze("enable-swapper-exact-out"),n=(0,$T.useMemo)(()=>VT(),[]);return!t||!o?!1:n.every(a=>a.isEditable({sellAsset:e,buyAsset:t,currencyDenomination:r}))},"useBuyAmountEditableRules");u();l();var zd=class{static{i(this,"NoPriceCurrencyDenominationSwitchSupportRule")}isSupported(t,r,o,n,a){switch(t){case"sell":return!!(o&&a);case"buy":return!1}}},Gd=class{static{i(this,"BuyNotSupportedCurrencyDenominationSwitchSupportRule")}isSupported(t){return t!=="buy"}};function WT(){return[new zd,new Gd]}i(WT,"getCurrencyDenominationSwitchSupportRules");u();l();var ax=P(O());u();l();var ZT=P(O());var jR={"Allbridge's fee":"destinationNetwork","Allbridge Liquidity Fee":"liquidityProvider"},YT=i(()=>{let{currentQuote:e}=rt(),{destinationNetworkFee:t,liquidityFee:r}=(0,ZT.useMemo)(()=>{function o(a){return a?{amount:new _(a.amount??0),amountUsd:a.amountUSD?parseFloat(a.amountUSD):null,pct:parseFloat(a.percentage??"0")}:To}i(o,"bridgeFeeToFee");let n=new Map([]);return e&&se(e)&&(n=e.steps.flatMap(a=>a.includedFeeCosts).reduce((a,c)=>{if(!c)return a;let p=jR[c.name];return p&&a.set(p,c),a},n)),{destinationNetworkFee:o(n.get("destinationNetwork")),liquidityFee:o(n.get("liquidityProvider"))}},[e]);return{destinationNetworkFee:t,liquidityFee:r}},"useBridgeFees");u();l();var XT=P(O());var VR={calculate({currentQuote:e,gasEstimationPriceData:t}){return{amount:(e&&t?.gasEstimationAmount)??new _(0),amountUsd:(e&&t?.gasEstimationPriceUSDNumber)??null,pct:0}}},$R={calculate({currentQuote:e,gasEstimationPriceData:t,priceMap:r,networkID:o}){let n=(e?.fees??[]).find(p=>p.type==="tips"||p.type==="network"&&p.name!=="Token account deposits"),a=(e&&t?.gasEstimationAmount)??new _(0),c=(e&&t?.gasEstimationPriceUSDNumber)??null;if(n&&n.amount&&(a=a.plus(new _(n.amount)),c)){let p=qt(o,new _(n.amount),r);p&&(c+=p)}return{amount:a,amountUsd:c,pct:0}}},HR={calculate({currentQuote:e,gasEstimationPriceData:t,maxGasEstimationPriceData:r}){return{amount:(e&&t?.gasEstimationAmount)??new _(0),amountUsd:(e&&t?.gasEstimationPriceUSDNumber)??null,maxAmount:(e&&r?.gasEstimationAmount)??new _(0),maxAmountUsd:(e&&r?.gasEstimationPriceUSDNumber)??null,pct:0}}},JT=i(({priceMap:e})=>{let{currentQuote:t}=rt(),r=j(m=>m.sellFungible),o=j(m=>m.gasEstimation),n=r?.data.chain.id??me.Solana.Mainnet,{data:a,isLoading:c}=Ds(n,Ii(o.estimate)),{data:p}=Ds(n,Ii(o.estimateWithBuffer));return{networkFee:(0,XT.useMemo)(()=>A.isEVMNetworkID(n)?HR.calculate({currentQuote:t,gasEstimationPriceData:a,maxGasEstimationPriceData:p}):A.isSolanaNetworkID(n)?$R.calculate({currentQuote:t,gasEstimationPriceData:a,networkID:n,priceMap:e}):VR.calculate({currentQuote:t,gasEstimationPriceData:a}),[t,a,p,n,e]),isFetchingGasEstimationPrice:c}},"useNetworkFee");u();l();var ex=P(O());var WR={calculate(){return To}},ZR={calculate({currentQuote:e,networkID:t,priceMap:r}){let o=iu(e);return{amount:o,amountUsd:qt(t,o,r),pct:0}}},tx=i(({priceMap:e})=>{let{currentQuote:t}=rt(),o=j(a=>a.sellFungible)?.data.chain.id??me.Solana.Mainnet;return{nonIncludedFees:(0,ex.useMemo)(()=>t&&se(t)?ZR.calculate({currentQuote:t,networkID:o,priceMap:e}):WR.calculate(),[o,t,e])}},"useNonIncludedFees");u();l();var rx=P(O());var YR={calculate({currentQuote:e,networkID:t,priceMap:r}){let o=(e?.fees??[]).find(n=>n.name==="Token account deposits");return{amount:new _(o?.amount??0),amountUsd:o?.amount?qt(t,new _(o.amount),r):null,pct:o?.percentage??0}}},XR={calculate(){return To}},ox=i(({priceMap:e})=>{let{currentQuote:t}=rt(),o=j(a=>a.sellFungible)?.data.chain.id??me.Solana.Mainnet;return{tokenAccountFee:(0,rx.useMemo)(()=>Ar(t)?YR.calculate({currentQuote:t,networkID:o,priceMap:e}):XR.calculate(),[t,o,e])}},"useTokenAccountFee");u();l();var nx=P(O());var sx={calculate:i(({tokenAccountFee:e,networkFee:t,nonIncludedFees:r,networkID:o,priceMap:n})=>{let a=e.amount.plus(t.amount).plus(r.amount);return{amount:a,amountUsd:qt(o,a,n),pct:0}},"calculate")},JR={calculate:i(({tokenAccountFee:e,networkFee:t,nonIncludedFees:r,networkID:o,priceMap:n})=>{let a=sx.calculate({tokenAccountFee:e,networkFee:t,nonIncludedFees:r,networkID:o,priceMap:n}),c=e.amount.plus(t.maxAmount??0).plus(r.amount);return{...a,maxAmount:c,maxAmountUsd:qt(o,c,n)}},"calculate")},ix=i(({tokenAccountFee:e,networkFee:t,nonIncludedFees:r,priceMap:o})=>{let a=j(p=>p.sellFungible)?.data.chain.id??me.Solana.Mainnet;return{totalFees:(0,nx.useMemo)(()=>A.isEVMNetworkID(a)?JR.calculate({tokenAccountFee:e,networkFee:t,nonIncludedFees:r,networkID:a,priceMap:o}):sx.calculate({tokenAccountFee:e,networkFee:t,nonIncludedFees:r,networkID:a,priceMap:o}),[t,a,r,o,e])}},"useTotalFees");var e1=i(()=>{let e=j(y=>y.gasEstimation.isFetching),t=Eo(),{data:r={}}=ao({query:{data:t.map(y=>hr(y))}}),{networkFee:o,isFetchingGasEstimationPrice:n}=JT({priceMap:r}),a=e||n,{phantomFee:c}=Ob(),{tokenAccountFee:p}=ox({priceMap:r}),{nonIncludedFees:d}=tx({priceMap:r}),{totalFees:m}=ix({tokenAccountFee:p,networkFee:o,nonIncludedFees:d,priceMap:r}),{destinationNetworkFee:f,liquidityFee:h}=YT();return(0,ax.useMemo)(()=>({phantomFee:c,networkFee:o,tokenAccountFee:p,totalFees:m,nonIncludedFees:d,destinationNetworkFee:f,liquidityFee:h,isFetchingFees:a}),[c,o,p,m,d,f,h,a])},"useFees");u();l();var cx=P(O());var t1=i(()=>{let{resume:e}=Ci(),t=j(r=>r.resetSwapper);return(0,cx.useCallback)(()=>{e(),t()},[t,e])},"useResetSwapper");u();l();var ux=P(O());function r1(){let e=Se(),t=j(h=>h.buyFungible),r=j(h=>h.sellFungible),o=j(h=>h.setBuyFungible),n=j(h=>h.setSellFungible),a=j(h=>h.setSellAmount),c=j(h=>h.setUiSellAmountCryptoInput),p=j(h=>h.resetQuote),d=j(h=>h.setSwapFilter),m=r?.data.amount,{cancelQuotes:f}=ku();return(0,ux.useCallback)(async h=>{if(r&&Wo(h,r)){h&&h.data.amount!==m&&(n(h),d(void 0));return}await f();let y=Vo(h);e.capture("swapperUpdateFromAsset",{data:y}),n(h),d(void 0),t&&r&&Wo(h,t)&&o(r),h&&r?.data.chain.id!==h.data.chain.id&&(p(),o(void 0),a(""),c(""))},[e,t,f,m,p,r,o,a,n,d,c])}i(r1,"useSwapSetSellAsset");u();l();var Zo=P(O());u();l();var eo;(function(e){e.Collapsible="collapsible",e.Static="static"})(eo||(eo={}));u();l();var px=P(Be()),ls=P(O());u();l();u();l();var Pu=class{static{i(this,"UgcAwareAssetsSectionAdapter")}sections(t){let r=Jr().map(a=>a.programId),o=t.reduce((a,c)=>{if(da({minimum:ae.Verified,spamStatus:c.data.spamStatus}))return a.verified.push(c),a;if(c.type!==oe.SPL||!c.data.ugcTokenMeta||c.data.ugcTokenMeta.status===yg.Graduated||!r.includes(c.data.ugcTokenMeta.programId))return a.unverified.push(c),a;let p=c.data.ugcTokenMeta.programId,d=a[p]??[];return d.push(c),a[p]=d,a},{verified:[],unverified:[]}),n=Jr().map(a=>{let c=o[a.programId]??[];return{id:a.programId,header:{title:v.t("swapSectionTitleTokens",{section:a.name}),iconUrl:a.iconUrl},data:c,behavior:eo.Collapsible}});return[{id:"verified",data:o.verified,behavior:eo.Static},{id:"unverified",header:{title:v.t("swapUnverifiedTokens")},data:o.unverified,behavior:eo.Collapsible},...n]}};function lx(){return new Pu}i(lx,"getBuyAssetsSectionAdapter");var dx=(0,ls.createContext)(void 0),Efe=i(({children:e})=>{let t=(0,ls.useMemo)(()=>lx(),[]);return(0,px.jsx)(dx.Provider,{value:{buyAssetSectionAdapter:t},children:e})},"SwapAssetSelectProvider"),mx=i(()=>{let e=(0,ls.useContext)(dx);if(!e)throw new Error("useSwapAssetSelect must be used within a SwapAssetSelectProvider");return e},"useSwapAssetSelect");var fx=3;function Kd(e){return{id:e.id,data:e.data,...e.header?{header:e.header}:{}}}i(Kd,"convertToBaseSection");var o1=i(e=>{let[t,r]=(0,Zo.useState)({}),o=(0,Zo.useCallback)((c,p)=>r(d=>({...d,[c]:p})),[]),{buyAssetSectionAdapter:n}=mx(),a=(0,Zo.useMemo)(()=>n.sections(e),[n,e]);return(0,Zo.useMemo)(()=>a.map(c=>{switch(c.behavior){case eo.Static:return Kd(c);case eo.Collapsible:{if(c.data.length<=fx)return Kd(c);let p=t[c.id],d=p?c.data:c.data.slice(0,fx),m=i(()=>o(c.id,!p),"onClick"),f=Kd(c);return{...f,header:{...f.header,title:f.header?.title||"",button:{label:p?v.t("commandShowLess"):v.t("commandShowMore"),onClick:m}},data:d}}}}),[a,t,o])},"useSwapAssetCollapsibleSections");u();l();u();l();u();l();var Pi=z({days:1}),jd=z({seconds:5}),gx=z({seconds:30}),rge=z({seconds:30}),oge=z({seconds:5}),nge=z({seconds:5}),sge=z({seconds:30}),ige=z({seconds:2}),age=z({seconds:10}),cge=z({seconds:30}),uge=z({seconds:2}),lge=z({seconds:10}),hx=i(e=>`/v1/actors-search?query=${encodeURIComponent(e)}`,"actorSearchEndpoint");u();l();var Ix=s.object({actors:ir.array()}),nt;(function(e){e.Buy="Buy",e.Sell="Sell",e.WhaleBuy="WhaleBuy",e.WhaleSell="WhaleSell",e.TrendingToken="TrendingToken",e.TokenFollow="TokenFollow",e.SuggestedFollow="SuggestedFollow",e.TopActorList="TopActorList",e.AggregatedBuy="AggregatedBuy",e.AggregatedSell="AggregatedSell",e.RecommendedToken="RecommendedToken",e.TopTraderActivity="TopTraderActivity",e.TokenCategory="TokenCategory",e.TopTraderBuySell="TopTraderBuySell",e.HighlightedTrade="HighlightedTrade",e.SuggestedTopTraders="SuggestedTopTraders"})(nt||(nt={}));var n1=s.object({type:s.literal("followers")}),s1=s.object({type:s.literal("actor"),id:s.string()}),i1=s.union([n1,s1]),tr=s.object({actorId:s.string(),id:s.string(),published:s.coerce.string(),storyType:s.nativeEnum(nt),destinations:s.array(i1)}),Fx=tr.extend({chainId:ft}),Di=Fx.extend({storyType:s.literal(nt.Buy),tokenBoughtAmount:s.string().nullish(),tokenBoughtUsdValue:s.string().nullish(),tokenBoughtPrice:s.string().nullish(),tokenBoughtAddress:s.string()}),Ni=Fx.extend({storyType:s.literal(nt.Sell),tokenSoldAmount:s.string().nullish(),tokenSoldUsdValue:s.string().nullish(),tokenSoldPrice:s.string().nullish(),tokenSoldAddress:s.string()}),a1=Di.extend({storyType:s.literal(nt.WhaleBuy)}),c1=Ni.extend({storyType:s.literal(nt.WhaleSell)}),u1=tr.extend({storyType:s.literal(nt.TrendingToken),chainId:ft,tokenAddress:s.string(),tokenLogoUrl:s.string(),tokenMarketCap:s.string(),tokenName:s.string(),tokenPrice:s.string(),tokenPriceChange:s.string(),tokenRank:s.string(),tokenSymbol:s.string(),tokenVolume:s.string(),tokenVolumeChange:s.string()}),l1=tr.extend({storyType:s.literal(nt.SuggestedFollow),suggestedActorId:s.string(),mutualFollowsCount:s.number(),mutualFollowsIds:s.array(s.string())}),p1=tr.extend({storyType:s.literal(nt.TokenFollow),tokenId:s.string(),otherTokenFollowers:s.array(s.string())}),d1=s.object({actorId:s.string(),percentChange:s.number()}),m1=tr.extend({storyType:s.literal(nt.TopActorList),items:s.array(d1),listName:s.string()}),vx=tr.extend({chainId:ft,tokenAddress:s.string()}),f1=vx.extend({storyType:s.literal(nt.AggregatedBuy),tokenBuyStories:s.array(Di)}),g1=vx.extend({storyType:s.literal(nt.AggregatedSell),tokenSellStories:s.array(Ni)}),h1=tr.extend({storyType:s.literal(nt.RecommendedToken),chainId:ft,tokenAddress:s.string()}),Px=s.object({type:s.enum(["buy","sell"]),chainId:ft,tokenAddress:s.string(),published:s.coerce.string()}),y1=tr.extend({storyType:s.literal(nt.TopTraderActivity),rank:s.coerce.number(),trades:s.array(Px),percentChange:s.number()}),w1={TopGainers:"top-gainers"},S1=s.union([s.literal(w1.TopGainers),s.string()]).transform(e=>e),b1=tr.extend({storyType:s.literal(nt.TokenCategory),categoryId:S1,name:s.string(),imageUrl:s.string(),tokenIds:s.array(s.string())}),T1=tr.extend({storyType:s.literal(nt.TopTraderBuySell),rank:s.coerce.number(),percentChange:s.number(),trade:s.union([Di,Ni])}),Vd;(function(e){e.TopMiss="topMiss",e.TopSave="topSave",e.TopLoss="topLoss",e.TopWin="topWin"})(Vd||(Vd={}));var x1=tr.extend({storyType:s.literal(nt.HighlightedTrade),chainId:ft,tokenAddress:s.string(),category:s.nativeEnum(Vd),categoryRank:s.number(),tradeType:s.enum(["buy","sell"]),trade:s.union([Di,Ni])}),A1=s.object({actorId:s.string(),rank:s.coerce.number(),percentChange:s.number(),evaluationWindow:s.enum(["24h","1w"]),trades:s.array(Px)}),E1=tr.extend({storyType:s.literal(nt.SuggestedTopTraders),traders:s.array(A1)}),bge=s.union([Di,Ni,a1,c1,u1,p1,l1,m1,f1,g1,h1,y1,b1,T1,x1,E1]),Ru;(function(e){e.TokenMetadataV2="TokenMetadataV2",e.Actor="Actor"})(Ru||(Ru={}));var k1=Sg.pick({name:!0,symbol:!0,decimals:!0,logoUri:!0,extraMetadata:!0,price:!0}),Rx=s.object({id:s.string(),type:s.string()}),Hd=Rx.extend({type:s.literal(Ru.TokenMetadataV2),attributes:k1}),C1=Rx.extend({type:s.literal(Ru.Actor),attributes:ir});var yx;(function(e){e.SUGGESTED="suggested",e.BY_LIST="by-list"})(yx||(yx={}));var wx;(function(e){e.EXPLORE="explore",e.ONBOARDING="onboarding",e.PROFILE="profile",e.TOKEN="token"})(wx||(wx={}));var Sx;(function(e){e.TOP_PNL_1W="top_pnl_1w",e.TOP_PNL_1M="top_pnl_1m",e.SOCIAL_ONBOARDING="social_onboarding"})(Sx||(Sx={}));var Du;(function(e){e.PNL="pnl",e.PNL_BY_TOKEN="pnl-by-token",e.FOLLOWS_YOU="follows-you",e.SEND_INTERACTION="send-interaction"})(Du||(Du={}));var Dx=s.object({actorId:s.string()}),_1=Dx.extend({type:s.literal(Du.PNL),percentChange:s.number().optional()}),I1=Dx.extend({type:s.literal(Du.PNL_BY_TOKEN),caip19:dl,percentChange:s.number().optional()}),F1=s.discriminatedUnion("type",[_1,I1]),Tge=s.object({items:F1.array().default([]),included:C1.array().default([]),next:s.string().nullish()}),xge=s.object({data:s.string().array().default([]),included:Hd.array().default([])}),Age=s.object({data:s.string().array().default([]),meta:s.object({model:s.string()}),included:Hd.array().default([])}),Ege=s.object({orderedItems:ir.array().default([]),next:s.string().optional()}),kge=s.object({orderedItems:ir.array().default([]),next:s.string().optional()}),Cge=s.object({orderedItems:ir.array().default([]),next:s.string().optional()}),bx;(function(e){e.ABUSE_AND_HARASSMENT="abuse_and_harassment",e.PRIVACY_AND_IMPERSONATION="privacy_and_impersonation",e.SPAM="spam"})(bx||(bx={}));var _ge=s.object({orderedItems:ir.array().default([]),next:s.string().optional()}),Ige=s.object({orderedItems:ir.array().default([]),next:s.string().optional()}),v1=s.object({id:s.string(),username:s.string(),icon:s.string().nullish()}),Fge=s.object({followingHolders:v1.array().default([])}),P1=s.object({targetId:s.string(),actorId:s.string(),type:s.string(),content:s.string()}),R1=s.object({targetId:s.string(),content:s.string(),type:s.string(),count:s.number({coerce:!0})});function D1(e,t){return e==="emoji"&&Wd.includes(t)}i(D1,"canUseReactionCount");var N1=P1.transform(e=>({...e,content:Wd.includes(e.content)?e.content:re.Eyes})),vge=s.object({reactions:s.array(N1),counts:s.array(R1).transform(e=>e.filter(t=>D1(t.type,t.content))).optional()}),Pge=s.object({actors:ir.array().default([]),nextCursor:s.string().optional()}),re;(function(e){e.Bear="\u{1F43B}",e.Bull="\u{1F402}",e.CashFlying="\u{1F4B8}",e.Celebrate="\u{1F389}",e.ChartDown="\u{1F4C9}",e.ChartUp="\u{1F4C8}",e.Coin="\u{1FA99}",e.Cool="\u{1F60E}",e.CreditCard="\u{1F4B3}",e.CryLaughing="\u{1F602}",e.Crying="\u{1F62D}",e.DevilHappy="\u{1F608}",e.DevilMad="\u{1F47F}",e.Diamond="\u{1F48E}",e.Disgusted="\u{1F922}",e.Distressed="\u{1F62B}",e.Eggplant="\u{1F346}",e.Expressionless="\u{1F611}",e.Eyes="\u{1F440}",e.Fire="\u{1F525}",e.Flag="\u{1F3C1}",e.HeartEyes="\u{1F60D}",e.Heart="\u2764\uFE0F",e.Mad="\u{1F620}",e.MiddleFinger="\u{1F595}",e.MoneyBag="\u{1F4B0}",e.Moon="\u{1F319}",e.OkHand="\u{1F44C}",e.OpenMouth="\u{1F62E}",e.Peace="\u270C\uFE0F",e.Peach="\u{1F351}",e.PointUp="\u{1F446}",e.PileOfPoo="\u{1F4A9}",e.Pray="\u{1F64F}",e.Rocket="\u{1F680}",e.Siren="\u{1F6A8}",e.Skull="\u{1F480}",e.SmileWithTear="\u{1F972}",e.Smile="\u{1F600}",e.StopSign="\u{1F6D1}",e.Surprised="\u{1F632}",e.SweatDrops="\u{1F4A6}",e.Ufo="\u{1F6F8}",e.UpsideDownFace="\u{1F643}",e.Whale="\u{1F40B}"})(re||(re={}));var Wd=[re.CryLaughing,re.Disgusted,re.Mad,re.Distressed,re.HeartEyes,re.OpenMouth,re.SmileWithTear,re.UpsideDownFace,re.Smile,re.Crying,re.Surprised,re.Expressionless,re.Cool,re.DevilHappy,re.DevilMad,re.Skull,re.Eyes,re.Diamond,re.Fire,re.Eggplant,re.Peach,re.CreditCard,re.Heart,re.SweatDrops,re.Coin,re.Siren,re.MoneyBag,re.PileOfPoo,re.Celebrate,re.OkHand,re.MiddleFinger,re.PointUp,re.Peace,re.Pray,re.Rocket,re.Ufo,re.Moon,re.ChartUp,re.ChartDown,re.Flag,re.StopSign,re.Bear,re.Bull,re.CashFlying,re.Whale],Nu;(function(e){e.Image="image",e.Emoji="emoji"})(Nu||(Nu={}));var $d;(function(e){e.Circle="circle",e.Square="square"})($d||($d={}));var B1=s.object({type:s.literal(Nu.Image),imageUrl:s.string(),shape:s.nativeEnum($d)}),L1=s.object({type:s.literal(Nu.Emoji),unicode:s.string()}),U1=s.discriminatedUnion("type",[B1,L1]),Bu;(function(e){e.Reaction="reaction",e.Icon="icon"})(Bu||(Bu={}));var M1=s.object({type:s.literal(Bu.Reaction),content:s.string()}).transform((e,t)=>{let r=e.content;return Wd.includes(r)?{...e,content:r}:(t.addIssue({code:s.ZodIssueCode.custom,message:`Not a supported reaction ${r}`}),s.NEVER)}),O1=s.object({type:s.literal(Bu.Icon),icon:s.string(),size:s.number(),backgroundColor:s.string(),foregroundColor:s.string()}),Q1=s.union([M1,O1]),q1=s.object({start:s.number(),length:s.number()}),ps;(function(e){e.Profile="profile",e.Story="story",e.Token="token",e.Dapp="dapp"})(ps||(ps={}));var z1=s.object({type:s.literal(ps.Profile),profileId:s.string()}),G1=s.object({type:s.literal(ps.Story),storyId:s.string()}),K1=s.object({type:s.literal(ps.Token),tokenId:dl}),j1=s.object({type:s.literal(ps.Dapp),dappId:s.string()}),V1=s.discriminatedUnion("type",[z1,G1,K1,j1]),$1=s.object({data:s.record(s.string(),s.any()),event:s.string()}),Rge=s.object({id:s.string(),startImage:U1.array(),startImageBadge:Q1,text:s.string(),highlight:q1.array(),action:V1,isRead:s.boolean(),published:s.coerce.string(),onActionAnalytics:$1}),Dge=s.object({isFollowing:s.boolean()}),Tx;(function(e){e.Blocking="blocking",e.Chat="chat",e.Deeplink="deeplink",e.Feed="feed",e.Followers="followers",e.FollowRequest="followRequest",e.ManageAccounts="manageAccounts",e.Notifications="notifications",e.Nux="nux",e.Onboarding="onboarding",e.PerpsLeaderboard="perpsLeaderboard",e.ReactionsDetails="reactionsDetails",e.Search="search",e.SuggestedFollows="suggestedFollows",e.SuggestedFollowsByList="suggestedFollowsByList"})(Tx||(Tx={}));var xx;(function(e){e.VolumeDistribution="volumeDistribution",e.VolumeDistributionAllocations="volumeDistributionAllocations",e.OpenPositions="openPositions",e.ClosedPositions="closedPositions"})(xx||(xx={}));var Ax;(function(e){e.FeedTab="feed",e.Profile="profile",e.ShareStory="shareStory"})(Ax||(Ax={}));var Nge=s.object({channelType:s.string(),channelId:s.string(),enabled:s.boolean()}),H1=s.object({userId:s.string(),username:s.string(),text:s.string(),createdAt:s.coerce.string()}),W1=s.object({id:s.string(),name:s.string(),image:s.string().nullish()}),Bge=s.object({channelId:s.string(),watcherCount:s.number(),watchers:s.array(W1).default([]),lastMessages:s.array(H1)}),Nx=s.object({color:s.string(),icon:s.string(),name:s.string(),requirement:s.number()}),Lge=s.object({quantity:s.number(),quantityString:s.string(),decimals:s.number(),price:s.number().nullish(),badge:Nx.nullish()}),Uge=s.object({positions:s.array(s.record(s.string(),s.any()))}),Z1=s.object({profileId:s.string(),username:s.string(),quantity:s.number()}),Mge=s.object({channelId:s.string(),leaderboard:s.array(Z1)}),Oge=s.object({badges:s.array(Nx)}),Ex;(function(e){e.Buy="buy",e.Sell="sell",e.BadgeUnlocked="badge_unlocked",e.PredictionMarketBuy="prediction_market_position_buy",e.PredictionMarketSell="prediction_market_position_sell"})(Ex||(Ex={}));var Y1=s.object({id:s.string(),tokenId:s.string(),createdAt:s.string(),updatedAt:s.string()}),Qge=s.object({data:s.array(Y1),included:Hd.array().default([])}),Bx=s.object({channelId:s.string(),channelType:s.string(),watcherCount:s.number()}),X1=Bx.extend({eventId:s.string()}),J1=Bx.extend({tokenId:s.string()}),qge=s.union([X1,J1]),kx;(function(e){e.TokenPage="tokenPage",e.TrendingList="trendingList",e.RecentList="recentList",e.Banner="banner",e.Notification="notification"})(kx||(kx={}));var Cx;(function(e){e.Chat="chat",e.Badges="badges"})(Cx||(Cx={}));var eD=s.object({profileId:s.string(),userId:s.string(),username:s.string(),icon:Tf}),tD=s.object({accountValueUsd:s.number(),pnlUsd:s.number(),roiPct:s.number(),volumeUsd:s.number()}),_x=s.object({rank:s.number(),isViewer:s.boolean(),actor:eD,performance:tD}),zge=s.object({leaderboard:s.array(_x),viewer:_x.nullish()}),Gge=s.object({accountValueUsd:s.number(),pnlUsd:s.number(),roiPct:s.number(),volumeUsd:s.number(),error:s.string().optional()}),Lx=s.object({market:s.string(),name:s.string(),image:s.string(),pnlUsd:s.number()}),rD=Lx.extend({margin:s.number(),roiPct:s.number(),leverage:s.string(),direction:s.string()}),oD=Lx.extend({id:s.string(),valueUsd:s.number(),timestamp:s.number(),type:s.string()}),nD=s.object({market:s.string(),name:s.string(),image:s.string(),color:s.string().optional(),volumePct:s.number()}),Kge=s.object({portfolio:s.object({pnlUsd:s.number(),volumeUsd:s.number()}),openPositions:s.object({positions:s.array(rD)}),closedPositions:s.object({volumeByMarket:s.array(nD),positions:s.array(oD)})}),jge=s.object({totalSwapVolumeUsd:s.number(),totalPerpsVolumeUsd:s.number(),totalVolumeUsd:s.number()}),Ri;(function(e){e.PredictionMarket="predictionMarket",e.Perps="perps",e.Token="token"})(Ri||(Ri={}));u();l();var ds=i(({name:e,response:t,current:r,target:o})=>{let n=`Failed to ${e}: 
`,a=[r!==void 0?`Current: ${r}`:null,o!==void 0?`Target: ${o}`:null].filter(Boolean);return a.length>0&&(n+=`${a.join(" | ")} 
`),n+=`${t.status} ${t.statusText} 
`,n+=`${JSON.stringify(t.data)}`,n},"getFetcherErrorMessage"),Ux=i(({name:e,error:t,current:r,target:o})=>{let n=`Failed to parse ${e}: 
`,a=[r!==void 0?`Current: ${r}`:null,o!==void 0?`Target: ${o}`:null].filter(Boolean);return a.length>0&&(n+=`${a.join(" | ")} 
`),n+=`${JSON.stringify(t)}`,n},"getParserErrorMessage");var Mx=i(async e=>{R.addBreadcrumb(U.Network,"User is searching for actors.",Y.Info,{query:e});let t=await K.api().bearer(!0).get(hx(e));if(!de(t)){let o=new Error(ds({name:"searchForActor",response:t}));throw R.captureError(o,U.UserSearch),o}let r=Ix.safeParse(t.data);return r.success?{actors:r.data.actors}:{actors:[]}},"searchForActor");u();l();u();l();function Ox(e){let t=e.match(/\/v1\/actors\/([^/]+)/)?.[1];return t?ta.parse(t):void 0}i(Ox,"userProfileIdFromUrl");u();l();function Qx(e){return Ox(e)??ta.parse(e)}i(Qx,"userProfileIdFromUrlOrProfileId");u();l();var le="social",pe="@phantom/social",Rr={actor(e){return[le,`${pe}:actor`,{profileId:e}]},actorVolume(e){return[le,`${pe}:actor-volume`,{profileId:e}]},actorAndFollowers(e){return[le,`${pe}:actor-and-followers`,{profileId:e}]},actorAndFollowing(e){return[le,`${pe}:actor-and-following`,{profileId:e}]},userProfileByUsernameOrUserProfileId(e){return[le,`${pe}:user-profile-by-username-or-user-profile-id`,{usernameOrUserProfileId:e}]},followUser(e,t){return[le,`${pe}:follow-user`,{currentId:e,targetId:t}]},followingTokens(e){return[le,`${pe}:following-tokens`,{limit:e}]},feed(e,t,r){return[le,`${pe}:feed`,{profileId:e,userEnabledNetworks:t,viewFeedAsUsername:r}]},feedStory(e){return[le,`${pe}:feed-story`,{storyId:e}]},notifications(e){return[le,`${pe}:notifications`,{profileId:e}]},searchForActorBase(){return[le,`${pe}:search`]},searchForActor(e){return[le,`${pe}:search`,{query:e}]},followRequests(e){return[le,`${pe}:follow-requests`,{profileId:e}]},suggestedActors(e,t){return[le,`${pe}:suggested-follows`,{profileId:t,source:e}]},actorList(e,t,r){return[le,`${pe}:actor-list`,{profileId:r,listName:t,source:e}]},blocking(e){return[le,`${pe}:blocking`,{profileId:e}]},pendingFollowRequests(e,t){return[le,`${pe}:pending-follow-requests`,{profileId:e,targetId:t}]},reaction(e){return e?[le,`${pe}:reaction`,{targetId:e}]:[le,`${pe}:reaction`]},reactionDetails(e){return e.targetId?[le,`${pe}:reaction-details`,e]:[le,`${pe}:reaction-details`,{content:e.content}]},followingHolders(e,t){return[le,`${pe}:following-holders`,{profileId:e,caip19:t}]},tokenFollows(e,t){return[le,`${pe}:token-follows`,{profileId:e,caip19:t}]},reportedFeedTokens(){return[le,`${pe}:reported-feed-tokens`]},userProfileFeed(e,t){return[le,`${pe}:user-profile-feed`,{username:e,userEnabledNetworks:t}]},chatEnabled(e){return[le,`${pe}:chat-enabled`,{chatId:e}]},chatStats(e){return[le,`${pe}:chat-stats`,{chatId:e}]},tokenChatBalance(e,t){return[le,`${pe}:token-chat-balance`,{caip19:e,userId:t}]},predictionMarketPosition(e,t){return[le,`${pe}:prediction-market-position`,{eventId:e,profileId:t}]},chatLeaderboard(e){return[le,`${pe}:chat-leaderboard`,{caip19:e}]},tokensForYou(e,t){return[le,`${pe}:tokens-for-you`,{profileId:t,limit:e}]},similarTokens(e,t,r){return[le,`${pe}:similar-tokens`,{caip19:e,profileId:r,limit:t}]},popularChats(){return[le,`${pe}:popular-chats`]},chatChannel(e,t){return[le,`${pe}:chat-channel`,{channelType:e,channelId:t}]},perpsLeaderboard(e,t){return[le,`${pe}:perps-leaderboard`,{limit:e,windowPeriod:t}]},perpsPortfolio(e,t){return[le,`${pe}:perps-portfolio`,{windowPeriod:e,userId:t}]},perpsProfile(e,t,r){return[le,`${pe}:perps-profile`,{profileId:e,openLimit:t,closedLimit:r}]},badgeStatus(e){return[le,`${pe}:badge-status`,{caip19:e}]}};var qx=i((e,t)=>{let r=Qx(t.id);r&&e.setQueryData(Rr.actor(r),t)},"setActorInQueryCache");var zx=i(async(e,t)=>{let r=t?.startsWith("@")?t.slice(1):t;if(!r)throw new Error("No sanitized username or user profile id");let o=await e.getUserProfileByUsernameOrUserProfileId(r);if(!o)throw new Error("No user profile");return o},"getUserProfileByUsernameOrUserProfileIdQueryFn");function sD({usernameOrUserProfileId:e}){let t=Df(),r=Rr.userProfileByUsernameOrUserProfileId(e);return ie({enabled:!!e,queryKey:r,queryFn:i(async()=>zx(t,e),"queryFn"),gcTime:Pi,staleTime:jd})}i(sD,"useGetUserProfileByUsernameOrUserProfileId");function iD({query:e}){let t=qe(),r=e?.startsWith("@")?e.slice(1).trim():e.trim(),o=Rr.searchForActor(r),n=i(async()=>{let{actors:a}=await Mx(r);for(let c of a)qx(t,c);return a.sort((c,p)=>c.isFollowing?-1:p.isFollowing?1:0),{actors:a}},"queryFn");return Xi({enabled:r.length>1,queryKey:o,queryFn:n,gcTime:Pi,staleTime:jd})}i(iD,"useSearchForActor");u();l();u();l();u();l();async function Gx(e){let t=await K.api().bearer(!0).headers({Accept:"application/activity+json"}).get(`/v1/actors/${e}`);if(!de(t)){let o=new Error(ds({name:"getActor",response:t,target:e}));throw R.captureError(o,U.Profiles),o}let r=ir.safeParse(t.data);if(r.success)return r.data;{let o=new Error(Ux({name:"getActor",error:r.error,target:e}));throw R.captureError(o,U.Profiles),o}}i(Gx,"getActor");function Zd(e){let t=i(async()=>{if(!e)throw new Error("No profile ID or access token");return Gx(e)},"queryFn");return Xi({queryKey:Rr.actor(e),queryFn:t,enabled:!!e,gcTime:Pi,staleTime:gx})}i(Zd,"useGetActor");u();l();u();l();u();l();var Xx=P(Yx(),1),Jx=Xx.default;var dD=Jx.bind({concatArrays:!0,ignoreUndefined:!0});function mD(e,t){let r=self.localStorage.getItem(e);if(r){let o=JSON.parse(r),n=JSON.parse(t),a=JSON.stringify(dD(o,n));self.localStorage.setItem(e,a)}else self.localStorage.setItem(e,t)}i(mD,"mergeLocalStorageItem");function gs(e,t){return new Promise((r,o)=>{try{let n=e();t?.(null,n),r(n)}catch(n){t?.(n),o(n)}})}i(gs,"createPromise");function Mu(e,t,r){return Promise.all(e).then(o=>{let n=r?.(o)??null;return t?.(null,n),Promise.resolve(n)},o=>(t?.(o),Promise.reject(o)))}i(Mu,"createPromiseAll");var Bi={getItem:i((e,t)=>gs(()=>self.localStorage.getItem(e),t),"getItem"),setItem:i((e,t,r)=>gs(()=>self.localStorage.setItem(e,t),r),"setItem"),removeItem:i((e,t)=>gs(()=>self.localStorage.removeItem(e),t),"removeItem"),mergeItem:i((e,t,r)=>gs(()=>mD(e,t),r),"mergeItem"),clear:i(e=>gs(()=>self.localStorage.clear(),e),"clear"),getAllKeys:i(e=>gs(()=>{let t=self.localStorage.length,r=[];for(let o=0;o<t;o+=1){let n=self.localStorage.key(o)||"";r.push(n)}return r},e),"getAllKeys"),flushGetRequests:i(()=>{},"flushGetRequests"),multiGet:i((e,t)=>{let r=e.map(n=>Bi.getItem(n));return Mu(r,t,i(n=>n.map((a,c)=>[e[c],a]),"processResult"))},"multiGet"),multiSet:i((e,t)=>{let r=e.map(o=>Bi.setItem(o[0],o[1]));return Mu(r,t)},"multiSet"),multiRemove:i((e,t)=>{let r=e.map(o=>Bi.removeItem(o));return Mu(r,t)},"multiRemove"),multiMerge:i((e,t)=>{let r=e.map(o=>Bi.mergeItem(o[0],o[1]));return Mu(r,t)},"multiMerge")},Xd=Bi;u();l();var eA=Xd;u();l();var fD=Object.defineProperty,tA=Object.getOwnPropertySymbols,gD=Object.prototype.hasOwnProperty,hD=Object.prototype.propertyIsEnumerable,rA=i((e,t,r)=>t in e?fD(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,"__defNormalProp"),hs=i((e,t)=>{for(var r in t||(t={}))gD.call(t,r)&&rA(e,r,t[r]);if(tA)for(var r of tA(t))hD.call(t,r)&&rA(e,r,t[r]);return e},"__spreadValues"),Ou=i(e=>t=>{try{let r=e(t);return r instanceof Promise?r:{then(o){return Ou(o)(r)},catch(o){return this}}}catch(r){return{then(o){return this},catch(o){return Ou(o)(r)}}}},"toThenable"),oA=i((e,t)=>(r,o,n)=>{let a=hs({getStorage:i(()=>localStorage,"getStorage"),serialize:JSON.stringify,deserialize:JSON.parse,partialize:i(b=>b,"partialize"),version:0,merge:i((b,x)=>hs(hs({},x),b),"merge")},t);(a.blacklist||a.whitelist)&&console.warn(`The ${a.blacklist?"blacklist":"whitelist"} option is deprecated and will be removed in the next version. Please use the 'partialize' option instead.`);let c=!1,p=new Set,d=new Set,m;try{m=a.getStorage()}catch{}if(m)m.removeItem||console.warn(`[zustand persist middleware] The given storage for item '${a.name}' does not contain a 'removeItem' method, which will be required in v4.`);else return e((...b)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),r(...b)},o,n);let f=Ou(a.serialize),h=i(()=>{let b=a.partialize(hs({},o()));a.whitelist&&Object.keys(b).forEach(C=>{var I;!((I=a.whitelist)!=null&&I.includes(C))&&delete b[C]}),a.blacklist&&a.blacklist.forEach(C=>delete b[C]);let x,E=f({state:b,version:a.version}).then(C=>m.setItem(a.name,C)).catch(C=>{x=C});if(x)throw x;return E},"setItem"),y=n.setState;n.setState=(b,x)=>{y(b,x),h()};let w=e((...b)=>{r(...b),h()},o,n),S,T=i(()=>{var b;if(!m)return;c=!1,p.forEach(E=>E(o()));let x=((b=a.onRehydrateStorage)==null?void 0:b.call(a,o()))||void 0;return Ou(m.getItem.bind(m))(a.name).then(E=>{if(E)return a.deserialize(E)}).then(E=>{if(E)if(typeof E.version=="number"&&E.version!==a.version){if(a.migrate)return a.migrate(E.state,E.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return E.state}).then(E=>{var C;return S=a.merge(E,(C=o())!=null?C:w),r(S,!0),h()}).then(()=>{x?.(S,void 0),c=!0,d.forEach(E=>E(S))}).catch(E=>{x?.(void 0,E)})},"hydrate");return n.persist={setOptions:i(b=>{a=hs(hs({},a),b),b.getStorage&&(m=b.getStorage())},"setOptions"),clearStorage:i(()=>{var b;(b=m?.removeItem)==null||b.call(m,a.name)},"clearStorage"),rehydrate:i(()=>T(),"rehydrate"),hasHydrated:i(()=>c,"hasHydrated"),onHydrate:i(b=>(p.add(b),()=>{p.delete(b)}),"onHydrate"),onFinishHydration:i(b=>(d.add(b),()=>{d.delete(b)}),"onFinishHydration")},T(),S||w},"persist");u();l();u();l();var yD=10,nA={chatJoinTimestamps:new Map,chatHistory:[]},wD=Ye(oA((e,t)=>({...nA,recordChatJoin:i((r,o)=>{e(n=>{let a=new Map(n.chatJoinTimestamps);a.set(r,Date.now());let c=[{chatId:r,chatType:o,lastJoinedTimestamp:Date.now()},...n.chatHistory.filter(p=>p.chatId!==r)].slice(0,yD);return{chatJoinTimestamps:a,chatHistory:c}})},"recordChatJoin"),recordChatLeave:i(r=>{e(o=>{let n=new Map(o.chatJoinTimestamps);return n.delete(r),{chatJoinTimestamps:n}})},"recordChatLeave"),clearChatHistory:i(()=>{e(r=>({...r,chatHistory:[]}))},"clearChatHistory"),removeChatFromHistory:i(r=>{e(o=>({...o,chatHistory:o.chatHistory.filter(n=>n.chatId!==r)}))},"removeChatFromHistory"),reset:i(()=>e(nA),"reset")}),{name:"chat-activity",getStorage:i(()=>eA,"getStorage"),partialize:i(e=>({chatHistory:e.chatHistory}),"partialize"),version:1,migrate(e,t){if(t===0){let r=e.chatHistory.map(o=>({chatId:o.chatId,chatType:o.chatId.startsWith("hypercore")?Ri.Perps:Ri.Token,lastJoinedTimestamp:o.lastJoinedTimestamp}));return{...e,chatHistory:r}}return e}})),sA=i(e=>wD.getState().chatJoinTimestamps.get(e),"getChatJoinTimestamp");var Jd=i(async({chatTokenId:e,transactionId:t,tokenBoughtCaip19:r,tokenBoughtAmount:o,tokenBoughtUsdValue:n,tokenSoldCaip19:a,tokenSoldAmount:c,tokenSoldUsdValue:p,walletCaip19:d,chatTokenBalance:m,system:f})=>{if(!sA(e))return;let y=await K.api().bearer(!0).post("/social/v1/events/trades",{chatTokenId:e,tokenBoughtCaip19:r,tokenBoughtAmount:o,tokenBoughtUsdValue:n,tokenSoldCaip19:a,tokenSoldAmount:c,tokenSoldUsdValue:p,transactionId:t,walletCaip19:d,chatTokenBalance:m,system:f});if(!de(y)){let w=new Error(ds({name:"publishSystemChatTradeMessage",response:y}));throw R.captureError(w,U.Chat),w}},"publishSystemChatTradeMessage");u();l();var SD=i(e=>{let{data:t}=Zd(e);return iA(t)},"useFollowersAndFollowingCount"),iA=i(e=>{let t={followers:e?.followers&&typeof e.followers=="object"&&e?.followers?.totalItems||0,following:e?.following&&typeof e.following=="object"&&e?.following?.totalItems||0};return{...t,formattedFollowers:bn(t.followers||0,{compact:!0}),formattedFollowing:bn(t.following||0,{compact:!0})}},"getFollowersAndFollowingCount");u();l();u();l();u();l();var aA=P(O());var em=i(()=>{let{data:[e]}=yr(["enable-perps"]),{data:t}=Ie(),r=(0,aA.useMemo)(()=>t?.addresses.some(o=>A.isEVMNetworkID(o.networkID))??!1,[t]);return e&&r},"useIsPerpsSupported");u();l();var cA;(function(e){e.BID="B",e.ASK="A"})(cA||(cA={}));var uA;(function(e){e.OPEN="open",e.FILLED="filled",e.CANCELED="canceled",e.TRIGGERED="triggered",e.REJECTED="rejected",e.MARGIN_CANCELED="margin_canceled"})(uA||(uA={}));var tm=s.string().regex(/^\d*\.?\d+$/,"Invalid numeric string"),Li=s.string().regex(/^-?\d*\.?\d+$/,"Invalid signed numeric string");u();l();var bD=lf.extend({chainId:af,address:s.string()}),lA=s.object({symbol:s.string(),name:s.string(),token:bD,logoUri:s.string(),szDecimals:s.number(),maxLeverage:s.number(),price:Li,priceChange24h:s.object({amount:Li,percentage:Li}),volume24h:tm,openInterest:tm,fundingRate:Li,assetId:s.number(),isAtOpenInterestCap:s.boolean().optional(),description:s.string().optional()}),pA=s.object({markets:s.array(lA).transform(e=>e.reduce((t,r)=>{let o=lA.safeParse(r);return o.success&&(t[M(o.data.token)]=o.data),t},{}))}),Twe=s.object({id:s.string(),name:s.string(),logoUri:s.string(),currentPrice:s.number(),maxLeverage:s.number(),szDecimals:s.number(),assetId:s.number(),symbol:s.string()});u();l();var mA=P(O());u();l();var Qu=class{static{i(this,"CashSwapStateListener")}queryClient;storage;authRepository;cashAccount;constructor(t,r,o,n){this.queryClient=t,this.storage=r,this.authRepository=o,this.cashAccount=n}onStateChange(t,r,o,n){if(t.type===V.TransactionConfirmed){let{sell:a,buy:c,quote:p}=o.executingQuote,d=new L(p.sellAmount),m=new L(p.buyAmount);Tp({queryClient:this.queryClient,storage:this.storage,authRepository:this.authRepository,sellCaip19:te(a),sellAmountBN:d,sellAddress:a.data.walletAddress,buyCaip19:te(c),buyAmountBN:m,buyAddress:c.data.walletAddress,cashAccountAddress:this.cashAccount?.addressDetails.address})}}};u();l();var qu=class{static{i(this,"FailedCashSwapExecuteSwapStateListener")}authRepository;constructor(t){this.authRepository=t}onStateChange(t,r,o,n){let{executingQuote:a}=o,{sell:c,buy:p}=a;if(!(!Ve(c)&&!Ve(p)))switch(t.type){case V.SimulationFailed:R.addBreadcrumb(U.Cash,"Cash swap simulation failure detected, recording...",Y.Info,{sellToken:c.data.symbol,buyToken:p.data.symbol}),this.recordFailure(a,"simulation",t.error,t.executionId);break;case V.TransactionSubmissionFailed:R.addBreadcrumb(U.Cash,"Cash swap submission failure detected, recording...",Y.Info,{sellToken:c.data.symbol,buyToken:p.data.symbol}),this.recordFailure(a,"submission",t.error,t.executionId);break}}async recordFailure(t,r,o,n){try{let a=await this.authRepository?.getUser();if(!a){R.addBreadcrumb(U.Cash,"Cannot record failed cash swap: user not found",Y.Info);return}let{accessToken:c,userID:p}=a,d=t.sell,m=t.buy,f=t.quote,h=t.quoteInput,y=d.data.walletAddress,w=m.data.walletAddress;if(!y&&h?.taker){let x=et(h.taker);x.resourceType===J.address&&(y=x.address)}if(!w&&h?.takerDestination){let x=et(h.takerDestination);x.resourceType===J.address&&(w=x.address)}let S={type:Bo.Swap,input:{owner:y,mint:d.data.tokenAddress??"",amount:f.sellAmount,symbol:d.data.symbol??void 0,name:d.data.name??void 0,decimals:d.data.decimals,logoUri:d.data.logoUri??void 0},output:{owner:w,mint:m.data.tokenAddress??"",amount:f.buyAmount,symbol:m.data.symbol??void 0,name:m.data.name??void 0,decimals:m.data.decimals,logoUri:m.data.logoUri??void 0},quoteId:f.rfqProps?.quoteId,quoteSource:Oe(f).map(x=>x.name).join(",")},T=d.data.chain.id,b=o?.message||o?.type||"Unknown error";await kp({accessToken:c,userID:p,idempotencyKey:n,swapInfo:S,chainId:T,failureReason:b,skipNotification:!0,occurredAt:new Date().toISOString()}),R.addBreadcrumb(U.Cash,"Recorded failed cash swap",Y.Info,{failureType:r,sellToken:d.data.symbol,buyToken:m.data.symbol})}catch(a){R.addBreadcrumb(U.Cash,"Failed to record failed cash swap",Y.Error,a instanceof Error?{error:a.message}:{})}}};u();l();var zu=class{static{i(this,"SocialExecuteSwapStateListener")}swapMode;queryClient;enableChatBadges;dismissChatBadgeSheet;constructor(t,r,o,n){this.swapMode=t,this.queryClient=r,this.enableChatBadges=o,this.dismissChatBadgeSheet=n}dismissBadgeSheet(){this.enableChatBadges&&this.dismissChatBadgeSheet()}onStateChange(t,r,o,n){if(t.type===V.TransactionSubmissionStarted&&this.dismissBadgeSheet(),t.type===V.TransactionConfirmed){let{buy:a,sell:c,quote:p,account:d}=o.executingQuote,m=a.data.chain.id,f=d.addresses.find(h=>h.networkID===m);if(f){let h=te(a),y=te(c),w=ke(p.buyAmount,a.data.decimals).toNumber(),S=ke(p.sellAmount,c.data.decimals).toNumber(),T=M({chainId:f.networkID,address:f.address,resourceType:J.address}),b=this.swapMode.type==="buy"?M(h):M(y),E=this.queryClient.getQueryData(vf.userProfile())?.id??"",C=this.queryClient.getQueryData(Rr.tokenChatBalance(b,E)),I=0;C&&(I=C.quantity>0?C.quantity/10**C.decimals:0);let B=["trades"];this.enableChatBadges&&B.push("badges"),Jd({chatTokenId:b,transactionId:t.txReceipt.id,tokenBoughtCaip19:M(h),tokenBoughtAmount:w,tokenBoughtUsdValue:a.data.price?w*a.data.price:0,tokenSoldCaip19:M(y),tokenSoldAmount:S,tokenSoldUsdValue:c.data.price?S*c.data.price:0,walletCaip19:T,chatTokenBalance:I,system:{messages:B}})}}}};var dA=i(()=>{},"noop"),fA=i(e=>{let t=ot(),{connection:r}=Tn(),o=Tt(),n=dn(),a=v.language,c=Se(),p=qe(),d=bu(),m=fo(),f=Yi(),h=ln("kill-swapper-simulation")??!1,y=ze("enable-chat-badges"),{data:w}=Gs();return(0,mA.useCallback)(async({showFungibleDetails:S,showBuyFungibleScreen:T=dA,showRetrySwap:b,swapMode:x,executeSwapStateListeners:E,toastMessageParser:C,uiContext:I="swapperInterstitial",preprocessor:B,dismissChatBadgeSheet:Q=dA})=>{let N=new as(S,T,m,[Te.SlippageExceeded],b,C),Z=new os(p,o,f),q=new Qu(p,o,f,w),k=new rs(d,c,I,e),F=new ns(c),G=new ss,$=new ts(bo),X=new zu(x,p,y,Q),H=new qu(f);try{t.subscribeExecution(Z),t.subscribeExecution(q),t.subscribeExecution(F),t.subscribeExecution(k),t.subscribeExecution(N),t.subscribeExecution(G),t.subscribeExecution($),t.subscribeExecution(H),sr&&t.subscribeExecution(X),E.forEach(He=>t.subscribeExecution(He));let ve=await c.getDeviceId();await t.swap({signer:n,storage:o,locale:a,deviceId:ve,connection:r,authRepository:f,isSimulationKilled:h,preprocessor:B})}catch{}finally{t.unsubscribeExecution(Z),t.unsubscribeExecution(q),t.unsubscribeExecution(F),t.unsubscribeExecution(k),t.unsubscribeExecution(N),t.unsubscribeExecution(G),t.unsubscribeExecution($),t.unsubscribeExecution(H),t.unsubscribeExecution(X),E.forEach(ve=>t.unsubscribeExecution(ve))}},[m,p,d,c,t,n,o,a,r,f,h,e,y,w])},"useExecuteSwapTokenSwap");u();l();u();l();var Dr="perps",gA={historicalOrders:i((e,t)=>[Dr,"historical-orders",e,t],"historicalOrders"),market:i(e=>[Dr,"market",e],"market"),markets:i(e=>[Dr,"markets",e.sort()],"markets"),defaultLeverage:i(()=>[Dr,"default-leverage"],"defaultLeverage"),assetLeverage:i(()=>[Dr,"asset-leverage"],"assetLeverage"),permissions:i(()=>[Dr,"config"],"permissions"),fungibleToPerpMap:i(()=>[Dr,"fungible-to-perp-map"],"fungibleToPerpMap"),fundsInTransitBanner:i(e=>[Dr,"funds-in-transit-banner",e],"fundsInTransitBanner"),fundsInTransitBannerDismissed:i(()=>[Dr,"funds-in-transit-banner-dismissed"],"fundsInTransitBannerDismissed"),getStartedCardDismissed:i(()=>[Dr,"get-started-card-dismissed"],"getStartedCardDismissed")};u();l();var TD={perp:6,spot:8};function hA(e,t,r="perp",o=_.ROUND_HALF_UP){let n=new _(e);if(n.isInteger())return n.toString();let a=TD[r],c=Math.max(a-t,0);return n.precision(5,o).toFixed(c,o).replace(/\.?0+$/,"")}i(hA,"formatUiPrice");var xD=z({days:1}),AD=z({minutes:5});var rm=i((e,t=!1)=>ie({enabled:e.length>0,queryKey:gA.markets(e),gcTime:xD,staleTime:AD,async queryFn(){try{return await ED(e,t)}catch(r){throw R.addBreadcrumb(U.Perps,"Failed to get perp markets",Y.Error,{caip19s:e.join(","),error:r instanceof Error?r.message:"Unknown error"}),r}}}),"useGetPerpMarkets");async function ED(e,t=!1){let r=await K.api().get("/swap/v2/perp/markets",{params:{tokens:e.join(",")}});if(!de(r))throw new Error("Failed to get perp markets: response is not okay");let o=r.data,n=pA.safeParse(o);if(!n.success)throw new Error("Failed to get perp markets: schema validation failed");if(t){let a=n.data.markets,c={};for(let[p,d]of Object.entries(a))c[p]={...d,price:hA(d.price,d.szDecimals),priceChange24h:{...d.priceChange24h,percentage:String(Number(d.priceChange24h.percentage)/100)}};return c}return n.data.markets}i(ED,"getPerpMarkets");var ju=P(O());u();l();var EA=P(Pk()),kA=P(Fk());var kD=s.object({domain:s.string(),url:s.string(),name:s.string(),category:s.string(),imageUrl:s.string(),slug:s.string()}),CA=s.object({uuid:s.string(),data:s.array(kD)}),CD=s.object({type:s.literal("site"),url:s.string(),name:s.string(),category:s.string(),imageUrl:s.string(),description:s.string().optional()}),_D=s.object({type:s.literal("tokenCategory"),id:s.string(),name:s.string(),subtitle:s.string().optional(),imageUrl:s.string(),description:s.string().optional()}),_A=s.discriminatedUnion("type",[CD,_D]),nbe=i(e=>e.type==="site","isFeaturedSite");var ID=s.object({chainId:ft,address:s.string(),name:s.string(),symbol:s.string(),logoUrl:s.string(),marketCap:s.number(),price:s.number(),priceChange:s.number(),volume:s.number(),volumeChange:s.number(),spamStatus:yl.optional().default(ae.NotVerified)}),FD=s.object({chainId:ft,address:s.string(),name:s.string(),symbol:s.string(),logoUrl:s.string(),marketCap:s.number(),price:s.number(),priceChange:s.number(),volume:s.number(),volumeChange:s.number(),spamStatus:yl.optional().default(ae.NotVerified)}),sbe=s.object({id:s.string(),name:s.string(),imageUri:s.string()}),IA=s.object({items:s.array(ID)}),ibe=s.object({items:s.array(FD)}),vD=s.object({paymentTokenId:s.string(),name:s.string(),symbol:s.string(),decimals:s.number()}),PD=s.object({verified:s.boolean(),collectionUrl:s.string(),marketplaceId:s.string(),marketplaceName:s.string(),marketplaceCollectionId:s.string()}),RD=s.object({marketplaceId:s.string(),paymentToken:vD,value:s.string()}),DD=s.object({id:s.string(),name:s.string(),volume:s.string().optional(),volumePercentChange:s.number(),marketplacePages:s.array(PD),floorPrices:s.array(RD),imageUrl:s.string()}),FA=s.object({uuid:s.string(),data:s.array(DD)}),ND=["tokens","perps","sites","collections","learn","suggested-users-to-follow","suggested-users-to-follow-by-pnl","token-categories","tokens-for-you","trending-perps"],rr=s.enum(["shortcuts","carousel",...ND]),BD=s.object({type:s.literal(rr.enum.shortcuts)}),LD=s.object({type:s.literal(rr.enum.carousel)}),UD=s.object({type:s.literal(rr.enum["suggested-users-to-follow"]),limit:s.number()}),MD=["7d","30d"],yA=s.enum(MD),OD=s.object({type:s.literal(rr.enum["suggested-users-to-follow-by-pnl"]),limit:s.number(),timeFrame:s.array(yA).refine(e=>new Set(e).size===e.length),timeFrameDefault:yA}),Ui="all_networks",ys=s.union([ft,s.literal(Ui)]),QD=["asc","desc"],om=s.enum(QD),qD=["rank","volume","price","price-change","market-cap"],wA=s.enum(qD),zD=["1h","24h","7d","30d"],SA=s.enum(zD),GD=s.object({type:s.literal(rr.enum.tokens),sortBy:s.array(wA).refine(e=>new Set(e).size===e.length),sortByDefault:wA,sortDirectionDefault:om,network:s.array(ys).refine(e=>new Set(e).size===e.length),networkDefault:ys,timeFrame:s.array(SA).refine(e=>new Set(e).size===e.length),timeFrameDefault:SA,rankAlgo:s.string(),limit:s.number(),listLimit:s.number()}),KD=s.object({type:s.literal(rr.enum["token-categories"])}),jD=["volume","price-change","open-interest","trending"],Gu=s.enum(jD),VD=["1h","24h","7d","30d"],Ku=s.enum(VD),$D=s.object({type:s.literal(rr.enum.perps),sortBy:s.array(Gu).refine(e=>new Set(e).size===e.length),sortByDefault:Gu,sortDirectionDefault:om,timeFrame:s.array(Ku).refine(e=>new Set(e).size===e.length),timeFrameDefault:Ku,limit:s.number(),listLimit:s.number()}),HD=s.object({type:s.literal(rr.enum["trending-perps"]),sortBy:s.array(Gu).refine(e=>new Set(e).size===e.length),sortByDefault:Gu,sortDirectionDefault:om,timeFrame:s.array(Ku).refine(e=>new Set(e).size===e.length),timeFrameDefault:Ku,limit:s.number(),listLimit:s.number()}),WD=["top","rank"],bA=s.enum(WD),ZD=["24h","7d","30d"],TA=s.enum(ZD),YD=s.object({type:s.literal(rr.enum.sites),sortBy:s.array(bA).refine(e=>new Set(e).size===e.length),sortByDefault:bA,network:s.array(ys).refine(e=>new Set(e).size===e.length),networkDefault:ys,timeFrame:s.array(TA).refine(e=>new Set(e).size===e.length),timeFrameDefault:TA,rankAlgo:s.string(),limit:s.number(),listLimit:s.number()}),XD=["top","rank"],xA=s.enum(XD),JD=["24h","7d","30d"],AA=s.enum(JD),eN=s.object({type:s.literal(rr.enum.collections),sortBy:s.array(xA).refine(e=>new Set(e).size===e.length),sortByDefault:xA,network:s.array(ys).refine(e=>new Set(e).size===e.length),networkDefault:ys,timeFrame:s.array(AA).refine(e=>new Set(e).size===e.length),timeFrameDefault:AA,rankAlgo:s.string(),limit:s.number(),listLimit:s.number()}),tN=s.object({type:s.literal(rr.enum.learn),limit:s.number()}),rN=s.object({type:s.literal(rr.enum["tokens-for-you"]),limit:s.number(),listLimit:s.number()}),nm=s.discriminatedUnion("type",[BD,LD,UD,OD,GD,$D,HD,YD,eN,tN,KD,rN]),vA=s.object({sections:s.array(nm).refine(e=>(0,EA.default)(e,(0,kA.default)(e,"type")))}),abe=s.object({uuid:s.string(),data:s.array(Ym)}),cbe=s.object({tokenAddress:s.string(),bondingCurve:s.string(),migratedPool:s.string().optional(),name:s.string(),image:s.string(),symbol:s.string(),marketCap:s.coerce.number(),liquidity:s.coerce.number(),bondingCurvePercentage:s.coerce.number(),tokenCreatedAt:s.coerce.date(),twitter:s.string(),website:s.string(),telegram:s.string(),discord:s.string(),migratedAt:s.coerce.date().optional(),type:s.enum(["NEW","ABOUT_TO_MIGRATE","MIGRATED"]).optional(),slot:s.coerce.number().optional(),devHolding:s.coerce.number(),snipersHolding:s.coerce.number(),bundlersHolding:s.coerce.number(),top10Holding:s.coerce.number(),volume:s.coerce.number(),buysCount:s.coerce.number(),sellsCount:s.coerce.number(),uniqueHolders:s.coerce.number(),telegramCallCount:s.coerce.number(),bondingCurvePlatform:s.string()});var PA=vA.parse({sections:[{type:"shortcuts"},{type:"carousel"},{type:"tokens",sortBy:["rank","volume","price","price-change","market-cap"],sortByDefault:"rank",sortDirectionDefault:"asc",network:["solana:101","eip155:1","eip155:137","eip155:8453","sui:mainnet","bip122:000000000019d6689c085ae165831e93","all_networks"],networkDefault:"solana:101",timeFrame:["1h","24h","7d","30d"],timeFrameDefault:"24h",rankAlgo:"default",limit:3,listLimit:100},{type:"perps",sortBy:["volume","price-change","open-interest"],sortByDefault:"volume",sortDirectionDefault:"desc",timeFrame:["24h"],timeFrameDefault:"24h",limit:3,listLimit:100},{type:"trending-perps",sortBy:["trending"],sortByDefault:"trending",sortDirectionDefault:"desc",timeFrame:["24h"],timeFrameDefault:"24h",limit:3,listLimit:100},{type:"tokens-for-you",limit:3,listLimit:50},{type:"token-categories"},{type:"suggested-users-to-follow-by-pnl",limit:3,timeFrame:["7d","30d"],timeFrameDefault:"7d"},{type:"sites",sortBy:["rank","top"],sortByDefault:"rank",network:["solana:101","eip155:1","eip155:137","eip155:8453","sui:mainnet","bip122:000000000019d6689c085ae165831e93","all_networks"],networkDefault:"solana:101",timeFrame:["24h","7d","30d"],timeFrameDefault:"24h",rankAlgo:"default",limit:3,listLimit:50},{type:"learn",limit:3}]}),oN=i(e=>{try{let t=JSON.parse(e??"");return t?.sections?{sections:t.sections.filter(o=>nm.safeParse(o).success)}:PA}catch{return PA}},"parseFeatureFlagConfig"),sm=i(()=>{let e=Vt.getMultivariateAssignment("explore-config"),{data:[t]}=yr(["enable-fungible-categories"]),r=ze("enable-social-tokens-for-you"),o=em(),n=ze("enable-trending-perps");return(0,ju.useMemo)(()=>{let a=oN(e);return sr||(a={...a,sections:a.sections.filter(c=>c.type!=="suggested-users-to-follow")}),(!r||!sr)&&(a={...a,sections:a.sections.filter(c=>c.type!=="tokens-for-you")}),t||(a={...a,sections:a.sections.filter(c=>c.type!=="token-categories")}),o||(a={...a,sections:a.sections.filter(c=>c.type!=="perps")}),n||(a={...a,sections:a.sections.filter(c=>c.type!=="trending-perps")}),a},[e,t,o,r,n])},"useExploreConfig"),im=i(()=>{let e=sm();return(0,ju.useMemo)(()=>{let t=[];for(let r of e.sections)(r.type==="collections"||r.type==="tokens"||r.type==="perps"||r.type==="sites"||r.type==="learn"||r.type==="suggested-users-to-follow"||r.type==="suggested-users-to-follow-by-pnl"||r.type==="token-categories"||r.type==="tokens-for-you"||r.type==="trending-perps")&&t.push(r);return t},[e.sections])},"useExploreConfigNavigatableSections"),am=i(e=>{let t=sm();return(0,ju.useMemo)(()=>t.sections.find(o=>o.type===e)??null,[t.sections,e])},"useExploreConfigSection");u();l();u();l();u();l();u();l();var RA="@phantom/fungible-categories",Vu={fungibleCategories:i(e=>[RA,"fungible-categories",e],"fungibleCategories"),fungibleCategoryById:i(e=>[RA,"fungible-category",e],"fungibleCategoryById")};u();l();var DA=s.object({items:s.array(Dg)}),NA=s.object({id:s.string(),name:s.string(),imageUri:s.string().nullish().transform(e=>e??""),items:Ng.array()});var cm=i(({limit:e,searchQuery:t}={})=>{let{data:[r]}=yr(["enable-fungible-categories"]);return ie({enabled:r,queryKey:Vu.fungibleCategories({enabled:r,searchQuery:t}),queryFn:i(async()=>{let o=await K.api().get("/fungibles/v1/categories",{params:{limit:"100",...t?{query:t}:{}}});return DA.parse(o.data)},"queryFn"),select:i(o=>e?o.items.slice(0,e):o.items,"select")})},"useFungibleCategories");u();l();var nN=i(({id:e})=>{let{data:[t]}=yr(["enable-fungible-categories"]);return ie({enabled:t,queryKey:Vu.fungibleCategoryById({id:e,enabled:t}),queryFn:i(async()=>{let r=await K.api().get(`/fungibles/v1/categories/${e}`,{params:{includePrices:"true"}});return NA.parse(r.data)},"queryFn")})},"useFungibleCategoryById");u();l();var to=P(O());u();l();u();l();var sN=s.object({name:s.string(),shortName:s.string()}).passthrough(),iN=s.object({eventTicker:s.string(),ui:sN}).passthrough(),aN=s.enum(["YES","NO"]).transform(e=>e.toLowerCase()),cN=s.object({outcome:aN,size:s.number(),platformData:iN,signature:s.string(),time:s.string(),activityType:s.enum(["BUY","SELL"]),escrowMintAmount:s.number()}).passthrough(),BA=s.object({positions:s.array(cN)}).passthrough();u();l();u();l();var um=s.object({marketLedger:s.string(),yesMint:s.string(),noMint:s.string(),isInitialized:s.boolean()}),uN=s.object({ticker:s.string(),eventTicker:s.string(),marketType:s.string(),title:s.string(),subtitle:s.string().optional(),yesSubTitle:s.string(),noSubTitle:s.string(),openTime:s.number(),closeTime:s.number(),expirationTime:s.number(),status:s.string(),volume:s.number(),result:s.string().nullish().default(null),openInterest:s.number(),canCloseEarly:s.boolean(),earlyCloseCondition:s.string().optional(),rulesPrimary:s.string(),rulesSecondary:s.string().optional(),accounts:s.record(s.string(),um)}),nTe=s.object({markets:s.array(uN),cursor:s.string().nullish().default(null)});u();l();var lm=s.object({backgroundColor:s.string(),textColor:s.string(),translucentBackgroundColor:s.string(),actionButtonColor:s.string().optional(),actionButtonTextColor:s.string().optional(),name:s.string(),shortName:s.string(),subtitle:s.string(),imageUrl:s.string().nullish().default(null).optional().transform(e=>e??void 0),competitionType:s.string().nullish().transform(e=>e??void 0),binaryOutcomeColors:s.object({yes:s.object({backgroundColor:s.string(),textColor:s.string()}),no:s.object({backgroundColor:s.string(),textColor:s.string()})}).optional()}),lN=s.object({label:s.string(),price:s.number().optional(),chance:s.number().optional(),bestBid:s.number().optional(),bestAsk:s.number().optional(),binaryType:s.enum(["yes","no"]).optional()}),pN=s.object({id:s.string(),title:s.string(),subtitle:s.string().optional(),slug:s.string().optional(),image:s.string().optional(),status:s.string(),outcomes:s.array(lN),startTime:s.string().optional(),endDate:s.string(),volume:s.number(),volume24h:s.number().optional(),liquidity:s.number(),openInterest:s.number().optional(),dflowAccounts:s.record(s.any()).optional(),custom_strike:s.record(s.any()).optional(),ui:lm.optional()}),dN=s.object({type:s.string()}).passthrough(),LA=s.object({id:s.string(),title:s.string(),subtitle:s.string().optional(),description:s.string().optional(),category:s.string(),image:s.string().optional(),icon:s.string().optional(),startDate:s.string(),endDate:s.string(),active:s.boolean(),closed:s.boolean(),markets:s.array(pN),volume:s.number(),volume24h:s.number(),liquidity:s.number(),openInterest:s.number().optional(),live:s.boolean().optional(),ended:s.boolean().optional(),score:s.string().optional(),elapsed:s.string().optional(),period:s.string().optional(),platformData:dN,product_metadata:s.object({competition:s.string().optional()}).passthrough().optional()}),lTe=s.object({events:s.array(LA),nextKalshiCursor:s.string().optional()}),pTe=LA.extend({subcategory:s.string().optional(),featuredImage:s.string().optional(),resolutionSource:s.string().optional(),creationDate:s.string().optional(),closedTime:s.string().optional(),archived:s.boolean().optional(),new:s.boolean().optional(),featured:s.boolean().optional(),restricted:s.boolean().optional(),volume1wk:s.number().optional(),volume1mo:s.number().optional(),volume1yr:s.number().optional(),liquidityAmm:s.number().optional(),liquidityClob:s.number().optional(),commentsEnabled:s.boolean().optional(),commentCount:s.number().optional(),competitive:s.number().optional(),tags:s.array(s.object({id:s.string(),label:s.string()})).optional(),categories:s.array(s.object({id:s.string(),label:s.string()})).optional(),collections:s.array(s.object({id:s.string(),title:s.string(),slug:s.string()})).optional(),series:s.array(s.object({id:s.string(),title:s.string(),ticker:s.string(),slug:s.string()})).optional(),subEvents:s.array(s.string()).optional(),parentEvent:s.string().optional(),createdBy:s.string().optional(),updatedBy:s.string().optional(),createdAt:s.string().optional(),updatedAt:s.string().optional(),publishedAt:s.string().optional()}).passthrough();var mN=s.discriminatedUnion("type",[s.object({type:s.literal("open")}),s.object({type:s.literal("claimable")}),s.object({type:s.literal("pending")}),s.object({type:s.literal("resolved"),result:s.enum(["won","lost"])})]),fN=s.object({marketId:s.string(),marketTitle:s.string(),eventId:s.string(),outcome:s.enum(["YES","NO"]).transform(e=>e.toLowerCase()),endDate:s.string(),size:s.number(),exposure:s.number().nullish().transform(e=>e??void 0),currentValue:s.number().nullish().transform(e=>e??void 0),platformData:s.object({type:s.literal("kalshi"),mint:s.string(),position:s.enum(["YES","NO"]),marketTicker:s.string(),eventTicker:s.string(),accounts:s.record(s.string(),um),isLive:s.boolean(),eventStartDate:s.string().optional(),marketTitle:s.string(),marketSubtitle:s.string().optional(),status:mN,marketResult:s.enum(["yes","no"]).optional(),ui:lm.optional()}),lastUpdated:s.string()}),UA=s.object({positions:s.array(fN)});u();l();var $u;(function(e){e.Kalshi="kalshi",e.Polymarket="polymarket"})($u||($u={}));var MA;(function(e){e.Volume="volume",e.Volume24hr="volume24hr",e.StartTime="startTime",e.EventDate="eventDate"})(MA||(MA={}));var OA;(function(e){e.Sports="Sports",e.Politics="Politics",e.Finance="Finance",e.Crypto="Crypto",e.Earnings="Earnings",e.Tech="Tech",e.World="World",e.Economy="Economy",e.Elections="Elections",e.Mentions="Mentions",e.Culture="Pop-Culture",e.Geopolitics="Geopolitics",e.Entertainment="Entertainment",e.Health="Health",e.ScienceAndTechnology="Science and Technology",e.Social="Social",e.Transportation="Transportation",e.Companies="Companies",e.ClimateAndWeather="Climate and Weather",e.Financials="Financials",e.Economics="Economics"})(OA||(OA={}));var QA;(function(e){e.Soccer="Soccer",e.Basketball="Basketball",e.Football="Football",e.Baseball="Baseball",e.Hockey="Hockey",e.Tennis="Tennis",e.Golf="Golf",e.Boxing="Boxing",e.Mma="MMA",e.Esports="Esports",e.Motorsports="Motorsports",e.Cricket="Cricket",e.Chess="Chess",e.Weekly="Weekly",e.Recurring="Recurring",e.Stocks="Stocks",e.Equities="Equities",e.Daily="Daily",e.UpOrDown="Up or Down",e.Earnings="Earnings",e.Indicies="Indicies",e.Commodities="Commodities",e.Forex="Forex",e.Acquisitions="Acquisitions",e.Ipos="Ipos",e.FedRate="Fed Rate",e.Treasuries="Treasuries",e.Bitcoin="Bitcoin",e.Ethereum="Ethereum",e.Solana="Solana"})(QA||(QA={}));var gN="http://localhost:3017/predictions",hN="/predictions",ut=i(()=>hN,"getBasePath"),lt=i(()=>{let e=K.api(),t=v.language;return t?e.headers({"Accept-Language":t}):e},"getRequestBuilder"),Hu=class{static{i(this,"BackendPredictionsClient")}async getEvents(t){try{let o=(await lt().get(`${ut()}/v2/events`,{params:t})).data;if(o&&(o.error||o.statusCode)&&!o.events)throw console.error("[BackendPredictionsClient] getEvents received error response:",o),new Error(o.message||o.error||"Failed to fetch events");return o}catch(r){throw console.error("[BackendPredictionsClient] getEvents failed:",r),r}}async getEvent(t,r=$u.Kalshi){try{let n=(await lt().get(`${ut()}/v2/event/${r}/${t}`)).data;if(n&&(n.error||n.statusCode))throw console.error(`[BackendPredictionsClient] getEvent received error response for ${t}:`,n),new Error(n.message||n.error||"Failed to fetch event");return n}catch(o){throw console.error(`[BackendPredictionsClient] getEvent failed for ${t} on ${r}:`,o),o}}async getMarket(t,r){try{return(await lt().get(`${ut()}/v2/market/${t}/${r}`)).data}catch(o){throw console.error(`[BackendPredictionsClient] getMarket failed for ${r}:`,o),o}}async searchEvents(t){try{let o=(await lt().get(`${ut()}/v2/events/search`,{params:t})).data;if(o&&(o.error||o.statusCode)&&!o.events)throw console.error("[BackendPredictionsClient] searchEvents received error response:",o),new Error(o.message||o.error||"Failed to search events");return o}catch(r){throw console.error("[BackendPredictionsClient] searchEvents failed:",r),r}}async getHistoricalPrices(t,r,o){try{return(await lt().get(`${ut()}/v2/historical-prices/${t}/${r}`,{params:o})).data}catch(n){throw console.error(`[BackendPredictionsClient] getHistoricalPrices failed for ${r}:`,n),n}}async getOrderbook(t,r,o){try{return(await lt().get(`${ut()}/v2/orderbook/${t}/${r}`,{params:o})).data}catch(n){throw console.error(`[BackendPredictionsClient] getOrderbook failed for ${r}:`,n),n}}async getPositions({address:t,venue:r,status:o}){try{let n=await lt().get(`${ut()}/v2/positions/${r}`,{params:{user:t,status:o}});return UA.parse(n.data)}catch(n){throw console.error("[BackendPredictionsClient] getPositions failed:",n),n}}async getActivities(t){try{return(await lt().get(`${ut()}/v2/activities`,{params:t})).data}catch(r){throw console.error("[BackendPredictionsClient] getActivities failed:",r),r}}async getUserActivities({address:t,venue:r}){try{let o=await lt().get(`${ut()}/v2/user-activities`,{params:{user:t,venue:r}});return BA.parse(o.data)}catch(o){throw console.error("[BackendPredictionsClient] getUserActivities failed:",o),o}}async getActiveOrders(t){try{return(await lt().get(`${ut()}/v2/active-orders`,{params:t})).data}catch(r){throw console.error("[BackendPredictionsClient] getActiveOrders failed:",r),r}}async getTabs(t){try{let o=t??!1?{test:"true"}:void 0;return(await lt().get(`${ut()}/v2/tabs`,{params:o})).data}catch(r){throw console.error("[BackendPredictionsClient] getTabs failed:",r),r}}async getPortfolio(){try{return(await lt().get(`${ut()}/v2/portfolio`)).data}catch(t){throw console.error("[BackendPredictionsClient] getPortfolio failed:",t),t}}async getTrades(t,r,o,n){try{return(await lt().get(`${ut()}/v2/trades/${t}`,{params:{marketTickers:r.join(","),limit:o,after_ts:n}})).data}catch(a){throw console.error(`[BackendPredictionsClient] getTrades failed for ${t}:`,a),a}}async getForecastHistory(t,r,o){try{let n={start_ts:o.start_ts,period_interval:o.period_interval,candlestick_function:o.candlestick_function};return o.end_ts!==null&&(n.end_ts=o.end_ts),(await lt().get(`${ut()}/v2/forecast-history/${t}/${r}`,{params:n})).data}catch(n){throw console.error(`[BackendPredictionsClient] getForecastHistory failed for ${r}:`,n),n}}async getScoreV3(t,r){try{return(await lt().get(`${ut()}/v2/score/${t}/${r}`)).data}catch(o){throw console.error("[BackendPredictionsClient] getScoreV3 failed:",o),o}}async getHomeFeaturedItems(){try{return(await lt().get(`${ut()}/v2/home-featured-items`)).data}catch(t){throw console.error("[BackendPredictionsClient] getHomeFeaturedItems failed:",t),t}}async getFeed(){try{return(await lt().get(`${ut()}/v2/feed`)).data}catch(t){throw console.error("[BackendPredictionsClient] getFeed failed:",t),t}}};var yN=2,wN=10;function zA(e,t=300){let[r,o]=(0,to.useState)([]),[n,a]=(0,to.useState)(!1),c=(0,to.useRef)(null),p=(0,to.useMemo)(()=>new Hu,[]);return(0,to.useEffect)(()=>{if(c.current&&clearTimeout(c.current),e.length<yN){o([]),a(!1);return}return a(!0),c.current=setTimeout(async()=>{try{let d=await p.searchEvents({query:e,limit:wN});o(d.events||[])}catch(d){console.error("[usePredictionSearch] Search failed:",d),o([])}finally{a(!1)}},t),()=>{c.current&&clearTimeout(c.current)}},[e,p,t]),{results:r,isSearching:n}}i(zA,"usePredictionSearch");var Ne=P(O());u();l();u();l();u();l();var GA={tokenSearchEnabled:i(()=>!0,"tokenSearchEnabled"),trendingTokensEnabled:i(()=>!1,"trendingTokensEnabled")};u();l();var KA={tokenSearchEnabled:i(()=>!0,"tokenSearchEnabled"),trendingTokensEnabled:i(()=>!0,"trendingTokensEnabled")};u();l();var jA={tokenSearchEnabled:i(()=>!0,"tokenSearchEnabled"),trendingTokensEnabled:i(()=>!1,"trendingTokensEnabled")};u();l();var VA={tokenSearchEnabled:i(()=>!0,"tokenSearchEnabled"),trendingTokensEnabled:i(()=>!0,"trendingTokensEnabled")};u();l();var $A={tokenSearchEnabled:i(()=>!0,"tokenSearchEnabled"),trendingTokensEnabled:i(()=>!1,"trendingTokensEnabled")};u();l();var HA={tokenSearchEnabled:i(()=>!0,"tokenSearchEnabled"),trendingTokensEnabled:i(()=>!1,"trendingTokensEnabled")};u();l();var WA={tokenSearchEnabled:i(()=>!1,"tokenSearchEnabled"),trendingTokensEnabled:i(()=>!1,"trendingTokensEnabled")};u();l();var ZA={tokenSearchEnabled:i(()=>!0,"tokenSearchEnabled"),trendingTokensEnabled:i(()=>!0,"trendingTokensEnabled")};u();l();var YA={tokenSearchEnabled:i(()=>!0,"tokenSearchEnabled"),trendingTokensEnabled:i(()=>!0,"trendingTokensEnabled")};u();l();var XA={tokenSearchEnabled:i(()=>!0,"tokenSearchEnabled"),trendingTokensEnabled:i(()=>!1,"trendingTokensEnabled")};var SN=new cn({[ne.Solana]:YA,[ne.Ethereum]:VA,[ne.Polygon]:ZA,[ne.Base]:KA,[ne.Arbitrum]:GA,[ne.Bitcoin]:jA,[ne.Monad]:WA,[ne.Sui]:XA,[ne.Hypercore]:$A,[ne.Hyperevm]:HA}),pm=an(SN);u();l();u();l();var Gxe=i(e=>e.address==="native"?M({chainId:e.chainId,resourceType:J.nativeToken,slip44:A.getSlip44(e.chainId)}):M({chainId:e.chainId,address:e.address,resourceType:J.address}),"exploreTokenToCaip19");var JA=i(e=>["explore-dapp",e],"createExploreDappQueryKey");var eE=i(e=>e.addresses.map(t=>A.getMainnetNetworkID(t.networkID))??[],"getAccountMainnetNetworkIds");function tE(e){try{return ar.get(e).nonNativeFungibleTokenType}catch{return oe.SolanaNative}}i(tE,"getExploreTokenTypeFromChain");u();l();u();l();var jt="@phantom/explore",pt={RecentlyViewedSearchItems:[jt,"RecentlyViewedSearchItems"],sitesV2({sortBy:e,timeFrame:t,networkIDs:r,limit:o,locale:n,rankAlgo:a}){return[jt,"sitesV2",Ce,n,{sortBy:e,timeFrame:t,networkIDs:r,rankAlgo:a,limit:o}]},recommendedSites(e,t){return[jt,"sites","recommended",Ce,t,e]},featuredItems(e,t){return[jt,"items","featured",Ce,t,e]},tokensV2({sortBy:e,sortDirection:t,timeFrame:r,networkIDs:o,limit:n,rankAlgo:a}){return[jt,"tokensV2",{sortBy:e,sortDirection:t,timeFrame:r,networkIDs:o,rankAlgo:a,limit:n}]},curated({networkIDs:e,limit:t}){return[jt,"curated",{networkIDs:e,limit:t}]},collectionsV2({sortBy:e,timeFrame:t,networkIDs:r,limit:o,locale:n,rankAlgo:a}){return[jt,"collectionsV2",Ce,n,{sortBy:e,timeFrame:t,networkIDs:r,rankAlgo:a,limit:o}]},featuredTransactions(e,t){return[jt,"transactions","featured",Ce,t,e]},learn(e,t){return[jt,"learn",Ce,t,e]},perpMarkets(e,t,r,o,n,a){return[jt,"perp-markets",{chainId:e,sortBy:t,sortDirection:r,timeFrame:o,limit:n,search:a}]}};var bN=10,oE=fe.RecentlyViewedSearchItems;async function TN(e){return await e.get(oE)??[]}i(TN,"getRecentlyViewedSearchItem");async function nE(e,t){await e.set(oE,t)}i(nE,"setRecentlyViewedSearchItem");function dm(e){return ie({queryKey:pt.RecentlyViewedSearchItems,queryFn:i(async()=>TN(e),"queryFn"),staleTime:0,enabled:!0})}i(dm,"useGetRecentlyViewedSearchItems");function xN(e){let t=qe();return vo({mutationFn:i(async o=>{let n=rE(o),c=(t.getQueryData(pt.RecentlyViewedSearchItems)??[]).filter(p=>rE(p)!==n);c.unshift(o),c=c.slice(0,bN),await nE(e,c),t.setQueryData(pt.RecentlyViewedSearchItems,c),await t.refetchQueries({queryKey:pt.RecentlyViewedSearchItems})},"mutationFn")})}i(xN,"useAddRecentlyViewedSearchItem");function AN(e){let t=qe();return vo({mutationFn:i(async()=>{await nE(e,[]),t.setQueryData(pt.RecentlyViewedSearchItems,[]),await t.refetchQueries({queryKey:pt.RecentlyViewedSearchItems})},"mutationFn")})}i(AN,"useClearRecentlyViewedSearchItem");function rE(e){return e.type==="token"||e.type==="perp"?M(te(e.data)):e.data.id}i(rE,"keyFromSearchItem");u();l();var mm=P(dE()),Wu=P(O());u();l();var mE={fields:["domain","name","category","tags"],storeFields:["domain","name","category","tags","imageUrl"],searchOptions:{boost:{name:2},prefix:!0,fuzzy:i(e=>e.length>3?.2:!1,"fuzzy")}};var fE=i(e=>{try{let{hostname:t,pathname:r}=new URL(e);return t+r}catch{return e}},"getHostnameAndPath"),BN=i((e=[],t=[])=>{let r=[...e,...t],o=(0,mm.default)(t,a=>fE(a.domain)),n=new Map;return r.forEach(a=>{let c=fE(a.domain);if(!n.has(c)){let p=o[c]||a;n.set(c,p)}}),Array.from(n.values())},"combineAndDeduplicateDapps"),LN=i(e=>{let t={isRecommended:"true"};return e.networkIds&&(t.chainIds=e.networkIds.join(",")),`/dapps/v1?${new URLSearchParams(t).toString()}`},"getRecommendedDappsEndpoint"),UN=i(async e=>{let t=await K.api().get(LN(e));if(!de(t))throw new Error("Error fetching recommended dapps from registry");if(!t?.data||!t?.data?.data)throw new Error("No data returned from registry");let r=t.data,o=(0,mm.default)(r.data??[],a=>a.id);return Object.values(o)},"fetchRecommendedDapps"),MN=i(e=>{let t=qe();return ie({queryKey:["dapps","recommended",e],queryFn:i(async()=>{try{let r=await UN(e);return gf.batch(()=>{for(let o of r){let n=JA(o.domain),a=t.getQueryState(n);t.setQueryData(n,()=>o??a?.data??null)}}),r}catch(r){throw R.captureError(r,U.DappRegistry),r}},"queryFn"),gcTime:z({days:1}),staleTime:z({days:1})})},"useRecommendedSearchDapps"),gE=i((e,t)=>{let{searchQuery:r,networkIds:o}=e,{data:n=[],...a}=MN({networkIds:o}),c=(0,Wu.useMemo)(()=>n.sort((h,y)=>y.recommendationScore-h.recommendationScore),[n]),p=(0,Wu.useMemo)(()=>BN(t,c),[t,c]),d=hh(r),m=Ug(p,d,mE);return{data:(0,Wu.useMemo)(()=>{let h=new Map(p.map(y=>[y.id,y]));return m.map(y=>h.get(y.id)).filter(y=>y!==void 0)},[m,p]),...a}},"useRecommendedSearchDappsWithQuery");u();l();u();l();var hE=i(async({sortBy:e,sortDirection:t,timeFrame:r,networkIDs:o,limit:n,rankAlgo:a,anonymousId:c})=>{let p=new URLSearchParams({timeFrame:r,sortBy:e,sortDirection:t,limit:n.toString(),rankAlgo:a,...c?{anonymousId:c}:{}});o.forEach(f=>{p.append("chainIds[]",f)});let d=await K.api().noBearer().get("/explore/v2/trending-tokens",{params:p});if(!de(d))throw new Error("Failed to fetch tokens");let m=IA.safeParse(d.data);if(!m.success)throw new Error("Failed to parse tokens");return m.data},"getTokensV2");u();l();var ws=i((e,t)=>{let r=ea(),n=im().find(c=>c.type===t),a=[];return n&&"network"in n?n.network.forEach(c=>{c!==Ui&&r.includes(c)&&a.push(c)}):a=r,e!==Ui&&!a.includes(e)?[]:e===Ui?a:[e]},"useExploreNetwork");var ON=z({minutes:1}),QN=z({minutes:1}),qN=100,fm=i(({sortBy:e,sortDirection:t,timeFrame:r,network:o,limit:n,rankAlgo:a,enableQuery:c=!0})=>{let p=Se(),d=ws(o,"tokens"),m=qN;return ie({queryKey:pt.tokensV2({sortBy:e,sortDirection:t,timeFrame:r,networkIDs:d,limit:m,rankAlgo:a}),enabled:c,async queryFn(){let f=await p.getDeviceId();return hE({sortBy:e,sortDirection:t,timeFrame:r,networkIDs:d,limit:m,rankAlgo:a,anonymousId:f})},gcTime:QN,staleTime:ON,retry:3,select:i(f=>n>=m?f:{...f,items:f.items.slice(0,n)},"select")})},"useTokensV2");var ko=3,zN=15,Mi=50,yE={[ae.Trusted]:1,[ae.Verified]:2,[ae.NotVerified]:3,[ae.PossibleSpam]:4,[ae.Spam]:5},GN=i((e,t=100)=>{let[r,o]=(0,Ne.useState)(!1);return(0,Ne.useEffect)(()=>{let n;return e?n=setTimeout(()=>o(!0),t):o(!1),()=>clearTimeout(n)},[e,t]),r},"useDelayedLoading"),KN=i(e=>{let t=tE(e.chainId),r=A.getChainDefinition(e.chainId),o={name:e.name,symbol:e.symbol,logoUri:e.logoUrl,spamStatus:e.spamStatus,chain:{id:e.chainId,symbol:r.tokenSymbol,name:r.name,imageUrl:r.iconUrl}};switch(t){case oe.SPL:return{type:t,data:{...o,mintAddress:e.address}};case oe.ERC20:return{type:t,data:{...o,contractAddress:e.address}};case oe.BRC20:return{type:t,data:{...o,firstCreatedInscriptionId:e.address}};default:return null}},"mapExploreTokenToTokenMetadata"),jN=i(e=>e.reduce((t,r)=>{let o=KN(r);return o&&t.push(o),t},[]),"reduceExploreTokensToTokenMetadata"),VN=i(({searchQuery:e,networkIds:t,excludePlaceholderTokens:r=!1,extraDapps:o=[],actorSearchHook:n,enablePredictions:a=!1})=>{let[c,p]=(0,Ne.useState)(!1),[d,m]=(0,Ne.useState)(!1),[f,h]=(0,Ne.useState)(!1),[y,w]=(0,Ne.useState)(!1),[S,T]=(0,Ne.useState)(!1),[b,x]=(0,Ne.useState)(!1),E=ze("enable-monad-mainnet"),C=ze("enable-prediction-markets"),I=(0,Ne.useMemo)(()=>t.filter(mt=>A.isMonadNetworkID(mt)&&A.isMainnetNetworkID(mt)?E:pm.get(mt).tokenSearchEnabled()),[t,E]);(0,Ne.useEffect)(()=>{p(!1),m(!1),h(!1),w(!1),T(!1),x(!1)},[e]);let{data:B=[],isLoading:Q}=vi({query:e,networkIds:I,searchContext:"explore",enableQuery:!!e}),{data:N,isLoading:Z}=cm({limit:e?void 0:10,searchQuery:e}),q=am("tokens"),{data:k}=fm({sortBy:q?.sortByDefault??"rank",sortDirection:q?.sortDirectionDefault??"asc",timeFrame:q?.timeFrameDefault??"24h",network:q?.networkDefault??sn.Mainnet,limit:10,rankAlgo:q?.rankAlgo??"default",enableQuery:!e&&!r}),{tokens:F,perps:G}=(0,Ne.useMemo)(()=>B.sort((fr,Is)=>yE[fr.data.spamStatus??ae.NotVerified]-yE[Is.data.spamStatus??ae.NotVerified]).reduce((fr,Is)=>(Is.type===oe.HypercoreAsset?fr.perps.push(Is):fr.tokens.push(Is),fr),{tokens:[],perps:[]}),[B]),$=(0,Ne.useMemo)(()=>k?.items?jN(k.items):[],[k?.items]),X=e.length===0?zN:ko,H=(0,Ne.useMemo)(()=>F.slice(0,d?Mi:X),[d,F,X]),ve=(0,Ne.useMemo)(()=>G.slice(0,f?Mi:X),[f,G,X]),He=(0,Ne.useMemo)(()=>[...H.map(mt=>M(te(mt))),...$.map(mt=>M(te(mt)))],[H,$]),{data:dt={},isLoading:ji}=ao({query:{data:He},enabled:He.length>0}),Io=(0,Ne.useMemo)(()=>ve.map(mt=>M(te(mt))),[ve]),{data:Vi,isPending:Ae}=rm(Io,!0),{data:Ge=[],isLoading:We}=gE({networkIds:I,searchQuery:e},o),Ot=Ge.slice(0,c?Mi:ko),nr=n??(()=>({data:void 0,isLoading:!1})),{data:on,isLoading:Qm}=nr({query:e}),{results:ee=[],isSearching:Sk}=zA(a&&C?e:"",0),Br=!!e,$i=We||Q||Z||Qm||Sk,qm=Br&&!$i,bk=Tt(),{data:zm}=dm(bk),{actorsAll:Gm,actors:Km}=(0,Ne.useMemo)(()=>{let mt=on?.actors??[],fr=mt.slice(0,y?Mi:ko);return{actorsAll:mt,actors:fr}},[y,on?.actors]),jm=(0,Ne.useMemo)(()=>{if(N)return S?N:N.slice(0,X)},[N,S,X]),{predictionsAll:Vm,predictions:$m}=(0,Ne.useMemo)(()=>{let mt=C?ee:[],fr=mt.slice(0,b?Mi:ko);return{predictionsAll:mt,predictions:fr}},[ee,b,C]),_s=(0,Ne.useMemo)(()=>({actors:Km,dapps:Ge,searchedDapps:Ot,renderShowMoreDappsButton:Br&&Ge.length>ko,isLoading:$i,tokens:H,perps:ve,trendingTokens:$,renderShowMoreTokensButton:Br&&F.length>X,renderShowMorePerpsButton:Br&&G.length>X,renderShowMoreUsersButton:Br&&Gm.length>ko,priceMap:dt,isPriceMapLoading:ji,showSearchResults:qm,showMoreTokens:d,setShowMoreTokens:m,showMorePerps:f,setShowMorePerps:h,showMoreDapps:c,setShowMoreDapps:p,showMoreUsers:y,setShowMoreUsers:w,recentlyViewedSearchItems:zm,categories:jm,showMoreCategories:S,setShowMoreCategories:T,renderShowMoreCategoriesButton:Br&&N&&N?.length>ko,perpMarketMap:Vi,isPerpMarketMapLoading:Ae,predictions:$m,showMorePredictions:b,setShowMorePredictions:x,renderShowMorePredictionsButton:Br&&Vm.length>ko}),[Km,Ge,Ot,Br,$i,H,ve,$,F.length,G.length,X,Gm.length,dt,ji,qm,d,f,c,y,zm,jm,S,N,Vi,Ae,$m,Vm.length,b]),[Hm,Tk]=(0,Ne.useState)(null),xk=GN($i);return(0,Ne.useEffect)(()=>{_s.isLoading||Tk(e?_s:null)},[_s.isLoading,e]),{..._s.isLoading&&Hm?Hm:_s,showSpinner:xk&&Br}},"useExploreSearchList");u();l();u();l();var SE=P(O());u();l();var wE=i(async(e,t)=>{let r=new URLSearchParams({appVersion:Ce,limit:"6",locale:t,platform:Qt});e.forEach(c=>{r.append("chainIds[]",c)});let o=await K.api().noBearer().get("/explore/v1/featured-items",{params:r});if(!de(o))throw new Error("Failed to fetch featured items");let n=await o.data;if(!n.data||!Array.isArray(n.data))return[];let a=[];for(let c of n.data)try{let p=_A.parse(c);a.push(p)}catch{}return a},"getFeaturedItems");var $N=z({minutes:10}),HN=z({minutes:10}),WN=i(()=>{let{data:e}=Ie(),t=(0,SE.useMemo)(()=>e?eE(e):[],[e]),r=Sr(v.language)??"en",o=i(async()=>{if(!e)throw new Error("No account found");return wE(t,r)},"queryFn");return ie({queryKey:pt.featuredItems(t,r),enabled:!!e,queryFn:o,gcTime:$N,staleTime:HN})},"useExploreFeaturedItems");u();l();u();l();var ZN={rank:"trending",top:"top"},bE=i(async({sortBy:e,timeFrame:t,networkIDs:r,limit:o,locale:n,rankAlgo:a})=>{let c=new URLSearchParams({appVersion:Ce,limit:o.toString(),locale:n,platform:Qt,rankAlgo:a,rankBy:ZN[e],timeframe:t});r.forEach(m=>{c.append("chainIds[]",m)});let p=await K.api().noBearer().get("/explore/v1/trending-dapps",{params:c});if(!de(p))throw new Error("Failed to fetch sites");let d=CA.safeParse(p.data);if(!d.success)throw new Error("Failed to parse sites");return d.data},"getSitesV2");var YN=z({minutes:10}),XN=z({minutes:10}),JN=i(({sortBy:e,timeFrame:t,network:r,limit:o,rankAlgo:n})=>{let{data:a}=Ie(),c=ws(r,"sites"),p=Sr(v.language)??"en";return ie({queryKey:pt.sitesV2({sortBy:e,timeFrame:t,networkIDs:c,locale:p,limit:o,rankAlgo:n}),enabled:!!a,async queryFn(){if(!a)throw new Error("No account found");return bE({sortBy:e,timeFrame:t,networkIDs:c,locale:p,limit:o,rankAlgo:n})},gcTime:XN,staleTime:YN,retry:3})},"useSitesV2");u();l();u();l();var eB={rank:"trending",top:"volume"},tB=i(e=>e.floorPrices.length>0&&e.marketplacePages.length>0,"collectionWithValueAndMarketPlace"),TE=i(async({sortBy:e,timeFrame:t,networkIDs:r,limit:o,locale:n,rankAlgo:a})=>{let c=new URLSearchParams({appVersion:Ce,limit:o.toString(),locale:n,platform:Qt,rankAlgo:a,rankBy:eB[e],timeframe:t});r.forEach(m=>{c.append("chainIds[]",m.toString())});let p=await K.api().noBearer().get("/explore/v1/trending-collections",{params:c});if(!de(p))throw new Error("Failed to fetch collections");let d=FA.safeParse(p.data);if(!d.success)throw new Error("Failed to parse collections");return{...d.data,data:d.data.data.filter(tB)}},"getCollectionsV2");var rB=z({minutes:10}),oB=z({minutes:10}),nB=i(({sortBy:e,timeFrame:t,network:r,limit:o,rankAlgo:n})=>{let{data:a}=Ie(),c=ws(r,"collections"),p=Sr(v.language)??"en";return ie({queryKey:pt.collectionsV2({sortBy:e,timeFrame:t,networkIDs:c,locale:p,limit:o,rankAlgo:n}),enabled:!!a,async queryFn(){if(!a)throw new Error("No account found");return TE({sortBy:e,timeFrame:t,networkIDs:c,locale:p,limit:o,rankAlgo:n})},gcTime:oB,staleTime:rB,retry:3})},"useCollectionsV2");u();l();u();l();var xE=i(async(e,t)=>{let r=new URLSearchParams({appVersion:Ce,locale:t,platform:Qt});e.forEach(n=>{r.append("chainIds[]",n)});let o=await K.api().noBearer().get("/explore/v1/learn-grid",{params:r});if(!de(o))throw new Error("Failed to fetch learn grid");return o.data},"getLearnItems");var sB=z({minutes:10}),iB=z({minutes:10}),aB=i(()=>{let e=ea(),t=Sr(v.language)??"en";return ie({queryKey:pt.learn(e,t),enabled:e.length>0,async queryFn(){return xE(e,t)},gcTime:iB,staleTime:sB})},"useLearnV2");u();l();var en=P(Be(),1);u();l();var xs=P(O(),1);u();l();var gm={location:0,distance:50,threshold:.2,shouldSort:!0,keys:[{name:"token.name",weight:.4},{name:"token.symbol",weight:.4},{name:"token.caip19.chainId",weight:.2}]};var hm=30,cB=6,ym=3e4,wm=5,Sm=["100","500","1000"];u();l();u();l();var Ss="@phantom/fiat-ramp",Oi=`${Ss}:fungibles`,uB=`${Ss}:payment-methods`,lB=`${Ss}:providers`,pB=`${Ss}:recommended-quote`,dB=`${Ss}:status`,mB=`${Ss}:completed`,Co={fiatRampTokens(e,t,r){return[Oi,e,t,r]},fiatRampPaymentMethods(e,t,r){return[uB,e,t,r]},fiatRampProviders(e,t,r){return[lB,e,t,r]},fiatRampRecommendedQuote(e,t,r){return[pB,e,t,r]},fiatRampStatus(e,t,r){return[dB,e,t,r]},fiatRampCompleted(e,t,r){return[mB,e,t,r]}};u();l();u();l();u();l();var fB=s.object({name:s.string().nullish().default(null),symbol:s.string().nullish().default(null),decimals:s.number(),caip19:_t,logoURI:s.string().nullish().default(null)}),gB=s.object({token:fB,addressType:sf.optional()}),Tm=s.object({id:s.string(),name:s.string(),tag:s.string(),logo:s.string(),quote:s.object({displaySourceAmount:s.string(),displayDestinationAmount:s.string(),displayFee:s.string()}).optional()}),Yo;(function(e){e.CARD="CARD",e.MOBILE_WALLET="MOBILE_WALLET",e.BANK_TRANSFER="BANK_TRANSFER",e.EXCHANGE="EXCHANGE",e.LOCAL="LOCAL"})(Yo||(Yo={}));var xm=s.object({id:s.string(),type:s.nativeEnum(Yo),name:s.string(),estimatedArrival:s.string(),assets:s.object({icon:s.string(),roundIcon:s.string()}),description:s.string().optional()}),TCe=s.object({groups:s.array(s.object({groupName:s.string(),tokens:s.array(gB)}))}),xCe=s.object({paymentMethods:s.array(xm),provider:Tm.optional()}),ACe=s.object({providers:s.array(Tm),paymentMethod:xm,token:_t}),ECe=s.object({provider:Tm,paymentMethod:xm,location:s.object({countryCode:s.string(),subdivision:s.string().optional()}).optional(),token:_t.optional(),tokenAmount:s.string().optional(),fiatAmount:s.string().optional(),fiatCurrencyCode:s.string().optional(),minPurchaseAmount:s.string().optional(),maxPurchaseAmount:s.string().optional(),quickSelectDenominations:s.array(s.string()).optional()}),kCe=s.object({url:s.string(),sessionId:s.string()}),bm;(function(e){e.PENDING="PENDING",e.COMPLETED="COMPLETED",e.FAILED="FAILED"})(bm||(bm={}));var CCe=s.object({status:s.nativeEnum(bm),tokenAmount:s.number().optional(),fiatCurrencyCode:s.string().optional(),usdFiatAmount:s.number().optional(),usdFiatFeeAmount:s.number().optional(),fiatFeeAmount:s.number().optional(),cryptoTransactionId:s.string().optional(),createdAt:s.date().optional(),updatedAt:s.date().optional()}),Lt=class extends Error{static{i(this,"FiatRampError")}constructor(t){super(t),this.name="FiatRampError"}};var AE=new Lt("Failed to get FiatRampPaymentMethods"),EE=i(async(e,t,r)=>{try{let o=await K.api().headers(e).bearer(r).post("/fiat_ramp/v2/onramp/payment_methods",t);if(!de(o))throw AE;return o.data}catch{throw AE}},"getPaymentMethods");var hB=z({days:7}),yB=z({hours:1}),Qi=i((e,t,r,o)=>{let n={"x-client-platform":e,"x-client-app-version":t,"x-client-locale":r},{data:a}=wr(),c=a?.userID,p=a?.accessToken;return ie({queryKey:Co.fiatRampPaymentMethods(n,o,c),queryFn:i(()=>EE(n,o,p),"queryFn"),gcTime:hB,staleTime:yB})},"useFiatRampPaymentMethods");u();l();u();l();var kE=new Lt("Failed to get FiatRampProviders"),CE=i(async(e,t,r)=>{try{let o=await K.api().headers(e).bearer(r).post("/fiat_ramp/v2/onramp/providers",t);if(!de(o))throw kE;return o.data}catch{throw kE}},"getProviders");var wB=z({seconds:hm}),SB=z({hours:1}),Am=i((e,t,r,o)=>{let n={"x-client-platform":e,"x-client-app-version":t,"x-client-locale":r},{data:a}=wr(),c=a?.userID,p=a?.accessToken;return ie({queryKey:Co.fiatRampProviders(n,o,c),queryFn:i(()=>CE(n,o,p),"queryFn"),gcTime:SB,staleTime:wB,enabled:!!o.destinationAddress})},"useFiatRampProviders");u();l();u();l();var _E=new Lt("Failed to get FiatRampRecommendedQuote"),IE=i(async(e,t,r)=>{try{let o=await K.api().headers(e).bearer(r).post("/fiat_ramp/v2/onramp/recommended_quote",t);if(!de(o))throw _E;return o.data}catch{throw _E}},"getRecommendedQuote");var bB=z({days:7}),TB=z({hours:1}),Zu=i((e,t,r,o,n=!0)=>{let a={"x-client-platform":e,"x-client-app-version":t,"x-client-locale":r},{data:c}=wr(),p=c?.userID,d=c?.accessToken;return ie({queryKey:Co.fiatRampRecommendedQuote(a,o,p),queryFn:i(()=>IE(a,o,d),"queryFn"),gcTime:bB,staleTime:TB,enabled:n})},"useFiatRampRecommendedQuote");u();l();u();l();var FE=new Lt("Failed to get FiatRampTokens"),vE=i(async(e,t,r)=>{try{let o=await K.api().headers(e).bearer(r).post("/fiat_ramp/v2/onramp/tokens",t);if(!de(o))throw FE;return o.data}catch{throw FE}},"getSupportedFiatRampTokens");u();l();var Yu=i(e=>e.sort((t,r)=>A.compareNetworkID(t.token.caip19.chainId,r.token.caip19.chainId)),"sortFiatTokens");var xB=z({days:7}),AB=z({hours:1}),bs=i((e,t,r,o=!0,n)=>{let{data:a}=Ie(),c=Array.from(new Set(a?.addresses?.map(w=>w.networkID))),p=Array.from(new Set(a?.addresses?.map(w=>w.addressType))),d={chainIDs:c},m={"x-client-platform":e,"x-client-app-version":t,"x-client-locale":r},{data:f}=wr(),h=f?.userID,y=f?.accessToken;return ie({queryKey:Co.fiatRampTokens(m,d,h),queryFn:i(()=>vE(m,d,y),"queryFn"),gcTime:xB,staleTime:AB,enabled:o&&c.length>0,select:i(w=>{let S={...w,groups:w.groups.map(T=>({...T,tokens:Yu(T.tokens.filter(b=>b.addressType?p.includes(b.addressType):!0))}))};return n?n(S):S},"select")})},"useFiatRampGroupedTokens");u();l();u();l();var PE=i(e=>{let t=e?.groups.flatMap(r=>r.tokens)??[];return Yu(t)},"flattenAndSortTokens");var Ts=i((e,t,r,o=!0)=>bs(e,t,r,o,PE),"useAllFiatRampTokens");u();l();var ro={onClose:i(()=>{},"onClose"),context:"modal",fungible:void 0,purchaseAmount:"0",purchaseType:"currency",isPurchaseAmountValid:!1,error:void 0,redirectErrorMessage:void 0,ownerPublicKey:"",price:0,minPurchaseAmountUsd:wm,maxPurchaseAmountUsd:ym,quickSelectDenominations:Sm,paymentMethod:void 0,provider:void 0,checkoutQuoteType:"recommended",redirectURL:void 0,stripePaymentMethod:void 0},Ut=Ye(e=>({...ro,setState:i(t=>e(r=>({...r,...t})),"setState"),reset:i(()=>{e(ro)},"reset")}));var RE=i(({platform:e,version:t,onClosePress:r,onNextPress:o})=>{let n=Se(),{i18n:a}=Fe(),c=a.language,{setState:p}=Ut(),{data:d}=Ie(),m=Array.from(new Set(d?.addresses?.map(N=>N.addressType))),{data:f=[]}=Ts(e,t,c),{data:h,isPending:y,isFetching:w,isError:S}=bs(e,t,c),T=h?.groups??[],b=y||w||S,[x,E]=(0,xs.useState)(""),C=na(x)??"",I=x.length>0,B=Lg(f,C,gm),Q=(0,xs.useCallback)(({tokenWithMetadata:N,ownerPublicKey:Z})=>{let{token:q}=N,{name:k,symbol:F,caip19:G}=q,{chainId:$}=G;n.capture("fiatOnrampFungibleSelected",{data:{networkId:$,chainId:A.getChainID($),asset:{name:k,symbol:F,type:"fungible"}}}),p({...ro,onClose:r,ownerPublicKey:Z,fungible:N.token,paymentMethod:void 0,provider:void 0}),o()},[n,r,o,p]);return(0,xs.useEffect)(()=>{n.capture("fiatOnrampInitiated")},[n]),{enabledAddressTypes:m,groupedTokens:T,isLoading:b,isSearching:I,searchedTokens:B,searchTerm:x,selectedAccount:d,onClosePress:r,onTokenPress:Q,setSearchTerm:E}},"useFiatRampSelectFungible");u();l();var Mt=P(Be(),1);u();l();var Jo=P(Be(),1),UE=P(O(),1);u();l();var Em=P(Be(),1);var km=i(({marginBottom:e=0})=>{let{t}=Fe(),{data:[r]}=yr(["enable-buy-flow-warning"]);return r?(0,Em.jsx)(ge,{marginBottom:e,children:(0,Em.jsx)(Of,{level:"4-error",children:t("buyFlowHealthWarning")})}):null},"BuyFlowWarning");u();l();var _o=P(Be(),1);u();l();var oo=P(Be(),1);var As=P(O(),1);u();l();var dr=P(Be(),1);var NE=P(O(),1);var Xu=48,Cm=NE.default.memo(({networkId:e,logoURI:t,type:r})=>{let o=EB({disableBadge:!1,tokenType:r,chain:A.getChainID(e)});return(0,dr.jsxs)(ge,{size:Xu,position:"relative",children:[t?(0,dr.jsx)(Ur,{src:t,height:Xu,width:Xu,borderRadius:"circle",fallback:(0,dr.jsx)(DE,{})}):(0,dr.jsx)(DE,{}),o?(0,dr.jsx)(kB,{networkId:e}):null]})}),DE=i(()=>(0,dr.jsx)(ge,{alignItems:"center",justifyContent:"center",size:Xu,backgroundColor:"areaBase",borderRadius:"circle",children:(0,dr.jsx)(io.Coin,{size:"50%",color:"borderBase"})}),"TokenImageFallback"),EB=i(({disableBadge:e,tokenType:t,chain:r})=>e?!1:ar.get(r).alwaysShowNetworkBadge?!0:!xt(t),"showNetworkBadge"),kB=i(({networkId:e})=>(0,dr.jsx)(ge,{right:"-2",bottom:"-2",position:"absolute",borderColor:"elementBase",borderStyle:"solid",borderWidth:2,style:{borderRadius:9},children:(0,dr.jsx)(Qg,{networkID:e,size:18})}),"ChainBadge");u();l();var Xo=P(Be(),1);var BE=i(({image:e,name:t,symbol:r,onPress:o})=>(0,Xo.jsx)(ge,{backgroundColor:"elementBase",borderRadius:"base",padding:16,onPress:o,children:(0,Xo.jsxs)(ge,{gap:12,children:[e,(0,Xo.jsxs)(ge,{gap:4,alignItems:"flex-start",children:[(0,Xo.jsx)(gt,{children:t}),(0,Xo.jsx)(gt,{color:"textDiminished",children:r})]})]})}),"TokenCard");var qi=As.default.memo(({enabledAddressTypes:e,selectedAccount:t,tokenWithMetadata:r,type:o,onPress:n})=>{let{token:a,addressType:c}=r,{caip19:p,logoURI:d,name:m,symbol:f}=a,{chainId:h}=p,y=hg(p),{t:w}=Fe(),S=m??w("assetDetailUnknownToken"),T=(0,As.useMemo)(()=>{let x=t?.addresses.find(E=>c?E.addressType===c&&E.networkID===h:E.networkID===h)?.address??"";return A.isEVMNetworkID(h)?x.toLowerCase():x},[t,c,h]),b=(0,As.useCallback)(()=>{n({tokenWithMetadata:r,ownerPublicKey:T})},[n,r,T]);return c&&!e.includes(c)?(0,oo.jsx)(oo.Fragment,{}):o==="card"?(0,oo.jsx)(BE,{onPress:b,image:(0,oo.jsx)(Cm,{logoURI:d,networkId:p.chainId,type:y}),name:S,symbol:f}):(0,oo.jsx)(oa,{onPress:b,start:(0,oo.jsx)(Cm,{logoURI:d,networkId:p.chainId,type:y}),topLeft:{text:S,after:(0,oo.jsx)(qg,{networkID:p.chainId,address:T})},bottomLeft:f})});var LE=i(({enabledAddressTypes:e,group:t,groupIndex:r,selectedAccount:o,onTokenPress:n})=>{let a=r===0;return(0,_o.jsxs)(ge,{marginTop:a?8:24,children:[(0,_o.jsx)(gt,{font:Fo?"bodyMedium":"title3Semibold",color:"textDiminished",marginBottom:8,children:t.groupName}),(0,_o.jsx)(ge,{flexWrap:"wrap",direction:"row",gap:a?0:"list",children:t.tokens.map((c,p)=>{let{token:d,addressType:m}=c,f=`${d.symbol}-${d.caip19.chainId}-${p}`;return m&&!e.includes(m)?null:a?(0,_o.jsx)(ge,{flexBasis:"50%",paddingLeft:p%2===0?0:4,paddingRight:p%2===0?4:0,paddingBottom:p>=t.tokens.length-2?0:8,children:(0,_o.jsx)(qi,{enabledAddressTypes:e,selectedAccount:o,tokenWithMetadata:t.tokens[p],type:"card",onPress:n})},f):(0,_o.jsx)(qi,{tokenWithMetadata:t.tokens[p],enabledAddressTypes:e,selectedAccount:o,type:"row",onPress:n},f)})})]},t.groupName)},"FiatRampTokenGroup");var ME=UE.default.memo(({groupedTokens:e,enabledAddressTypes:t,selectedAccount:r,onTokenPress:o})=>(0,Jo.jsxs)(Jo.Fragment,{children:[(0,Jo.jsx)(km,{marginBottom:16}),e.map((n,a)=>(0,Jo.jsx)(LE,{enabledAddressTypes:t,group:n,groupIndex:a,onTokenPress:o,selectedAccount:r},n.groupName))]}));u();l();var Es=P(Be(),1);var OE=P(O(),1);var QE=OE.default.memo(({enabledAddressTypes:e,searchedTokens:t,selectedAccount:r,onTokenPress:o})=>(0,Es.jsx)(Es.Fragment,{children:t.map((n,a)=>(0,Es.jsx)(ge,{marginBottom:8,children:(0,Es.jsx)(qi,{enabledAddressTypes:e,selectedAccount:r,tokenWithMetadata:n,type:"row",onPress:o})},`${n.token.symbol}-${n.token.caip19.chainId}-${a}`))}));var qE=i(e=>{let{isLoading:t,isSearching:r,searchedTokens:o,selectedAccount:n,enabledAddressTypes:a,onTokenPress:c,groupedTokens:p}=e;return(0,Mt.jsx)(Mt.Fragment,{children:t?(0,Mt.jsx)(CB,{}):r?(0,Mt.jsx)(Mt.Fragment,{children:o.length>0?(0,Mt.jsx)(QE,{searchedTokens:o,selectedAccount:n,enabledAddressTypes:a,onTokenPress:c}):(0,Mt.jsx)(_B,{})}):(0,Mt.jsx)(ME,{enabledAddressTypes:a,groupedTokens:p,selectedAccount:n,onTokenPress:c})})},"FiatRampFungiblesCore"),CB=i(()=>(0,Mt.jsx)(ge,{gap:"list",paddingTop:"screen",children:[...Array(3)].map((e,t)=>(0,Mt.jsx)(fn,{topRight:!1,bottomRight:!1},t))}),"FiatRampTokensLoading"),_B=i(()=>{let{t:e}=Fe();return(0,Mt.jsx)(ge,{flex:1,alignItems:"center",justifyContent:"center",children:(0,Mt.jsx)(gt,{font:"body",color:"textDiminished",align:"center",children:e("noBuyOptionsAvailableInCountry")})})},"FiatRampTokensEmpty");var zE={container:fl({display:"flex",flexDirection:"column",height:"100%"}),listContainer:fl({overflow:"auto",minHeight:0,paddingTop:16,paddingBottom:80})},GE=i(({platform:e,navigateToForm:t,onBackPress:r})=>{let{t:o}=Fe(),n=RE({platform:e,version:Ce,onClosePress:r,onNextPress:t});return(0,en.jsxs)(ge,{flex:1,className:zE.container,children:[(0,en.jsx)(Mf,{id:"search",label:"Search",showLabel:!1,placeholder:o("assetListSearch"),setValue:n.setSearchTerm,value:n.searchTerm||"",children:(0,en.jsx)(io.Search,{size:16,color:"textDiminished"})}),(0,en.jsx)(ge,{flex:1,className:zE.listContainer,children:(0,en.jsx)(qE,{...n})})]})},"FiatRampFungibles");u();l();u();l();var $E=P(Be(),1);u();l();var it=P(Be(),1);var Ju=P(O(),1);u();l();var ks=P(Be());var KE=i(({platform:e,navigateToAllProviders:t})=>{let{t:r}=Fe(),o=Ut(),{provider:n,fungible:a}=o,{currencyCode:c}=ht(),{data:p}=Qi(e,Ce,v.language,{token:a?.caip19,fiatCurrencyCode:c,providerId:n?.id}),d=p?.provider||n;return(0,ks.jsxs)(ge,{onPress:t,direction:"row",alignItems:"center",justifyContent:"flex-start",gap:4,children:[(0,ks.jsx)(Ur,{borderRadius:6,width:20,height:20,src:d?.logo??""}),(0,ks.jsx)(gt,{font:"captionSemibold",color:"textBase",children:d?.name||r("fiatRampChangeProviderTitle")}),(0,ks.jsx)(io.ChevronDown,{size:16})]})},"FiatRampSelectedProvider");u();l();var no=P(Be(),1);var jE=P(O(),1);var _m=i(({assets:e,type:t,name:r,onClick:o,estimatedArrival:n})=>{let a=(0,jE.useMemo)(()=>{let c=(0,no.jsx)(ge,{borderRadius:"circle",size:48,alignItems:"center",justifyContent:"center",backgroundColor:"black",children:(0,no.jsx)(Ur,{width:28,height:28,src:e.icon})});switch(t){case Yo.CARD:return(0,no.jsx)(Ps,{icon:"CreditCard",size:48,backgroundColor:"black",color:"white"});case Yo.BANK_TRANSFER:return(0,no.jsx)(Ps,{icon:"Bank",size:48,backgroundColor:"black",color:"white"});case Yo.MOBILE_WALLET:return r.toLowerCase().includes("apple")?(0,no.jsx)(Ps,{icon:"LogoApplePay",size:48,backgroundColor:"black",color:"white"}):r.toLowerCase().includes("google")?(0,no.jsx)(Ps,{icon:"LogoGooglePay",size:48,backgroundColor:"black",color:"white"}):c;default:return c}},[e.icon,r,t]);return(0,no.jsx)(Qf,{rows:[{type:"base",start:a,topLeft:{text:r,font:"title3Semibold"},bottomLeft:{before:(0,no.jsx)(io.Clock,{color:"textDiminished",size:14}),text:n},onPress:o}]})},"FiatRampPaymentMethodRow");var IB=["ios","android"],VE=i(({platform:e,navigateToAllProviders:t,navigateToForm:r})=>{let{t:o}=Fe(),n=Se(),a=Ut(),c=Ut(E=>E.setState),{provider:p,fungible:d}=a,{currencyCode:m}=ht(),{data:f,isFetching:h,isPending:y}=Qi(e,Ce,v.language,{token:d?.caip19,fiatCurrencyCode:m,providerId:p?.id}),{provider:w,paymentMethods:S}=f??{},T=w||p,b=(0,Ju.useCallback)(E=>{c({paymentMethod:E,provider:T,checkoutQuoteType:"selected"}),n.capture("fiatOnrampPaymentMethodSelected",{data:{paymentMethodId:E.id}}),r()},[n,r,T,c]),x=(0,Ju.useMemo)(()=>h||y?(0,it.jsx)(it.Fragment,{children:[...Array(3)].map((E,C)=>(0,it.jsx)(fn,{topRight:!1,bottomRight:!1},C))}):S?.length===0?(0,it.jsx)(FB,{}):(0,it.jsx)(it.Fragment,{children:S?.map(E=>(0,it.jsx)(_m,{onClick:i(()=>b(E),"onClick"),...E},E.id))}),[h,y,b,S]);return(0,it.jsxs)(ge,{gap:12,children:[!IB.includes(e)&&(0,it.jsxs)(ge,{direction:"row",alignItems:"center",gap:16,justifyContent:"space-between",children:[(0,it.jsx)(gt,{font:"title1Semibold",color:"textBase",children:o("fiatRampPaymentMethodsTitle")}),(0,it.jsx)(KE,{platform:e,navigateToAllProviders:t})]}),(0,it.jsx)(gt,{font:"label",color:"textDiminished",children:o("buyThirdPartyScreenPaymentMethodDescription")}),(0,it.jsx)(ge,{gap:8,children:x})]})},"FiatRampPaymentMethodsCore"),FB=i(()=>{let{t:e}=Fe();return(0,it.jsx)(ge,{flex:1,alignItems:"center",justifyContent:"center",children:(0,it.jsx)(gt,{font:"body",color:"textDiminished",align:"center",children:e("buyThirdPartyScreenPaymentMethodEmptyState")})})},"FiatRampPaymentMethodsEmpty");var HE=i(({platform:e,navigateToAllProviders:t,navigateToForm:r})=>(0,$E.jsx)(VE,{platform:e,navigateToAllProviders:t,navigateToForm:r}),"FiatRampPaymentMethods");u();l();var YE=P(Be(),1);u();l();var WE=P(O(),1),or=P(Be(),1);var el=P(O(),1);var ZE=i(({platform:e,navigateToPaymentMethods:t})=>{let{t:r}=Fe(),o=Se(),n=ze("enable-fiat-ramp-provider-quotes"),a=Ut(),c=Ut(C=>C.setState),{paymentMethod:p,purchaseType:d,purchaseAmount:m,fungible:f,ownerPublicKey:h}=a,{currencyCode:y}=ht(),{data:w,isFetching:S,isPending:T}=Am(e,Ce,v.language,{...d==="currency"?{fiatAmount:m}:{tokenAmount:m},token:f?.caip19,fiatCurrencyCode:y,destinationAddress:h&&f?{address:h,chainId:f?.caip19.chainId,resourceType:J.address}:void 0}),b=w?.paymentMethod||p,x=(0,el.useCallback)(C=>{o.capture("fiatOnrampProviderSelected",{data:{chainId:w?.token?.chainId,providerId:C.id,paymentMethodId:b?.id,destinationAmount:C.quote?.displayDestinationAmount,sourceAmount:C.quote?.displaySourceAmount,asset:w?.token,tag:C.tag}}),c({provider:C,paymentMethod:b,checkoutQuoteType:"selected"}),t?.()},[o,w?.token,c,b,t]),E=(0,el.useMemo)(()=>w?.providers.map((C,I)=>{let B=C.id===a.provider?.id;return n?{type:"base",start:(0,or.jsx)(Ur,{width:48,height:48,borderRadius:6,src:C.logo}),topLeft:C.name,topRight:{text:C.quote?.displayDestinationAmount,color:"textBase"},bottomRight:C.quote?.displaySourceAmount?{text:`~${C.quote.displaySourceAmount}`}:void 0,bottomLeft:C.tag&&{text:C.tag,color:I===0?"spotPositive":"textDiminished"},onPress:i(()=>x(C),"onPress")}:{type:"radio",active:B,start:(0,or.jsx)(Ur,{width:24,height:24,borderRadius:6,src:C.logo}),topLeft:C.name,topRight:C.tag,onPress:i(()=>x(C),"onPress")}})??[],[a.provider?.id,n,x,w?.providers]);return(0,or.jsxs)(ge,{gap:16,children:[(0,or.jsx)(gt,{font:"label",color:"textDiminished",children:r("buyThirdPartyScreenProvidersDescription")}),(0,or.jsx)(ge,{gap:8,children:S||T?(0,or.jsx)(PB,{}):w?.providers.length===0?(0,or.jsx)(vB,{}):E.map(C=>(0,WE.createElement)(oa,{...C,key:C.topLeft}))})]})},"FiatRampProvidersCore"),vB=i(()=>{let{t:e}=Fe();return(0,or.jsx)(ge,{flex:1,alignItems:"center",justifyContent:"center",children:(0,or.jsx)(gt,{font:"body",color:"textDiminished",align:"center",children:e("buyThirdPartyScreenProvidersEmptyState")})})},"FiatRampProvidersEmpty"),PB=i(()=>[...Array(3)].map((e,t)=>(0,or.jsx)(fn,{topRight:!1,bottomRight:!1},t)),"LoadingTable");var XE=i(({platform:e,navigateToPaymentMethods:t})=>(0,YE.jsx)(ZE,{platform:e,navigateToPaymentMethods:t}),"FiatRampProviders");u();l();u();l();u();l();var tn=P(O(),1);u();l();var tl=P(O(),1);var Im=i(({clientPlatform:e,appVersion:t,locale:r,caip19:o,addressType:n,enabled:a=!0,destinationAddress:c})=>{let{data:p,isLoading:d,isError:m,isFetched:f}=Ie(),{data:h=[],isLoading:y,isError:w,isFetched:S}=Ts(e,t,r,a),T=(0,tl.useMemo)(()=>{if(o)return h.find(x=>n&&A.getChainName(et(o).chainId)===A.bitcoin.name?M(x.token.caip19)===o&&"addressType"in x&&x.addressType===n:M(x.token.caip19)===o)},[n,o,h]),b=(0,tl.useMemo)(()=>{if(!T)return"";if(c)return c;let x=p?.addresses.find(E=>T?.addressType?E.addressType===T.addressType&&E.networkID===T?.token.caip19.chainId:E.networkID===T?.token.caip19.chainId)?.address??"";return T?.token.caip19.chainId&&A.isEVMNetworkID(T.token.caip19.chainId)&&(x=x.toLowerCase()),x},[c,p?.addresses,T]);return(0,tl.useMemo)(()=>({tokenToBuy:T,destinationAddress:b,isLoading:d||y,isError:m||w,isFetched:f&&S}),[b,w,m,S,f,y,d,T])},"useFiatRampTokenMetadataFromCaip19");var JE=i(({caip19:e,amount:t,clientPlatform:r,redirectURL:o,addressType:n,destinationAddress:a,provider:c,paymentMethod:p,navigateToFiatRampForm:d,onClose:m,captureAnalyticsEvent:f})=>{let{setState:h}=Ut(),{tokenToBuy:y,destinationAddress:w,isLoading:S,isError:T,isFetched:b}=Im({clientPlatform:r,appVersion:Ce,locale:v.language,caip19:e,addressType:n,destinationAddress:a}),x=(0,tn.useMemo)(()=>{if(y)return{token:y?.token.caip19,providerId:c,paymentMethodId:p,destinationAddress:{address:w,chainId:y?.token.caip19?.chainId,resourceType:J.address}}},[y,c,p,w]),{data:E,isLoading:C}=Zu(r,Ce,v.language,x??{},!!x&&!!c&&!!p),I=(0,tn.useMemo)(()=>e?C?!1:!!y&&!!w:!0,[e,C,w,y]),B=(0,tn.useCallback)(()=>{!e||!y||!w||h({...ro,onClose:m??(()=>{}),ownerPublicKey:w,fungible:y?.token,purchaseAmount:t??ro.purchaseAmount,redirectURL:o,provider:E?.provider,paymentMethod:E?.paymentMethod})},[e,y,w,h,m,t,o,E?.provider,E?.paymentMethod]),Q=(0,tn.useCallback)(()=>{if(!e){f?.(),d?.();return}!y||!w||(B(),f?.(),d?.())},[e,f,w,d,B,y]);return(0,tn.useMemo)(()=>({canBuy:I,openBuy:Q,saturateState:B,resolvedDestinationAddress:w,token:y,isLoading:S,isError:T,isFetched:b}),[I,w,T,b,S,Q,B,y])},"useBuyFlowForToken");u();l();var RB=new Lt("Failed to get FiatRampProviderUrl"),DB=i(async(e,t,r,o,n)=>{try{let a={"x-client-platform":e,"x-client-app-version":t,"x-client-locale":r},c=await K.api().headers(a).bearer(n).post("/fiat_ramp/v2/onramp/provider_url",o);if(!de(c))throw new Lt(c.data.message);return c.data}catch(a){throw a instanceof Lt?a:RB}},"getProviderUrl");u();l();var rl=P(O());var NB=["enable","reject"],BB=i(({continueSwap:e,dismiss:t})=>{let r=Se(),{setSlippageSetting:o}=fo(),n=(0,rl.useCallback)(c=>{switch(t(),c){case"enable":r.capture("autoSlippageOptIn",{data:{step:"enabledAutoSlippage"}}),o({type:ce.Auto}),_i();break;case"reject":r.capture("autoSlippageOptIn",{data:{step:"rejectedAutoSlippage"}}),o({type:ce.Fixed}),e();break}},[e,t,o,r]),a=(0,rl.useMemo)(()=>NB.map(c=>({label:v.t(c==="enable"?"swapSlippageOptInEnableOption":"swapSlippageOptInRejectOption"),variant:c==="enable"?"primary":"secondary",onPress:i(()=>n(c),"onPress")})),[n]);return{title:v.t("swapSlippageOptInTitle"),description:v.t("swapSlippageOptInSubtitle"),learnMoreText:v.t("commandLearnMore"),learnMoreUrl:GT,options:a}},"useAutoSlippageOptInProps");u();l();var tk=P(O());u();l();var Cs=P(O());var LB=L(1);function ek(e,t,r){let o=Se(),[n,a]=(0,Cs.useState)(!1),c=(0,Cs.useCallback)(async()=>{await o.capture("swapperToggleBestPriceRatio",{data:{unitCurrency:n?"buy token":"sell token"}}),a(!n)},[o,n]),p=j(m=>m.sellFungible),d=j(m=>m.buyFungible);return(0,Cs.useMemo)(()=>{let m=!1,f="";if(t&&r){let h=d?.data,y=p?.data;if(h&&y){let{buyAmount:w,sellAmount:S}=r,T=ke(w,h.decimals),b=ke(S,y.decimals),x=T.dividedBy(b),E=`1 ${y.symbol} \u2248 ${Ln(x)} ${h.symbol}`,C=`1 ${h.symbol} \u2248 ${Ln(LB.dividedBy(x))} ${y.symbol}`;m=new L(r.buyAmount).isEqualTo(e),f=n?C:E}}return{isBestRate:m,rate:f,flip:c}},[e,r,n,t,p,d,c])}i(ek,"useExchangeRate");var UB=i(({selectProvider:e})=>{let{currentQuote:t,quoteResponse:r}=rt(),{currencySymbol:o,fromUsd:n}=ht(),a=t?.buyAmount??"",c=ek(a,r,t),p=Ja(Oe(t)),d=t?.baseProvider.name??"";return{details:(0,tk.useMemo)(()=>t?se(t)?OB({quote:t,selectProvider:e,exchangeRate:c,currencySymbol:o,fromUsd:n}):MB({provider:d,sources:p,exchangeRate:c,selectProvider:e}):[],[t,d,p,c,e,o,n]),footnote:v.t("swapProviderPricingFootnote")}},"useSwapPricing"),MB=i(({provider:e,sources:t,exchangeRate:r,selectProvider:o})=>[{label:v.t("swapProviderPricingProvider"),value:e,icon:"chevron-right",onPress:o},{label:v.t("swapProviderPricingMarket"),value:t},{label:v.t("swapProviderPricingPrice"),value:r.rate,icon:"swap",onPress:r.flip}],"getStandardRows"),OB=i(({quote:e,selectProvider:t,exchangeRate:r,currencySymbol:o,fromUsd:n})=>{let a=e.baseProvider.name,c=Zn(e).toString(),p=vr(xo(e));return[{label:v.t("swapProviderPricingProvider"),value:a,icon:"chevron-right",onPress:t},{label:v.t("swapProviderPricingPrice"),value:r.rate,icon:"swap",onPress:r.flip},{label:v.t("swapProviderPricingFees"),value:`${o}${n(Number(c),2)} ${v.t("swapProvidersFee")}`},{label:v.t("swapProviderPricingTime"),value:p}]},"getBridgeRows");u();l();u();l();var Fm=P(O());var QB=.05,qB=i(({sellNetworkId:e,buyNetworkId:t,destinationMinRequiredBalance:r,priceMap:o})=>{if(!e||!t||!o)return new _(0);let n=M(hr(A.getChainID(e))),a=M(hr(A.getChainID(t))),c=o[n]?.usd,p=o[a]?.usd;if(!c||!p)return new _(0);let d=ke(r.toNumber(),A.getTokenDecimals(t)),m=vg(d.toNumber(),p),f=Pg(m,c,A.getTokenDecimals(e));return new _(f).times(1+QB)},"getSourceBridgeFeeForMinRequiredBalance"),rk=i(({sellFungible:e,buyFungible:t})=>{let r=e?.data.chain.id,o=t?.data.chain.id,n=o??r,a=$t(r,o),{fungible:c}=ya({key:t?.data.key}),{data:p}=Ie(),d=(0,Fm.useMemo)(()=>p?.addresses.find(w=>w.networkID===n),[p,n]),f=Eo().map(w=>hr(w)),{data:h}=ao({query:{data:f},queryOptions:{refetchInterval:!1}}),{data:y=0}=Ro(d);return(0,Fm.useMemo)(()=>{if(c)return new _(0);let w=new _(y);return a?qB({sellNetworkId:r,buyNetworkId:o,destinationMinRequiredBalance:w,priceMap:h}):w},[c,y,a,r,o,h])},"useDestinationMinRequiredBalance");u();l();var vm=P(O());var ok=i(e=>{let t=e?.data.chain.id,{data:r}=Ie(),o=(0,vm.useMemo)(()=>r?.addresses.find(a=>a.networkID===t),[r,t]),{data:n=0}=Ro(o);return(0,vm.useMemo)(()=>new _(n),[n])},"useSourceMinRequiredBalance");u();l();function nk({sellFungible:e,totalFees:t,minRequiredBalance:r,currentQuote:o}){let n=e?.type?xt(e?.type):!1,{source:a,destination:c}=r;if(n){let p=new _(o?.sellAmount??0);return t.plus(p)}else{let p=a.plus(c);return t.plus(p)}}i(nk,"getTotalNativeRequirement");u();l();function sk({sellFungible:e,sellNativeFungible:t,totalNativeRequirement:r}){let o=e?.data.chain.id,n=t?Ft(t.data.amount,t.data.decimals):"-",a=t?Ft(r,t.data.decimals):"-";return{networkId:o,balance:n,required:a}}i(sk,"getInsufficientBalanceArgs");u();l();var ik=P(O());var zB=i(({goToAssetSelect:e})=>{let{setSearchQuery:t}=j();return(0,ik.useCallback)(r=>{r==="buy"&&t(""),e(r)},[e,t])},"useOnSwapAssetSelect");u();l();var Nr=P(O());u();l();u();l();var ol=class{static{i(this,"StandardProviderRowStrategy")}getRow({quote:t,buyToken:r}){let o=`${cr(ke(t.buyAmount,r.decimals),ar.get(r.networkId).formDisplayPrecision)} ${r.symbol}`;return{type:"standard",key:t.baseProvider.id,logoUri:t.baseProvider.logoUri,topLeft:{text:t.baseProvider.name},topRight:{text:o,color:"textDiminished"}}}getAutoRow(){return{type:"standard",key:ur,topLeft:{text:v.t("selectSwapProviderAutoLabel")},topRight:{text:v.t("selectSwapProviderAutoDescription"),color:"textDiminished"}}}},Pm=class extends ol{static{i(this,"BridgeProviderRowStrategy")}getRow(t){let{quote:r,currencySymbol:o,fromUsd:n}=t;if(!se(r))throw new Error("Quote is not a bridge quote");let a=super.getRow(t),c=vr(xo(r)),p=Zn(r).toString();return{...a,type:"bridge",bottomLeft:{text:c},bottomRight:{text:`${o}${n(Number(p),2)} ${v.t("swapProvidersFee")}`}}}getAutoRow(){return{type:"bridge",key:ur,topLeft:{text:v.t("selectSwapProviderAutoLabel")},topRight:{text:v.t("selectSwapProviderAutoDescription"),color:"textDiminished"},bottomLeft:{text:v.t("selectSwapProviderAutoTBD")},bottomRight:{text:v.t("selectSwapProviderAutoTBD")}}}},Rm=new ol,Dm=new Pm;var nl=i(({quoteResponse:e,buyToken:t,currencySymbol:r,setSelectedProvider:o,fromUsd:n})=>{let a=e.type==="xchain",c=a?Dm.getAutoRow():Rm.getAutoRow(),p={...c,onPress:i(()=>o(c.key),"onPress")},d=e.quotes.reduce((m,f)=>{let y=(a?Dm:Rm).getRow({quote:f,buyToken:t,currencySymbol:r,fromUsd:n});return[...m,{...y,onPress:i(()=>o(f.baseProvider.id),"onPress")}]},[]);return[p,...d]},"getSwapProviderRows");var GB=i(({dismiss:e})=>{let{fromUsd:t,currencySymbol:r}=ht(),o=Se(),n=ot(),a=Yr(S=>S.setPreferredProvider),c=Yr(S=>S.preferredProvider),[p,d]=(0,Nr.useState)(c??ur),[m,f]=(0,Nr.useState)(n.getQuoteProcessorState());(0,Nr.useEffect)(()=>{let S=n.subscribeQuoteProcessor({onStateChange(T,b){f(b)}});return()=>S()},[n]);let h=(0,Nr.useMemo)(()=>{let S=m.type;if(S!=="firstQuoteReceived"&&S!=="quoteProcessed")return[];let{response:T,input:b}=m,{buy:x}=b;return nl({quoteResponse:T,buyToken:{networkId:x.data.chain.id,decimals:x.data.decimals,symbol:x.data.symbol??""},currencySymbol:r,setSelectedProvider:d,fromUsd:t})},[m,r,t]),y=(0,Nr.useCallback)(()=>{let S=p===ur?void 0:p;a(S),o.capture("swapperProviderSelected",{data:{provider:S}}),e()},[p,a,e,o]),w=(0,Nr.useMemo)(()=>[{theme:"secondary",disabled:!1,label:v.t("commandCancel"),onPress:e},{theme:"primary",disabled:p===(c??ur),label:v.t("commandApply"),onPress:y}],[y,e,p,c]);return{selectedProvider:p,rows:h,buttons:w}},"useSelectPreferredProvider");u();l();var rn=P(O());var KB=i(({dismiss:e})=>{let{fromUsd:t,currencySymbol:r}=ht(),o=Se(),n=j(S=>S.quoteResponse),a=j(S=>S.buyFungible),c=j(S=>S.selectedBaseProvider),p=j(S=>S.setSelectedBaseProvider),d=Yr(S=>S.setPreferredProvider),[m,f]=(0,rn.useState)(c),h=(0,rn.useMemo)(()=>!n||!a?[]:nl({quoteResponse:n,buyToken:{networkId:a.data.chain.id,decimals:a.data.decimals,symbol:a.data.symbol??""},currencySymbol:r,setSelectedProvider:f,fromUsd:t}),[n,a,r,t,f]),y=(0,rn.useCallback)(()=>{p(m),d(m),o.capture("swapperProviderSelected",{data:{provider:m}}),e()},[m,p,d,e,o]),w=(0,rn.useMemo)(()=>[{background:"element",disabled:!1,label:v.t("commandCancel"),onPress:e},{background:"spot",disabled:m===c,label:v.t("commandApply"),onPress:y}],[y,e,m,c]);return{selectedProvider:m,rows:h,buttons:w}},"useSelectSwapProvider");u();l();var Gi=P(O());var zi=Ye(e=>({isInitializeComplete:!0,swapMode:void 0,setSwapMode:i(t=>e({swapMode:t,isInitializeComplete:!1}),"setSwapMode"),setIsInitializeComplete:i(t=>e({isInitializeComplete:t}),"setIsInitializeComplete")})),jB=zi.getState().setSwapMode,VB=i(()=>zi(e=>e.isInitializeComplete===!1),"useInitializingClassicSwapMode"),$B=i(()=>{let e=ot(),t=Ff(),r=Ho(),o=(0,Gi.useMemo)(()=>t.find(p=>r.includes(p))??sn.Mainnet,[t,r]),n=zi(p=>p.swapMode),a=zi(p=>p.setSwapMode),c=zi(p=>p.setIsInitializeComplete);return(0,Gi.useEffect)(()=>e.subscribeToken({onStateChange:i(p=>{p.type==="initializeCompleted"&&c(!0)},"onStateChange")}),[e,c]),(0,Gi.useMemo)(()=>{if(n)return n;let p={type:"swap",network:o,takerCaip19:void 0,takerDestinationCaip19:void 0};return a(p),p},[o,n,a])},"useClassicSwapMode");u();l();var Qe=P(O());u();l();function sl(e,t,r,o){if(r==="sell")return o.includes("insufficientBalance");let n=e?.sellAmount,a=t.find(c=>c.percentage===1)?.amount.toString();return!!n&&!!a&&new _(n).gt(a)}i(sl,"hasInsufficientSellBalance");var HB=i(e=>{let{tokenState:t,quotedAmounts:r,quoteProcessorState:o,sellPercentages:n,inputErrors:a,setAmount:c}=e,p=ze("enable-be-swapper-max-amount"),[d,m]=(0,Qe.useState)(void 0),[f,h]=(0,Qe.useState)(""),[y,w]=(0,Qe.useState)("crypto"),[S,T]=(0,Qe.useState)("sell"),b=(0,Qe.useRef)(!1),{currencySymbol:x,toUsd:E,fromUsd:C,formatLocalizedPrice:I}=ht(),B=zf(),{balanceDisplayStrategy:Q}=xT(),N=Va(),Z=Rb(),q=ot(),k=(0,Qe.useCallback)((Ae,Ge,We,Ot)=>{if(m(void 0),Ae===""){h(Ae),c({amount:"0",denomination:Ot??y,perspective:Ge,tokenStateOverride:We});return}let nr=Og(Ae);nL(nr)&&(h(nr),c({amount:y==="fiat"?String(E(nr)):nr,denomination:Ot??y,perspective:Ge,tokenStateOverride:We}))},[y,h,c,E]),F=(0,Qe.useCallback)((Ae,Ge)=>{S==="buy"&&T("sell"),m(Ae);let We=Ae.getAmountForDenomination(y),Ot=y==="fiat"?C(We.toString()):We.toString();h(sL(new L(Ot),y,Ge)),c({amount:We.toString(),denomination:y,perspective:"sell"})},[m,S,y,c,C]),G=(0,Qe.useCallback)(()=>{q.switchTokens()},[q]),$=(0,Qe.useCallback)(Ae=>{let Ge=tL({perspective:S,currencyDenomination:y,quotedAmounts:r,fromUsd:C});Ge&&k(Ge.toString(),S,Ae)},[y,S,k,r,C]);(0,Qe.useEffect)(()=>q.subscribeToken({onStateChange:i((Ae,Ge,We)=>{Ae.type==="switchTokens"&&($(We),b.current=!0,p&&q.refreshPair({swapMode:Ae.mode,cashAddresses:N,settings:Z})),p&&Ae.type==="changeToken"&&(b.current=!0,q.refreshPair({swapMode:Ae.mode,cashAddresses:N,settings:Z}))},"onStateChange")}),[q,$,N,Z,p]),(0,Qe.useEffect)(()=>{b.current&&(b.current=!1,k(f,S))},[n]);let X=(0,Qe.useCallback)(()=>{let Ae=y==="crypto"?"fiat":"crypto";if(w(Ae),!!r)switch(Ae){case"crypto":let Ge=Bm(S,r);h(Ge.toString());break;case"fiat":let We=Nm(S,r)?.toFixed(2)??"0",Ot=C(We);h(String(Ot));break}},[y,S,r,C]),H=(0,Qe.useMemo)(()=>WT(),[]),{sellAsset:ve,buyAsset:He}=ak(t),dt=HT({sellAsset:ve,buyAsset:He,currencyDenomination:y}),ji=(0,Qe.useMemo)(()=>eL(["sell","buy"],Ae=>WB({perspective:Ae,tokenState:t,quoteProcessorState:o,currencyDenomination:y,currentPerspective:S,inputAmount:f,inputErrors:a,isBalanceHidden:B,balanceDisplayStrategy:Q,sellPercentages:n,currencyDenominationSupportRules:H,isBuyAmountEditable:dt,quotedAmounts:r,currencySymbol:x,fromUsd:C,formatLocalizedPrice:I})),[y,f,a,B,Q,n,S,o,r,t,H,dt,x,C,I]),Io=(0,Qe.useCallback)(()=>{k("",S)},[k,S]);(0,Qe.useEffect)(()=>{let Ae=q.subscribeToken({onStateChange(Ge,We,Ot){!At(We)||!At(Ot)||Ge.type==="changeToken"&&We.sellToken.data.tokenAddress!==Ot.sellToken.data.tokenAddress&&Io()}});return()=>Ae()},[q,Io]),(0,Qe.useEffect)(()=>q.subscribeAccountChange({onAccountChange:i(Ae=>{Io(),q.stopQuoteProcessor();let Ge=q.getTokenState(),We=Ae.addresses[0];At(Ge)&&We&&q.initializeSwap({swapMode:{type:"swap",network:We.networkID,takerCaip19:void 0,takerDestinationCaip19:void 0},cashAddresses:N,settings:Z})},"onAccountChange")}),[q,Io,N,Z]);let Vi=(0,Qe.useCallback)(Ae=>{if(T(Ae),!r||!At(t))return;let{sellAsset:Ge,buyAsset:We}=ak(t);if(!(Ae==="sell"?Ge:We))return;let nr,on;switch(y){case"crypto":nr=Bm(Ae,r).toString(),on=nr;break;case"fiat":let ee=Nm(Ae,r)?.toFixed(2)??"0";nr=String(C(ee)),on=ee;break}h(nr),c({amount:on,denomination:y,perspective:Ae})},[y,r,t,C,h,c]);return{inputAmount:f,tokens:ji,currencyDenomination:y,inputPerspective:S,tokenState:t,quotedAmounts:r,quoteProcessorState:o,inputErrors:a,currentSellPercentage:d,sellPercentages:n,switchTokens:G,setInputAmount:k,switchCurrencyDenomination:X,setSellPercentage:F,clearInput:Io,setInputPerspective:Vi,setCurrencyDenomination:w}},"useClassicSwapperAssets");function WB({perspective:e,tokenState:t,quoteProcessorState:r,currencyDenomination:o,currentPerspective:n,inputAmount:a,inputErrors:c,isBalanceHidden:p,balanceDisplayStrategy:d,sellPercentages:m,currencyDenominationSupportRules:f,isBuyAmountEditable:h,quotedAmounts:y,currencySymbol:w,fromUsd:S,formatLocalizedPrice:T}){if(!At(t))return;let b=XB(e,y),x=JB(e,n,t,a,y),E=o==="crypto"?b:new L(S(x)).toFixed(2),C=oL(a);e===n?E=a:C.gt(0)||(E="");let I=f.every(F=>F.isSupported(e,t.sellToken,t.sellTokenPrice?.usd,t.buyToken,t.buyTokenPrice?.usd)),B=e==="sell"?t.sellToken:t.buyToken,Q=o==="crypto"?T(new L(S(x)).toNumber()):YB(b,B),N=m.find(F=>F.percentage===1)?.amount.toString(),Z=e==="sell"?N:void 0,q=ZB(y,m,n,c);return{perspective:e,fungible:B,balance:rL(B,d,p,Z),amount:E,secondaryAmount:C.gt(0)?Q:"",isAmountLoading:r.type==="starting"&&e!==n,isSecondaryAmountLoading:r.type==="starting",hasAmountWarning:q,isAmountEditable:e==="sell"?!0:h,supportsCurrencyDenominationSwitching:I,amountPrefix:o==="fiat"?w:void 0,percentages:e==="sell"?m:[],warnings:e==="buy"?t.warnings:[]}}i(WB,"createSwapperAsset");function ZB(e,t,r,o){return sl(e,t,r,o)?!0:o.length>0}i(ZB,"hasInputAmountWarning");function YB(e,t){let r=ar.get(t.data.chain.id).formDisplayPrecision;return`${cr(new L(e),r)} ${t.data.symbol??""}`}i(YB,"formatSecondaryAmount");function XB(e,t){return t?Bm(e,t).toString():"0"}i(XB,"parseCyrptoAmount");function JB(e,t,r,o,n){if(n)return Nm(e,n)?.toString()??"0";{if(e!==t||!At(r))return"0";let a=e==="sell"?r.sellTokenPrice:r.buyTokenPrice;return a?.usd?new L(o).times(a.usd).toString():"0"}}i(JB,"parseFiatAmount");function Nm(e,t){switch(e){case"sell":return t?.sellAmountUsd;case"buy":return t?.buyAmountUsd}}i(Nm,"getQuotedUsdAmount");function Bm(e,t){switch(e){case"sell":return t.sellAmount;case"buy":return t.buyAmount}}i(Bm,"getQuotedCryptoAmount");function eL(e,t){return e.reduce((r,o,n)=>{let a=t(o,n,e);return a!=null&&r.push(a),r},[])}i(eL,"compactMap");function tL({perspective:e,currencyDenomination:t,quotedAmounts:r,fromUsd:o}){if(r)switch(e){case"sell":return t==="crypto"?r.buyAmount:r.buyAmountUsd?new L(o(r.buyAmountUsd.toString(),2)):void 0;case"buy":return t==="crypto"?r.sellAmount:r.sellAmountUsd?new L(o(r.sellAmountUsd.toString(),2)):void 0}}i(tL,"getOppositeQuotedAmount");function rL(e,t,r,o){let n=o?L(o):e.data?.balance;if(!(!n||r))return Ve(e)?ra(n):t.format(n,e.data?.symbol??"")}i(rL,"parseBalance");function oL(e){return e==null?new L(0):e===""?new L(0):new L(e)}i(oL,"normalizeInputAmount");function nL(e){try{let t=new L(e);return t.isFinite()?!t.isNegative():!1}catch{return!1}}i(nL,"isValidAmount");function ak(e){return At(e)?{sellAsset:e.sellToken,buyAsset:e.buyToken}:{sellAsset:void 0,buyAsset:void 0}}i(ak,"getTokens");var sL=i((e,t,r)=>t==="fiat"?e.gte(.01)?e.decimalPlaces(2).toString():e.decimalPlaces(5,L.ROUND_UP).toString():e.decimalPlaces(r.data.decimals).toString(),"truncateDisplayAmount");u();l();var dk=P(O());u();l();var Lm=P(O());u();l();var cl=P(O());u();l();u();l();var il=class{static{i(this,"GaslessSwapInterceptor")}gaslessSwapFeeResult;insufficientFundsInterceptor;constructor(t,r){this.gaslessSwapFeeResult=t,this.insufficientFundsInterceptor=r}intercept(t){return this.gaslessSwapFeeResult.success?"continue":this.insufficientFundsInterceptor.intercept(t)}};u();l();var al=class{static{i(this,"InsufficientFundsInterceptor")}intercept({hasInsufficientFunds:t,showInsufficientFunds:r}){return t?(r(),"interrupt"):"continue"}};var ck=i(e=>{let t=new al,r=iL(e);return r?[new il(r,t)]:[t]},"getExecuteSwapInterceptors"),iL=i(e=>{if(e.type!=="firstQuoteReceived"&&e.type!=="quoteProcessed")return;let t=e.quote;if(Pt(t))return t.gaslessSwapFeeResult},"getGaslessSwapFeeResult");var uk=i(e=>{let t=(0,cl.useMemo)(()=>ck(e.quoteProcessorState),[e.quoteProcessorState]);return{executeSwapInterceptors:(0,cl.useCallback)(()=>{for(let o of t){let n=o.intercept(e);if(n==="interrupt")return n}return"continue"},[t,e])}},"useExecuteSwapInterceptors");u();l();var ul=P(O());var lk=i((e,t)=>{let{sellFungible:r,buyFungible:o}=aL(e),n=uL(t),a=ok(r),c=rk({sellFungible:r,buyFungible:o}),p=(0,ul.useMemo)(()=>cL(t),[t]),d=(0,ul.useMemo)(()=>{if(r&&xt(r.type)&&A.isBitcoinNetworkID(r.data.chain.id))return r.data.key;let f=r?.data.chain.id;return f?Tg(f,void 0):void 0},[r]),{fungible:m}=ya({key:d,enableSorting:!1,enablePrices:!1});return(0,ul.useMemo)(()=>{if(!r||!m||!o||!n)return{hasInsufficientFunds:!1,insufficientFundsArgs:void 0,analyticsFields:void 0};if(Ve(r)||Ve(o))return{hasInsufficientFunds:!1,insufficientFundsArgs:void 0,analyticsFields:yd(t)};let f=nk({sellFungible:r,totalFees:p,minRequiredBalance:{source:a,destination:c},currentQuote:n}),h=yd(t);return{hasInsufficientFunds:new _(m?.data.amount??0).lt(f),insufficientFundsArgs:sk({sellFungible:r,sellNativeFungible:m,totalNativeRequirement:f}),analyticsFields:h}},[r,o,n,p,a,c,m,t])},"useHasInsufficientFunds");function aL(e){return e.type!=="pair"?{sellFungible:void 0,buyFungible:void 0}:{sellFungible:e.sellToken,buyFungible:e.buyToken}}i(aL,"getTokens");function cL(e){return e.type!=="quoteProcessed"?new _(0):e.nextProcessedQuote.fees.fees.reduce((t,r)=>t.plus(r.amount),new _(0))}i(cL,"getTotalFees");function uL(e){if(e.type==="quoteProcessed")return e.quote}i(uL,"getQuote");var pk=i(({performSwap:e,goToInsufficientFunds:t,tokenState:r,quoteProcessorState:o})=>{let{hasInsufficientFunds:n,insufficientFundsArgs:a,analyticsFields:c}=lk(r,o),p=(0,Lm.useCallback)(()=>a&&t(a,c),[t,a,c]),{executeSwapInterceptors:d}=uk({hasInsufficientFunds:n,showInsufficientFunds:p,quoteProcessorState:o});return{swap:(0,Lm.useCallback)(()=>{d()==="continue"&&e()},[d,e])}},"useExecuteSwapAction");var Um=class{static{i(this,"ClassicExecuteSwapStateListener")}resetSwapper;constructor(t){this.resetSwapper=t}onStateChange(t,r,o,n){t.type===V.ExecuteSwapStarted&&this.resetSwapper()}},Mm=class{static{i(this,"UpdateBalancesExecuteSwapStateListener")}swapper;constructor(t){this.swapper=t}onStateChange(t,r,o,n){let{sell:a,quote:c}=o.executingQuote;if(t.type===V.TransactionConfirmed){let p=a.data.balance?new _(a.data.balance):void 0;if(!p)return;let d=new _(c.sellAmount).shiftedBy(-a.data.decimals),m=p.minus(d);this.swapper.updateBalances({sellTokenBalance:m,sellTokenCaip19:M(te(a))})}}},lL=i(({swapMode:e,quotedAmounts:t,tokenState:r,inputErrors:o,quoteProcessorState:n,currentPerspective:a,sellPercentages:c,showFungibleDetails:p,showBuyFungibleScreen:d,retryAndNavigateToSwapper:m,resetSwapper:f,goToInsufficientFunds:h,preprocessor:y})=>{let w=ot(),S=fA(),T=(0,dk.useCallback)(()=>{S({showFungibleDetails:p,showBuyFungibleScreen:d,showRetrySwap:m,swapMode:e,executeSwapStateListeners:[new Um(f),new Mm(w)],quotedAmounts:t,uiContext:"swapperClassic",preprocessor:y})},[S,p,d,m,e,f,t,w,y]),{swap:b}=pk({performSwap:T,goToInsufficientFunds:h,tokenState:r,quoteProcessorState:n});return{buttonState:pL(r,o,t,n,a,c),swap:b}},"useClassicSwapperButton"),pL=i((e,t,r,o,n,a)=>e.type!=="pair"?{type:"untradable",label:""}:o.type==="error"?{type:"untradable",label:v.t("swapNoQuotesFound")}:sl(r,a,n,t)?{type:"insufficientBalance",label:v.t("swapReviewInsufficientBalance")}:o.type!=="quoteProcessed"?{type:"loading",label:v.t("swapReviewFlowActionButtonPrimary")}:r?{type:"tradable",label:v.t("swapReviewFlowActionButtonPrimary")}:{type:"untradable",label:v.t("swapReviewFlowActionButtonPrimary")},"parseTradeButtonState");u();l();u();l();var so=i(()=>!0,"defaultShouldDehydrateQueryPredicate"),mk={auth:so,tokens:so,prices:Cg,collectibles:Bg,currency:qf,staking:zg,swapper:Md,transferFungibleLoggingContext:so,user:Pf,[gl]:so,[Uf]:so,[Oi]:so,[Gg]:so,[Ms]:so,[jt]:so,"test-debug-query":Wi},fk=i(e=>{if(e.queryKey.length===0)return!1;let t=String(e.queryKey[0]);return e.state.status!=="success"?!1:mk[t]?mk[t](e):!1},"shouldDehydrateQuery");var ll=P(Be(),1),gk=new hf({defaultOptions:{mutations:{retry:!1,networkMode:"offlineFirst"},queries:{retry:!1,staleTime:1/0,gcTime:1/0,refetchOnWindowFocus:!1,networkMode:"offlineFirst"}}}),dL=mf({underlyingStorage:new gg,throttleMs:1e3,enableDebugLogs:Wi()}),mL=i(({children:e})=>(ty([[Eg,gk]]),e),"HydrateAtoms"),VDe=i(e=>(0,ll.jsx)(wf,{client:gk,persistOptions:{persister:dL,dehydrateOptions:{shouldDehydrateQuery:fk},buster:fL,maxAge:1/0},children:(0,ll.jsx)(Ag,{children:(0,ll.jsx)(mL,{children:e.children})})}),"QueryProvider"),fL="25.2.0";u();l();var Om=(ee=>(ee.Ping="ping",ee.HasOnboarded="hasOnboarded",ee.ResetHasOnboarded="resetHasOnboarded",ee.LockExtension="lockExtension",ee.UnlockExtension="unlockExtension",ee.IsExtensionUnlocked="IsExtensionUnlocked",ee.SetPassword="setPassword",ee.VerifyPassword="verifyPassword",ee.UpdatePassword="updatePassword",ee.ImportPrivateKeyAccount="importPrivateKeyAccount",ee.ImportReadOnlyAccount="importReadOnlyAccount",ee.ImportSeedAccount="importSeedAccount",ee.ImportSeedlessAccount="importSocialSeedAccount",ee.IsExistingSeed="isExistingSeed",ee.AddAccountForSeed="addAccountForSeed",ee.AddAccountForSeedless="addAccountForSeedless",ee.AddLedgerAccounts="addLedgerAccounts",ee.DeriveAddresses="deriveAddresses",ee.ExportPrivateKey="exportPrivateKey",ee.ExportEntropy="exportEntropy",ee.SetAccountIcon="setAccountIcon",ee.RemoveAccount="removeAccount",ee.ReorderAccount="reorderAccount",ee.GetAllAccounts="getAllAccounts",ee.GetAllSeeds="getAllSeeds",ee.GetAllSeedless="getAllSeedlessSeeds",ee.GetAuthenticationPublicKey="getAuthenticationPublicKey",ee.Sign="sign",ee.CheckVaultIntegrity="checkVaultIntegrity",ee.DO_NOT_USE_DiagnoseSeedCacheDigests="doNotUseDiagnoseSeedCacheDigests",ee.GetPhantomOrganization="getPhantomOrganization",ee.GetOrCreatePhantomOrganization="getOrCreatePhantomOrganization",ee.RetrieveKMSWallet="RetrieveKMSWallet",ee.GetKMSWalletStatus="GetKMSWalletStatus",ee.AddUserToCurrentUserOrganization="addUserToCurrentUserOrganization",ee.DeleteUserFromOrganization="deleteUserFromOrganization",ee.UpdateUserInOrganization="updateUserInOrganization",ee.GetAccounts="getAccounts",ee.GetKmsAccounts="getKmsAccounts",ee.GetWalletWithTag="getWalletWithTag",ee.LogMessage="logMessage",ee.DownloadLogs="downloadLogs",ee.ProviderInjectionOptions="providerInjectionOptions",ee.ServiceWorkerMutexAcquire="serviceWorkerMutexAcquire",ee.ServiceWorkerMutexRelease="serviceWorkerMutexRelease",ee))(Om||{});u();l();var Ki=P(Wm(),1),$e=P(rf(),1);u();l();function xe(e,t,r=Ze()){return{jsonrpc:"2.0",id:r,method:e,params:t}}i(xe,"createRpcRequest");u();l();var mr=P(rf(),1);var hL=i(async()=>{let e=xe("getPhantomOrganization",[]),t=await Je(mr.default.runtime,e);if("error"in t)throw new Error(t.error.message);return t.result},"getPhantomOrganization"),yL=i(async()=>{let e=xe("getOrCreatePhantomOrganization",[]),t=await Je(mr.default.runtime,e);if("error"in t)throw new Error(t.error.message);return t.result},"getOrCreatePhantomOrganization"),wL=i(async()=>{let e=xe("RetrieveKMSWallet",[]),t=await Je(mr.default.runtime,e);if("error"in t)throw new Error(t.error.message);return t.result},"retrieveKMSWallet"),aNe=i(async()=>{let e=xe("GetKMSWalletStatus",[]),t=await Je(mr.default.runtime,e);if("error"in t)throw new Error(t.error.message);return t.result},"getKMSWalletStatus"),cNe=i(async(e,t,r,o,n)=>{let a=xe("addUserToCurrentUserOrganization",[e,t,r,o,n]),c=await Je(mr.default.runtime,a);if("error"in c)throw new Error(c.error.message);return c.result},"addUserToCurrentUserOrganization"),SL=i(async(e,t)=>{let r=xe("deleteUserFromOrganization",[e,t]),o=await Je(mr.default.runtime,r);if("error"in o)throw new Error(o.error.message);return o.result},"deleteUserFromOrganization"),hk=i(()=>({getPhantomOrganization:i(async()=>await hL(),"getPhantomOrganization"),getOrCreatePhantomOrganization:i(async()=>await yL(),"getOrCreatePhantomOrganization"),retrieveKMSWallet:i(async()=>await wL(),"retrieveKMSWallet"),deleteUserFromOrganization:i(async({organizationId:e,username:t})=>await SL(e,t),"deleteUserFromOrganization"),getKmsAccounts:i(async()=>{let e=xe("getKmsAccounts",[]),t=await Je(mr.default.runtime,e);if("error"in t)throw new Error(t.error.message);return t.result},"getKmsAccounts"),getWalletWithTag:i(async({organizationId:e,tag:t})=>{let r=xe("getWalletWithTag",[e,t]),o=await Je(mr.default.runtime,r);if("error"in o)throw new Error(o.error.message);return o.result},"getWalletWithTag"),updateUserInOrganization:i(async({organizationId:e,username:t,newPolicy:r,addTraits:o,removeTraits:n})=>{let a=xe("updateUserInOrganization",[e,t,n,o,r]),c=await Je(mr.default.runtime,a);if("error"in c)throw new Error(c.error.message);return c.result},"updateUserInOrganization"),getAccounts:i(async({organizationId:e,walletId:t,accounts:r})=>{let o=xe("getAccounts",[e,t,r]),n=await Je(mr.default.runtime,o);if("error"in n)throw new Error(n.error.message);return n.result},"getAccounts")}),"createKMSProxy");var wk=P(Be(),1),bL=hk(),TL=i(async(e,t,r)=>{let o=t.fold(c=>Buffer.from(c.buffer).toString("base64")),n=xe("importPrivateKeyAccount",[e,o,r]),a=await R.startSpan("importPrivateKeyAccount",()=>Je($e.default.runtime,n));if("error"in a)throw new Error(a.error.message);if(typeof a.result=="string")return JSON.parse(a.result);throw new Error("importPrivateKeyAccount: Invalid response from background script")},"importPrivateKeyAccount"),TNe=i(async(e,t,r)=>{let o=e.getEntropy(),n=xe("importSeedAccount",[Ki.default.encode(o),t,r]);o.fill(0);let a=await R.startSpan("importSeedAccount",()=>Je($e.default.runtime,n));if("error"in a)throw new Error(a.error.message);if(typeof a.result=="string")return JSON.parse(a.result);throw new Error("importS*edAccount: Invalid response from background script")},"importSeedAccount"),xNe=i(async(e,t,r)=>{let o=e.getEntropy(),n=xe("importSocialSeedAccount",[Ki.default.encode(o),t,r]);o.fill(0);let a=await R.startSpan("importSeedlessAccount",()=>Je($e.default.runtime,n));if("error"in a)throw new Error(a.error.message);if(typeof a.result=="string")return JSON.parse(a.result);throw new Error("importS*edlessAccount: Invalid response from background script")},"importSeedlessAccount"),ANe=i(async e=>{let t=e.getEntropy(),r=xe("isExistingSeed",Ki.default.encode(t));t.fill(0);let o=await R.startSpan("isExistingSeed",()=>Je($e.default.runtime,r));if("error"in o)throw new Error(o.error.message);if(typeof o.result=="boolean"||o.result===null)return o.result;throw new Error("isExistingS*ed: Invalid response from background script")},"isExistingSeed"),xL=i(async e=>{let t=xe("addAccountForSeed",[e]),r=await R.startSpan("addAccountForSeed",async()=>bt(await $e.default.runtime.sendMessage(Ct(t))));if("error"in r)throw new Error(r.error.message);if(typeof r.result=="string")return JSON.parse(r.result);throw new Error("addAccountForS*ed: Invalid response from background script")},"addAccountForSeed"),AL=i(async e=>{let t=xe("addAccountForSeedless",[e]),r=await R.startSpan("addAccountForSeedless",async()=>bt(await $e.default.runtime.sendMessage(Ct(t))));if("error"in r)throw new Error(r.error.message);if(typeof r.result=="string")return JSON.parse(r.result);throw new Error("addAccountForS*ed: Invalid response from background script")},"addAccountForSeedless"),EL=i(async(e,t)=>{let r=xe("addLedgerAccounts",[e,t]),o=await R.startSpan("connectLedgerAccounts",async()=>bt(await $e.default.runtime.sendMessage(Ct(r))));if("error"in o)throw new Error(o.error.message);if(typeof o.result=="string")return JSON.parse(o.result);throw new Error("connectLedgerAccounts: Invalid response from background script")},"connectLedgerAccounts"),kL=i(async e=>{let t=xe("importReadOnlyAccount",e),r=await R.startSpan("addReadonlyAccount",async()=>bt(await $e.default.runtime.sendMessage(Ct(t))));if("error"in r)throw new Error(r.error.message);if(typeof r.result=="string")return JSON.parse(r.result);throw new Error("addReadonlyAccount: Invalid response from background script")},"addReadonlyAccount"),ENe=i(async(e,t,r)=>{let o=xe("exportPrivateKey",[e,t,r]),n=await R.startSpan("exportPrivateKey",async()=>bt(await $e.default.runtime.sendMessage(Ct(o))));if("error"in n)throw new Error(n.error.message);if(typeof n.result=="string")return pl.from(Buffer.from(n.result,"hex"));throw new Error("exportPrivateKey: Invalid response from background script")},"exportPrivateKey"),kNe=i(async(e,t)=>{let r=xe("exportEntropy",[e,t]),o=await R.startSpan("exportEntropy",async()=>bt(await $e.default.runtime.sendMessage(Ct(r))));if("error"in o)throw new Error(o.error.message);if(typeof o.result=="string")return pl.from(Buffer.from(o.result,"hex"));throw new Error("exportEntropy: Invalid response from background script")},"exportEntropy"),CL=i(async()=>{let e=xe("deriveAddresses",void 0),t=await Je($e.default.runtime,e);if("error"in t)throw new Error(t.error.message);return t.result},"deriveAddresses"),_L=i(async e=>{let t=xe("removeAccount",e),r=await Je($e.default.runtime,t);if("error"in r)throw new Error(r.error.message);return r.result},"removeAccount"),IL=i(async(e,t)=>{let r=xe("reorderAccount",{identifier:e,toIndex:t}),o=await Je($e.default.runtime,r);if("error"in o)throw new Error(o.error.message);return o.result},"reorderAccount"),FL=i(async()=>{let e=xe("getAllAccounts",void 0),t=bt(await $e.default.runtime.sendMessage(Ct(e)));if("error"in t)throw new Error(t.error.message);if(typeof t.result=="string"){let r=JSON.parse(t.result);return kf({accounts:r}).accounts}throw new Error("fetchAllAccounts: Invalid response from background script")},"fetchAllAccounts"),vL=i(async()=>{let e=xe("getAllSeeds",void 0),t=bt(await $e.default.runtime.sendMessage(Ct(e)));if("error"in t)throw new Error(t.error.message);if(typeof t.result=="string")return JSON.parse(t.result);throw new Error("fetchAllSe*dMetas: Invalid response from background script")},"fetchAllSeedMetas"),PL=i(async()=>{let e=xe("getAllSeedlessSeeds",void 0),t=bt(await $e.default.runtime.sendMessage(Ct(e)));if("error"in t)throw new Error(t.error.message);if(typeof t.result=="string")return JSON.parse(t.result);throw new Error("fetchAllSe*dlessMetas: Invalid response from background script")},"fetchAllSeedlessMetas"),RL=i(async e=>{let t=xe("getAuthenticationPublicKey",{secretIdentifier:e}),r=bt(await $e.default.runtime.sendMessage(Ct(t)));if("error"in r)throw new Error(r.error.message);if(typeof r.result=="string")return JSON.parse(r.result);throw new Error("getAuthenticationPublicK*y: Invalid response from background script")},"getAuthenticationPublicKey"),DL=i(async()=>{let e=xe("checkVaultIntegrity",void 0),t=bt(await $e.default.runtime.sendMessage(Ct(e)));if("error"in t)throw new Error(t.error.message);return t.result},"checkVaultIntegrity"),NL=i(async()=>{let e=xe("doNotUseDiagnoseSeedCacheDigests",void 0),t=bt(await $e.default.runtime.sendMessage(Ct(e)));if("error"in t)throw new Error(t.error.message);return typeof t.result=="string"?JSON.parse(t.result):null},"diagnoseSeedCacheDigestsRpc"),BL=i(async(e,t)=>{let r=Cf.parse(t);"chainType"in r&&r.chainType===ye.Solana&&r.signingType==="transaction"&&typeof r.message!="string"&&(r.message=Ki.default.encode(r.message));let o=xe("sign",{accountIdentifier:e,params:r}),n=bt(await $e.default.runtime.sendMessage(Ct(o)));if("error"in n)throw new Error(n.error.message);if(typeof n.result=="string")return bt(n.result);throw new Error("sign: Invalid response from background script")},"sign"),yk={addAccountForSeed:xL,addReadonlyAccount:kL,importPrivateKeyAccount:TL,connectLedgerAccounts:EL,fetchAllAccounts:FL,fetchAllSeedMetas:vL,fetchAllSeedlessMetas:PL,connectSolanaSeedVaultAccounts:i(()=>{throw new Error("Solana Seed Vault is not supported on browser extension.")},"connectSolanaSeedVaultAccounts"),deriveAddresses:CL,removeAccount:i(async e=>{if(!await _L(e))throw new Error("Error while removing account")},"removeAccount"),reorderAccount:i(async(e,t)=>{if(!await IL(e,t))throw new Error("Error while reordering account")},"reorderAccount"),sign:BL,getAuthenticationPublicKey:RL,addAccountForSeedless:AL,checkVaultIntegrity:DL,getCashAddress:i(async()=>{throw new Error("getCashAddress: Not implemented on browser extension")},"getCashAddress"),getAgentAddress:i(async()=>{throw new Error("getAgentAddress: Not implemented on browser extension")},"getAgentAddress"),getCashKMSAccount:i(async()=>{throw new Error("getCashKMSAccount: Not implemented on browser extension")},"getCashKMSAccount"),getKMSInstance:i(()=>bL,"getKMSInstance"),addKMSVaultAccount:i(()=>{throw new Error("addKMSVaultAccount: Only callable from background script, not UI")},"addKMSVaultAccount"),canDeriveKMSAuthenticator:i(()=>{throw new Error("canDeriveKMSAuthenticator: Not implemented on browser extension")},"canDeriveKMSAuthenticator"),DO_NOT_USE_diagnoseSeedCacheDigests:i(async()=>{let e=await NL();if(!e)throw new Error("DO_NOT_USE_diagnoseSeedCacheDigests: Vault locked");return e},"DO_NOT_USE_diagnoseSeedCacheDigests")},CNe=i(()=>yk,"getVaultProxy");function _Ne({children:e}){return(0,wk.jsx)(Af,{vault:yk,children:e})}i(_Ne,"VaultProxyProvider");export{Yk as a,zk as b,hU as c,Gk as d,co as e,Kk as f,Ta as g,Zk as h,Do as i,Nl as j,Xk as k,Jk as l,eC as m,Bl as n,hh as o,yt as p,cp as q,Ft as r,No as s,tp as t,sC as u,iC as v,aC as w,qh as x,wC as y,lC as z,Xh as A,Gxe as B,nbe as C,Ui as D,WN as E,cm as F,nN as G,em as H,tm as I,Li as J,bD as K,Ao as L,Jt as M,Me as N,Ep as O,ur as P,j as Q,US as R,H4 as S,W4 as T,bu as U,De as V,OC as W,py as X,dy as Y,se as Z,Ry as _,we as $,_e as aa,Dt as ba,Nt as ca,ce as da,fo as ea,Jn as fa,Cb as ga,be as ha,Lb as ia,Ub as ja,W as ka,Xe as la,rt as ma,Vo as na,au as oa,V as pa,Qb as qa,Oe as ra,$c as sa,Gb as ta,Kb as ua,es as va,Ib as wa,pu as xa,SH as ya,$t as za,dd as Aa,$n as Ba,At as Ca,zy as Da,Az as Ea,Yv as Fa,ot as Ga,nP as Ha,iP as Ia,Xv as Ja,Yn as Ka,BX as La,Xn as Ma,zX as Na,Eb as Oa,UJ as Pa,Jv as Qa,bP as Ra,St as Sa,Ei as Ta,Db as Ua,Ci as Va,Pie as Wa,er as Xa,dR as Ya,mR as Za,hR as _a,Efe as $a,FR as ab,fle as bb,RT as cb,kT as db,SR as eb,Ho as fb,Bd as gb,DR as hb,BR as ib,Upe as jb,OR as kb,$pe as lb,Hpe as mb,Wpe as nb,zR as ob,rde as pb,ode as qb,GR as rb,lde as sb,pde as tb,_R as ub,e1 as vb,t1 as wb,Ld as xb,r1 as yb,Que as zb,IR as Ab,o1 as Bb,Zd as Cb,sD as Db,iD as Eb,SD as Fb,sm as Gb,im as Hb,am as Ib,xN as Jb,AN as Kb,fm as Lb,VN as Mb,JN as Nb,nB as Ob,aB as Pb,cB as Qb,ym as Rb,wm as Sb,Sm as Tb,Ut as Ub,Zu as Vb,JE as Wb,GE as Xb,HE as Yb,XE as Zb,DB as _b,BB as $b,zB as ac,GB as bc,KB as cc,UB as dc,VB as ec,$B as fc,HB as gc,lL as hc,fk as ic,gk as jc,VDe as kc,Om as lc,xe as mc,wL as nc,aNe as oc,cNe as pc,hk as qc,TNe as rc,xNe as sc,ANe as tc,ENe as uc,kNe as vc,PL as wc,CNe as xc,_Ne as yc};
/*! Bundled license information:

use-sync-external-store/cjs/use-sync-external-store-shim.production.js:
  (**
   * @license React
   * use-sync-external-store-shim.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

use-sync-external-store/cjs/use-sync-external-store-shim.development.js:
  (**
   * @license React
   * use-sync-external-store-shim.development.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

use-sync-external-store/cjs/use-sync-external-store-shim/with-selector.production.js:
  (**
   * @license React
   * use-sync-external-store-shim/with-selector.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

use-sync-external-store/cjs/use-sync-external-store-shim/with-selector.development.js:
  (**
   * @license React
   * use-sync-external-store-shim/with-selector.development.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

pako/dist/pako.esm.mjs:
  (*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) *)
*/
//# sourceMappingURL=chunk-TAPPRV2Q.js.map
