import{a as Qt}from"./chunk-UWERS3K5.js";import"./chunk-XIY3VZ4W.js";import"./chunk-O43INWHJ.js";import{a as Kt}from"./chunk-HY5EE4BL.js";import"./chunk-UOP6XST7.js";import"./chunk-PZK75MNV.js";import{b as Mt,d as A}from"./chunk-J25C3IZ2.js";import"./chunk-DQWLAPQA.js";import{o as Ht,p as _t}from"./chunk-2EBYQ5P2.js";import{b as Ot}from"./chunk-JXEDAEEX.js";import"./chunk-NZFNOPCO.js";import"./chunk-2V4XDYKJ.js";import"./chunk-SUKAPYGM.js";import"./chunk-736WIWZX.js";import"./chunk-PV5WDBPS.js";import"./chunk-LOTYUAC5.js";import"./chunk-3BNSF37W.js";import"./chunk-UKK3MGUG.js";import"./chunk-KOBOJI2X.js";import"./chunk-CH3CP7SO.js";import{j as Ft,o as W}from"./chunk-BXLRR6GM.js";import"./chunk-ST7U2VUQ.js";import"./chunk-LEFSCI55.js";import"./chunk-WY4HUBHZ.js";import"./chunk-RDJLORQI.js";import"./chunk-M62EOSRT.js";import"./chunk-4V5HUNZ6.js";import"./chunk-WWYPP3MY.js";import"./chunk-IJJXVSGB.js";import"./chunk-XF26M2KT.js";import"./chunk-N3C6FBKY.js";import"./chunk-CTKHELYY.js";import"./chunk-XMURLUQN.js";import"./chunk-JUI4ISS4.js";import"./chunk-GVVB5LZG.js";import{a as Et}from"./chunk-S5LVVL2E.js";import{db as i,m as s}from"./chunk-4EXJCS3P.js";import"./chunk-TAPPRV2Q.js";import"./chunk-C3BAWXY6.js";import"./chunk-WVRYN4MY.js";import"./chunk-M3IC3XCG.js";import"./chunk-RSJ6JVZU.js";import{H as $,K as Pt,R as Tt,S as Rt,aa as Bt,ba as Ut,fa as Wt,ja as It,ka as Vt,ma as Lt,u as At,ua as Nt,va as zt}from"./chunk-2UWPPO5V.js";import{C as bt,Ta as Dt,e as Q}from"./chunk-4T2FPKLQ.js";import"./chunk-GC6SFTGM.js";import"./chunk-A3JYJELV.js";import"./chunk-MVNJOY5H.js";import"./chunk-SIWEHH3L.js";import{$ as ft,_ as Ct}from"./chunk-OQCZPFI2.js";import"./chunk-YJCG6GWC.js";import{A as K,ub as St}from"./chunk-KLKDJF5S.js";import{Bb as wt,Cb as yt,me as xt,wd as ht}from"./chunk-BQE2SXP7.js";import{$ as kt,Lb as mt,Ld as _,fc as pt}from"./chunk-L3JU23Z5.js";import"./chunk-5HNKNX3S.js";import{Aa as d,U as c,a as ce,b as U,ba as vt,d as dt,ia as gt,q as f}from"./chunk-R3MCCTIW.js";import"./chunk-FNC6PQ53.js";import"./chunk-5QQLABHI.js";import"./chunk-VL3IRAUM.js";import"./chunk-FA7LVEFF.js";import{a as v,g as D,i as R,n as B}from"./chunk-WKJYWAXG.js";R();B();var m=D(ce(),1);R();B();var k=D(U(),1),le=s.div`
  display: grid;
  grid-template-columns: 100%;
  grid-template-rows: 47px auto;
  align-items: center;
  justify-content: flex-start;
  background: ${c.colors.legacy.elementBase};
  width: 328px;
  border-radius: 6px;
  margin-top: 24px;
`,ue=s.div`
  display: grid;
  gap: 10px;
  grid-template-columns: 33px 1fr auto;
  align-items: center;
  padding: 9px 14px;
  border-bottom: 1px solid ${c.colors.legacy.areaBase};
`,de=s(Mt)``,ke=s.section`
  padding: 14px;
`,me=s.div`
  display: grid;
  grid-template-columns: 1fr 1fr;
  height: 30px;
  align-items: center;
`,pe=s(i)`
  color: ${n=>n.activationState==="active"?c.colors.legacy.spotPositive:n.activationState==="inactive"?c.colors.legacy.spotNegative:n.activationState==="activating"?c.colors.brand.yellowMoon:n.activationState==="deactivating"?c.colors.brand.yellowMoon:c.colors.legacy.textDiminished};
`,Se=s(Kt).attrs(()=>({tooltipAlignment:"bottomCenter",iconSize:12,lineHeight:17,fontWeight:400,fontSize:14,noWrap:!0}))``,q=v(n=>{let{t:e}=f(),{data:u}=Wt(n.validatorKeybaseUsername),p=n.validatorName??n.validatorKeybaseUsername??n.voteAccountPubkey??n.stakeAccountPubkey;return(0,k.jsxs)(le,{children:[(0,k.jsxs)(ue,{children:[(0,k.jsx)(de,{width:28,iconUrl:n.validatorIconUrl??u}),(0,k.jsx)(i,{textAlign:"left",weight:600,size:16,noWrap:!0,children:p}),(0,k.jsx)(pe,{activationState:n.status,textAlign:"right",weight:400,size:14,noWrap:!0,textTransform:"capitalize",children:n.status??""})]}),(0,k.jsx)(ke,{children:Object.entries(n.data).map(([r,a])=>(0,k.jsxs)(me,{onClick:a.onClick,children:[(0,k.jsxs)(Se,{info:a.tooltip?(0,k.jsx)(_t,{children:(0,k.jsx)(Ht,{children:a.tooltip})}):null,children:[r==="Stake Account"?e("stakeAccountCardStakeAccount"):"",r==="Balance"?e("stakeAccountCardBalance"):"",r==="Rent Reserve"?e("stakeAccountCardRentReserve"):"",r==="Active Stake"?e("stakeAccountCardActiveStake"):"",r==="Lockup"?e("stakeAccountCardLockup"):"",r==="Rewards"?e("stakeAccountCardRewards"):""]}),a.node]},r))})]})},"StakeAccountCard");var t=D(U(),1),I=s.div`
  position: relative;
  height: 100%;
  display: flex;
  flex-direction: column;
  overflow-y: scroll;
`,V=s.div`
  display: flex;
  flex-direction: column;
  align-items: center;
  flex-grow: 1;
`,Y=s.a.attrs({target:"_blank",rel:"noopener noreferrer"})`
  color: ${c.colors.legacy.spotBase};
  text-decoration: none;
  cursor: pointer;
`,P=s.section`
  display: flex;
  gap: 15px;
`,$t=s.section`
  display: flex;
  gap: 15px;
  margin-top: 24px;
  flex-direction: column;
`,ve=s.div`
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: flex-end;
`,ge=5e3,Ae=v(n=>{let{t:e}=f(),{showStakeAccountDeactivateStakeStatusModal:u,showStakeAccountDelegateStakeStatusModal:p,showStakeAccountWithdrawStakeStatusModal:r,closeAllModals:a}=Ot(),{data:g}=St(),C=(0,m.useMemo)(()=>g?.addresses.find(b=>mt.isSolanaNetworkID(b.networkID)),[g]),{solanaPublicKey:T,connection:w,networkID:j}=(0,m.useMemo)(()=>{let b=C?.address??"",ut=C?.networkID,re=wt(yt(ut));return{solanaPublicKey:b,connection:re,networkID:ut}},[C]),G=Lt(ht),jt=pt(kt.Solana),{data:Gt}=bt({query:{data:jt}}),{data:J}=Dt(),L=Gt?.usd,y=It(w,T),o=y.data?.find(b=>b.pubkey===n.stakeAccountPubkey),N=o?.info.meta.authorized.staker,Jt=o?.lamports??0,X=parseFloat(o?.info.meta.rentExemptReserve??"0"),Xt=!!o?.inflationReward,{data:Zt=X}=xt(C),z=!!(J&&new dt(J.totalQuantityString).gt(Zt+ge)),Z=Nt(),l=Vt(w,o?.pubkey).data,te=l?.active??0,ee=l?.inactive??0,E=Jt-X-te,tt=o?.info.stake?.delegation.voter,oe=Ce(),S=tt?oe.get(tt):void 0,et=new Date((o?.info.meta.lockup?.unixTimestamp??0)*1e3),O=Ut(o),F=Rt(l?.state)&&z,M=Tt(l?.state)&&!O&&z,ae=_("enable-psol-native-convert"),ot=_("enable-psol-native-delayed-convert"),h=G&&ae&&M,x=G&&ot&&F,at=ot&&l?.state==="deactivating",{data:ne}=Ct(j),{data:nt}=ft(j,o?.pubkey??""),{pushDetailView:it}=Ft(),ie=(0,m.useCallback)(()=>{it((0,t.jsx)(Qt,{}))},[it]),rt=zt(ie),ct=(0,m.useCallback)(()=>{if(!o)throw new Error("Stake account not found");rt({stakeAccount:o,validatorName:S?.info?.name??"",activationState:l?.state})},[rt,o,S,l]),H=[{key:"viewOnExplorer",label:e("stakeAccountViewViewOnExplorer",{explorer:ne}),onClick:v(()=>{nt&&self.open(nt,"_blank")},"onClick")}];o&&(S&&(l?.state==="inactive"||l?.state==="deactivating")&&H.push({key:"restake",label:e("stakeAccountViewRestake"),onClick:v(()=>{p({stakeAccountPubkey:o.pubkey,voteAccountPubkey:S?.voteAccountPubkey,lamports:l.inactive,onClose:a})},"onClick")}),E>0&&E>ee&&H.push({key:"withdrawUnstakedSOL",label:e("stakeAccountViewWithdrawUnstakedSOL"),onClick:v(()=>{r({stakeAccountPubkey:o.pubkey,amount:E,usdPerSol:L,onClose:a})},"onClick")}));let st=(0,m.useCallback)(()=>{!o||!N||u({stakeAccountPubkey:o.pubkey,stakeAuthorityPubkey:N,onClose:a})},[o,N,u,a]),lt=(0,m.useCallback)(()=>{o&&r({stakeAccountPubkey:o.pubkey,amount:o.lamports,usdPerSol:L,onClose:a})},[o,r,L,a]);return y.isPending?(0,t.jsx)(I,{children:(0,t.jsx)(Et,{})}):y.isError?(0,t.jsxs)(I,{children:[(0,t.jsx)(W,{children:e("stakeAccountViewPrimaryText")}),(0,t.jsx)(V,{children:(0,t.jsx)(i,{size:16,color:c.colors.legacy.textDiminished,lineHeight:20,children:y.error?.message??e("stakeAccountViewError")})}),(0,t.jsx)(P,{children:(0,t.jsx)(d,{onClick:a,children:e("commandClose")})})]}):y.isSuccess&&o?(0,t.jsxs)(I,{canConvertStake:h,canConvertDelayedStake:x,children:[(0,t.jsx)(W,{items:H,children:e("stakeAccountViewPrimaryText")}),S?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(V,{children:[(0,t.jsx)(qt,{canConvertStake:h,canConvertDelayedStake:x,hasValidator:!!S,durationUntilEpochEnds:Z,isDeactivating:at}),(0,t.jsx)(q,{stakeAccountPubkey:o.pubkey,voteAccountPubkey:S?.voteAccountPubkey,validatorName:S?.info?.name,validatorKeybaseUsername:S?.info?.keybaseUsername,validatorIconUrl:S?.info?.iconUrl,status:l?.state,data:{"Stake Account":{node:(0,t.jsx)(i,{textAlign:"right",weight:500,size:14,noWrap:!0,children:K(o.pubkey)})},Balance:{node:(0,t.jsx)(i,{textAlign:"right",weight:500,size:14,noWrap:!0,children:(0,t.jsx)(A,{children:o.lamports})})},"Rent Reserve":{node:(0,t.jsx)(i,{textAlign:"right",weight:500,size:14,noWrap:!0,children:(0,t.jsx)(A,{children:o.info.meta.rentExemptReserve})})},"Active Stake":{node:(0,t.jsx)(i,{textAlign:"right",weight:500,size:14,noWrap:!0,children:(0,t.jsx)(A,{children:l?.active})})},Lockup:{node:(0,t.jsx)(i,{textAlign:"right",weight:500,size:14,noWrap:!0,children:O?Q(et):"\u2013"})},Rewards:Xt?{node:(0,t.jsx)(ve,{children:(0,t.jsxs)(i,{color:c.colors.legacy.spotPositive,textAlign:"right",weight:500,size:14,noWrap:!0,children:["+",(0,t.jsx)(A,{children:o?.inflationReward})]})}),tooltip:e("stakeAccountCardRewardsTooltip")}:{node:(0,t.jsx)(i,{color:c.colors.legacy.textDiminished,textAlign:"right",weight:500,size:14,noWrap:!0,children:"\u2013"})}}}),z?null:(0,t.jsx)(vt,{marginY:"base",children:(0,t.jsx)(gt,{color:"spotNegative",children:e("stakeAccountInsufficientFunds")})})]}),(0,t.jsx)(Yt,{canConvertStake:h,canUnstake:F,canWithdrawStake:M,canConvertDelayedStake:x,onClose:a,onUnstake:st,onWithdrawStake:lt,onConvertStake:ct})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(V,{children:[(0,t.jsx)(qt,{canConvertStake:h,canConvertDelayedStake:x,hasValidator:!!S,durationUntilEpochEnds:Z,isDeactivating:at}),(0,t.jsx)(q,{stakeAccountPubkey:o.pubkey,status:l?.state,data:{"Stake Account":{node:(0,t.jsx)(i,{textAlign:"right",weight:500,size:14,noWrap:!0,children:K(o.pubkey)})},Balance:{node:(0,t.jsx)(i,{textAlign:"right",weight:500,size:14,noWrap:!0,children:(0,t.jsx)(A,{children:o.lamports})})},"Rent Reserve":{node:(0,t.jsx)(i,{textAlign:"right",weight:500,size:14,noWrap:!0,children:(0,t.jsx)(A,{children:o.info.meta.rentExemptReserve})})},"Active Stake":{node:(0,t.jsx)(i,{textAlign:"right",weight:500,size:14,noWrap:!0,children:(0,t.jsx)(A,{children:l?.active})})},Lockup:{node:(0,t.jsx)(i,{textAlign:"right",weight:500,size:14,noWrap:!0,children:O?Q(et):"\u2013"})}}})]}),(0,t.jsx)(Yt,{canUnstake:F,canWithdrawStake:M,canConvertStake:h,canConvertDelayedStake:x,onClose:a,onUnstake:st,onWithdrawStake:lt,onConvertStake:ct})]})]}):(0,t.jsxs)(I,{children:[(0,t.jsx)(W,{children:e("stakeAccountViewPrimaryText")}),(0,t.jsx)(V,{children:(0,t.jsx)(i,{size:16,color:c.colors.legacy.textDiminished,lineHeight:20,children:e("stakeAccountViewStakeNotFound")})}),(0,t.jsx)(P,{children:(0,t.jsx)(d,{onClick:a,children:e("commandClose")})})]})},"StakeAccountDetailPage"),ro=Ae,qt=v(({canConvertStake:n,canConvertDelayedStake:e,isDeactivating:u,hasValidator:p,durationUntilEpochEnds:r})=>{let{t:a}=f(),g=(0,m.useMemo)(()=>n?(0,t.jsxs)(t.Fragment,{children:[a("stakeAccountViewStakeInactiveToPSOL.part1")," ",(0,t.jsx)(Y,{href:Pt,children:a("stakeAccountViewStakeInactiveToPSOL.part2")})]}):u?a("stakeAccountViewStakeDeactivatingToPSOL",{durationUntilEpochEnds:r}):e?a("convertToPSOLDelayDisclaimer",{durationUntilEpochEnds:r}):p?(0,t.jsxs)(At,{i18nKey:"stakeAccountViewSOLCurrentlyStakedInterpolated",children:["Your SOL is currently staked with a validator. You'll need to unstake to ",(0,t.jsx)("br",{}),"access these funds. ",(0,t.jsx)(Y,{href:$,children:"Learn more"})]}):(0,t.jsxs)(t.Fragment,{children:[a("stakeAccountViewStakeInactive.part1")," ",(0,t.jsx)(Y,{href:$,children:a("stakeAccountViewStakeInactive.part2")})]}),[n,e,u,p,r,a]);return(0,t.jsx)(i,{size:16,color:c.colors.legacy.textDiminished,lineHeight:20,children:g})},"StakeDescription"),Yt=v(n=>{let{t:e}=f(),{canUnstake:u,canWithdrawStake:p,canConvertStake:r,canConvertDelayedStake:a,onClose:g,onUnstake:C,onWithdrawStake:T,onConvertStake:w}=n;return r?(0,t.jsxs)($t,{children:[(0,t.jsx)(d,{background:"spot",onClick:w,children:e("convertToPhantomLST")}),(0,t.jsxs)(P,{children:[(0,t.jsx)(d,{onClick:g,children:e("commandClose")}),(0,t.jsx)(d,{onClick:T,children:e("stakeAccountViewWithdrawStake")})]})]}):a?(0,t.jsxs)($t,{children:[(0,t.jsx)(d,{background:"spot",onClick:w,children:e("convertToPhantomLST")}),(0,t.jsxs)(P,{children:[(0,t.jsx)(d,{onClick:g,children:e("commandClose")}),(0,t.jsx)(d,{onClick:C,children:e("stakeAccountViewActionButtonUnstake")})]})]}):(0,t.jsxs)(P,{children:[(0,t.jsx)(d,{onClick:g,children:e("commandClose")}),p&&(0,t.jsx)(d,{onClick:T,children:e("stakeAccountViewWithdrawStake")}),u&&(0,t.jsx)(d,{background:"spot",onClick:C,children:e("stakeAccountViewActionButtonUnstake")})]})},"StakeActions"),Ce=v(()=>{let n=Bt(),e=n.results??[],u=(0,m.useRef)(e);return u.current=e,(0,m.useMemo)(()=>new Map(u.current.map(p=>[p.voteAccountPubkey,p])),[n.dataUpdatedAt,u])},"useValidatorsByVoteAccountPubkey");export{Ae as StakeAccountDetailPage,ro as default};
//# sourceMappingURL=StakeAccountDetailPage-ZCLR4OHA.js.map
