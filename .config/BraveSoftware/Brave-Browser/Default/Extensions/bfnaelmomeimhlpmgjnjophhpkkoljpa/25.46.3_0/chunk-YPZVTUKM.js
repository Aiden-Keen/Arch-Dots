import{Y as Q}from"./chunk-M3IC3XCG.js";import{I as G,Y as O,Z as H,ba as L,wa as P}from"./chunk-4T2FPKLQ.js";import{j as S,mc as M,ub as F}from"./chunk-KLKDJF5S.js";import{$c as _,Fd as v,Gd as K,_c as D,dc as B,ec as N,je as U,pe as V,xb as q}from"./chunk-BQE2SXP7.js";import{Cc as b,Fc as w,Lb as R,Rb as g,Uc as h,_d as A,fd as k,id as I}from"./chunk-L3JU23Z5.js";import{a as W}from"./chunk-R3MCCTIW.js";import{l as x}from"./chunk-VL3IRAUM.js";import{a as i,g as J,i as c,n as u}from"./chunk-WKJYWAXG.js";c();u();var Z="fungible-transfer-tx",$=A({seconds:30});function de(e){let n=e?.fungibleKey,r=e?.encodedCaip19?g(e?.encodedCaip19):void 0,s=r?[r]:void 0,{fungible:o}=P({key:n,keyTokens:s,splTokenAccount:e?.splTokenAccount}),C=L(e?.sendFormValues?.recipient,o?.data.chain.id)??"",t=e?.sendSessionId??"",{chain:d,walletAddress:l}=o?.data??{},{data:m}=M({address:l,networkID:d?.id}),{data:f}=H(m),{data:p}=G({networkID:d?.id,enableFallback:!0}),a=ee(d?.id,p,f,m),E=a?.sendContextRequired?a.sendContext:void 0,T=e?.sendFormValues;return I({staleTime:$,enabled:!!o&&!!e&&!!a,queryKey:U.transferTransaction({fungibleKey:n,fungibleSendFormValues:T,sendSessionId:t,sendContext:E}),async queryFn(){if(!o||!T||!a)throw new Error("Missing required data to construct fungible transfer transaction");try{return await V(o,{...T,recipient:C},E)}catch(y){if(x(y)){let z=y.response?.status;v(y,z,Z)}}throw new Error("Failed to create transfer transaction")}})}i(de,"useTransferTransaction");function ee(e,n,r,s){if(e)return R.isBitcoinNetworkID(e)?!n||!r||!s?void 0:{sendContextRequired:!0,sendContext:{transactionSpeedsToUnitCost:n,utxoState:r,chainAddress:s}}:{sendContextRequired:!1}}i(ee,"createSendContext");c();u();var j=J(W());c();u();var X=i(()=>{let{setRetryArgs:e}=Q();return n=>{if(n instanceof N){let{successfulTxIds:r}=n,[s,o]=r;e({type:K.BRC20,commitTxId:s,revealTxId:o})}}},"useHandleRetryableTransactionError");function Me(){let e=h(),{data:n}=F({select:(0,j.useCallback)(t=>t.identifier,[])}),r=X(),s=O(),o=S();return k({mutationFn:i(async({multichainTransaction:t,pendingTransactionInput:d,senderAddress:l,gasEstimation:m})=>{if(!n)throw new Error("No account identifier found");let{networkID:f}=t,p=await q.get(f).onBeforeSend({multichainTransaction:t,gasEstimation:m}),a=await _({accountIdentifier:n,accountSigner:o,multichainTransaction:p,networkID:f,pendingTransactionInput:d,senderAddress:l,storage:e,utxoManager:s});return D(f,a)},"mutationFn"),onError(t){t instanceof Error&&(w.captureError(t,b.Fungibles),t instanceof B&&r(t))}})}i(Me,"useTransferFungible");export{de as a,Me as b};
//# sourceMappingURL=chunk-YPZVTUKM.js.map
